/* webRTPU (v4.209.0.17) Copyright (C) Siemens AG 2018. All Rights Reserved. {ts '2018-07-04T14:36:23.910Z'} */
!function(e){function t(){}function n(e,t){return function(){e.apply(t,arguments)}}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function i(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void r._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?o:s)(t.promise,e._value);var r;try{r=n(e._value)}catch(e){return void s(t.promise,e)}o(t.promise,r)}))}function o(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if(t instanceof r)return e._state=3,e._value=t,void a(e);if("function"==typeof i)return void l(n(i,t),e)}e._state=1,e._value=t,a(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,a(e)}function a(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,o(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}var c=setTimeout;r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,n){var r=new this.constructor(t);return i(this,new u(e,n,r)),r},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){function r(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){r(o,e)},n)}t[o]=s,0===--i&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)r(o,t[o])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},r._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=r:e.Promise||(e.Promise=r)}(this);var Parser=function(e){function t(e){function t(){}return t.prototype=e,new t}function n(e,t){this.type=e,this.value=void 0!==t?t:0}function r(e,t,n,r,i){this.tokens=e,this.ops1=t,this.ops2=n,this.ops3=r,this.functions=i}function i(e){return"string"==typeof e?(M.lastIndex=0,M.test(e)?"'"+e.replace(M,function(e){var t=j[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+e+"'"):e}function o(e,t){return void 0!==s(e,t)}function s(e,t){var n=t.match(/[^(\.|\'|\"|\[|\])]+/g).reduce(function(e,t){return e&&void 0!==e[t]?e[t]:""===t?e:void 0},e);return n}function a(e,t,r,i,u){for(var l,c,p,h,f=[],d=[],v=0,m=e.length;v<m;v++){var g=e[v],b=g.type;if(b===U)f.push(g);else if(b===V&&o(u,g.value))g=new n(U,s(u,g.value)),f.push(g);else if(b===W&&f.length>1)c=f.pop(),l=f.pop(),h=r[g.value],g=new n(U,h(l.value,c.value)),f.push(g);else if(b===O&&f.length>2)p=f.pop(),c=f.pop(),l=f.pop(),"?"===g.value?f.push(l.value?c.value:p.value):(h=i[g.value],g=new n(U,h(l.value,c.value,p.value)),f.push(g));else if(b===F&&f.length>0)l=f.pop(),h=t[g.value],g=new n(U,h(l.value)),f.push(g);else if(b===B){for(;f.length>0;)d.push(f.shift());d.push(new n(B,a(g.value,t,r,i,u)))}else{for(;f.length>0;)d.push(f.shift());d.push(g)}}for(;f.length>0;)d.push(f.shift());return d}function u(e,t,n){for(var r,i,o,a,l=[],c=0,p=e.length;c<p;c++){var h=e[c],f=h.type;if(f===U)l.push(h.value);else if(f===W)i=l.pop(),r=l.pop(),a=t.ops2[h.value],l.push(a(r,i));else if(f===O)o=l.pop(),i=l.pop(),r=l.pop(),"?"===h.value?l.push(u(r?i:o,t,n)):(a=t.ops3[h.value],l.push(a(r,i,o)));else if(f===V)if(h.value in t.functions)l.push(t.functions[h.value]);else{var d=s(n,h.value);if(void 0===d)throw new Error("undefined variable: "+h.value);l.push(d)}else if(f===F)r=l.pop(),a=t.ops1[h.value],l.push(a(r));else if(f===H){for(var v=h.value,m=[];v-- >0;)m.unshift(l.pop());if(a=l.pop(),!a.apply||!a.call)throw new Error(a+" is not a function");l.push(a.apply(void 0,m))}else{if(f!==B)throw new Error("invalid Expression");l.push(h.value)}}if(l.length>1)throw new Error("invalid Expression (parity)");return l[0]}function l(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];i.type===V&&t.indexOf(i.value)===-1?t.push(i.value):i.type===B&&l(i.value,t)}}function c(e,t){return e+t}function p(e,t){return e-t}function h(e,t){return e*t}function f(e,t){return e/t}function d(e,t){return e%t}function v(e,t){return e==t}function m(e,t){return e!=t}function g(e,t){return e>t}function b(e,t){return e<t}function y(e,t){return e>=t}function P(e,t){return e<=t}function T(e,t){return Boolean(e&&t)}function E(e,t){return Boolean(e||t)}function w(e,t){return Boolean(e&t)}function x(e){return Math.log(e)*Math.LOG10E}function N(e){return e*(180/Math.PI)}function R(e){return e*(Math.PI/180)}function A(e){return-e}function C(e){return!e}function _(e,t,n){return e?t:n}function k(e,t){return"[object Array]"!==Object.prototype.toString.call(e)?[e,t]:(e=e.slice(),e.push(t),e)}function D(e,t,n,r){this.type=e,this.value=t,this.line=n,this.column=r}function I(e,t,n,r,i){this.pos=0,this.line=0,this.column=0,this.current=null,this.ops1=t,this.ops2=n,this.ops3=r,this.consts=i,this.expression=e}function S(e,t){this.parser=e,this.tokens=t,this.current=null,this.nextToken=null,this.next()}function L(){this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,atan:Math.atan,sqrt:Math.sqrt,ln:Math.log,log:x,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,"-":A,"+":Number,not:C,rad2deg:N,deg2rad:R},this.ops2={"+":c,"-":p,"*":h,"/":f,"%":d,"^":Math.pow,",":k,"==":v,"!=":m},this.ops3={"?":_},this.functions={pow:Math.pow,atan2:Math.atan2,if:_,and:T,or:E,gt:g,ge:y,lt:b,le:P,eq:v,ne:m,has:w},this.consts={E:Math.E,PI:Math.PI,true:1,false:0,null:null}}var U="INUMBER",F="IOP1",W="IOP2",O="IOP3",V="IVAR",H="IFUNCALL",B="IEXPR";n.prototype.toString=function(){switch(this.type){case U:case F:case W:case O:case V:return this.value;case H:return"CALL "+this.value;default:return"Invalid Instruction"}};var M=/[\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};r.prototype.simplify=function(e){return e=e||{},new r(a(this.tokens,this.ops1,this.ops2,this.ops3,e),t(this.ops1),t(this.ops2),t(this.ops3),t(this.functions))},r.prototype.substitute=function(e,i){function o(t){for(var r=[],s=0,a=t.length;s<a;s++){var u=t[s],l=u.type;if(l===V&&u.value===e)for(var c=0;c<i.tokens.length;c++){var p=i.tokens[c],h=new n(p.type,p.value);r.push(h)}else l===B?r.push(new n(B,o(u.value))):r.push(u)}return r}return i instanceof r||(i=(new L).parse(String(i))),new r(o(this.tokens),t(this.ops1),t(this.ops2),t(this.ops3),t(this.functions))},r.prototype.evaluate=function(e){return e=e||{},u(this.tokens,this,e)},r.prototype.toString=function(e){function t(t){for(var n,r,o,s,a=[],u=0,l=t.length;u<l;u++){var c=t[u],p=c.type;if(p===U)a.push(i(c.value));else if(p===W)r=a.pop(),n=a.pop(),s=c.value,e&&"^"===s?a.push("Math.pow("+n+","+r+")"):a.push("("+n+s+r+")");else if(p===O){if(o=a.pop(),r=a.pop(),n=a.pop(),s=c.value,"?"!==s)throw new Error("invalid Expression");a.push("("+n+"?"+r+":"+o+")")}else if(p===V)a.push(c.value);else if(p===F)n=a.pop(),s=c.value,"-"===s?a.push("("+s+n+")"):a.push(s+"("+n+")");else{if(p!==H)throw new Error("invalid Expression");for(var h=c.value,f=[];h-- >0;)f.unshift(a.pop());s=a.pop(),a.push(s+"("+f.join(", ")+")")}}if(a.length>1)throw new Error("invalid Expression (parity)");return a[0]}return t(this.tokens)},r.prototype.symbols=function(){var e=[];return l(this.tokens,e),e},r.prototype.numberOfTokens=function(){return this.tokens.length},r.prototype.variables=function(){var e=[];l(this.tokens,e);var t=this.functions;return e.filter(function(e){return!(e in t)})},r.prototype.toJSFunction=function(e,t){var n=new Function(e,"with(Parser.values) { return "+this.simplify(t).toString(!0)+"; }");return n};var G="TEOF",X="TOP",Y="TNUMBER",q="TSTRING",$="TPAREN",z="TCOMMA",J="TNAME";return D.prototype.toString=function(){return this.type+": "+this.value},I.prototype.newToken=function(e,t,n,r){return new D(e,t,null!=n?n:this.line,null!=r?r:this.column)},I.prototype.next=function(){return this.pos>=this.expression.length?this.newToken(G,"EOF"):this.isWhitespace()||this.isComment()?this.next():this.isOperator()||this.isNumber()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},I.prototype.isString=function(){var e=!1,t="",n=this.line,r=this.column;if(this.pos<this.expression.length&&"'"===this.expression.charAt(this.pos))for(this.pos++,this.column++;this.pos<this.expression.length;){var i=this.expression.charAt(this.pos);if("'"===i&&"\\"!==t.slice(-1)){this.current=this.newToken(q,this.unescape(t),n,r),this.pos++,this.column++,e=!0;break}t+=i,this.pos++,this.column++,"\n"===i&&(this.line++,this.column=0)}return e},I.prototype.isParen=function(){var e=this.expression.charAt(this.pos);return("("===e||")"===e)&&(this.current=this.newToken($,e),this.pos++,this.column++,!0)},I.prototype.isComma=function(){var e=this.expression.charAt(this.pos);return","===e&&(this.current=this.newToken(z,","),this.pos++,this.column++,!0)},I.prototype.isConst=function(){for(var e="",t=this.pos;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break;e+=n}return e.length>0&&e in this.consts&&(this.current=this.newToken(Y,this.consts[e]),this.pos+=e.length,this.column+=e.length,!0)},I.prototype.isNamedOp=function(){for(var e="",t=this.pos;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||"_"!==n&&(n<"0"||n>"9")))break;e+=n}return e.length>0&&(e in this.ops2||e in this.ops1||e in this.ops3)&&(this.current=this.newToken(X,e),this.pos+=e.length,this.column+=e.length,!0)},I.prototype.isName=function(){for(var e="",t=this.pos;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")&&"["!==n&&"]"!==n&&'"'!==n&&"'"!==n&&"$"!==n))break;e+=n}return e.length>0&&(this.current=this.newToken(J,e),this.pos+=e.length,this.column+=e.length,!0)},I.prototype.isWhitespace=function(){for(var e=!1,t=this.expression.charAt(this.pos);" "===t||"\t"===t||"\n"===t||"\r"===t;)e=!0,this.pos++,this.column++,"\n"===t&&(this.line++,this.column=0),t=this.expression.charAt(this.pos);return e},I.prototype.unescape=function(e){for(var t=[],n=!1,r=0;r<e.length;r++){var i=e.charAt(r);if(n){switch(i){case"'":t.push("'");break;case"\\":t.push("\\");break;case"/":t.push("/");break;case"b":t.push("\b");break;case"f":t.push("\f");break;case"n":t.push("\n");break;case"r":t.push("\r");break;case"t":t.push("\t");break;case"u":var o=parseInt(e.substring(r+1,r+5),16);t.push(String.fromCharCode(o)),r+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+i+'"')}n=!1}else"\\"===i?n=!0:t.push(i)}return t.join("")},I.prototype.isComment=function(){var e=this.expression.charAt(this.pos);if("/"===e&&"*"===this.expression.charAt(this.pos+1)){var t=this.pos;this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length);for(var n=this.expression.substring(t,this.pos),r=n.indexOf("\n");r>=0;)this.line++,this.column=n.length-r,r=n.indexOf("\n",r+1);return!0}return!1},I.prototype.isNumber=function(){for(var e=!1,t="";this.pos<this.expression.length;){var n=this.expression.charAt(this.pos);if(!(n>="0"&&n<="9"||"."===n))break;t+=this.expression.charAt(this.pos),this.pos++,this.column++,e=!0}return e&&(this.current=this.newToken(Y,parseFloat(t))),e},I.prototype.isOperator=function(){var e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e)this.current=this.newToken(X,e);else if("∙"===e||"•"===e)this.current=this.newToken(X,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(X,">="),this.pos++,this.column++):this.current=this.newToken(X,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(X,"<="),this.pos++,this.column++):this.current=this.newToken(X,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(X,"||"),this.pos++,this.column++}else if("="===e){if("="!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(X,"=="),this.pos++,this.column++}else{if("!"!==e)return!1;if("="!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(X,"!="),this.pos++,this.column++}return this.pos++,this.column++,!0},I.prototype.parseError=function(e){throw new Error("parse error ["+(this.line+1)+":"+(this.column+1)+"]: "+e)},S.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},S.prototype.tokenMatches=function(e,t){return"undefined"==typeof t||("[object Array]"===Object.prototype.toString.call(t)?t.indexOf(e.value)>=0:"function"==typeof t?t(e):e.value===t)},S.prototype.accept=function(e,t){return!(this.nextToken.type!==e||!this.tokenMatches(this.nextToken,t))&&(this.next(),!0)},S.prototype.expect=function(e,t){if(this.accept(e,t))return!0;throw new Error("parse error ["+this.tokens.line+":"+this.tokens.column+"]: Expected "+(t||e))},S.prototype.parseAtom=function(e){if(this.accept(J))e.push(new n(V,this.current.value));else if(this.accept(Y))e.push(new n(U,this.current.value));else if(this.accept(q))e.push(new n(U,this.current.value));else{if(!this.accept($,"("))throw new Error("unexpected "+this.nextToken);this.parseExpression(e),this.expect($,")")}},S.prototype.parseExpression=function(e){this.parseConditionalExpression(e)},S.prototype.parseConditionalExpression=function(e){for(this.parseOrExpression(e);this.accept(X,"?");){var t=[],r=[];this.parseConditionalExpression(t),this.expect(X,":"),this.parseConditionalExpression(r),e.push(new n(B,t)),e.push(new n(B,r)),e.push(new n(O,"?"))}},S.prototype.parseOrExpression=function(e){for(this.parseAndExpression(e);this.accept(X,"or");){var t=this.current;this.parseAndExpression(e),e.push(new n(W,t.value))}},S.prototype.parseAndExpression=function(e){for(this.parseComparison(e);this.accept(X,"and");){var t=this.current;this.parseComparison(e),e.push(new n(W,t.value))}},S.prototype.parseComparison=function(e){for(this.parseAddSub(e);this.accept(X,["==","!=","<","<=",">=",">"]);){var t=this.current;this.parseAddSub(e),e.push(new n(W,t.value))}},S.prototype.parseAddSub=function(e){for(this.parseTerm(e);this.accept(X,["+","-","||"]);){var t=this.current;this.parseTerm(e),e.push(new n(W,t.value))}},S.prototype.parseTerm=function(e){for(this.parseFactor(e);this.accept(X,["*","/","%"]);){var t=this.current;this.parseFactor(e),e.push(new n(W,t.value))}},S.prototype.parseFactor=function(e){function t(e){return e.value in r}var r=this.tokens.ops1;if(this.accept(X,t)){var i=this.current;this.parseFactor(e),e.push(new n(F,i.value))}else this.parseExponential(e)},S.prototype.parseExponential=function(e){for(this.parseFunctionCall(e);this.accept(X,"^");)this.parseFactor(e),e.push(new n(W,"^"))},S.prototype.parseFunctionCall=function(e){for(this.parseAtom(e);this.accept($,"(");)if(this.accept($,")"))e.push(new n(H,0));else{var t=this.parseArgumentList(e);e.push(new n(H,t))}},S.prototype.parseArgumentList=function(e){for(var t=0;!this.accept($,")");)for(this.parseExpression(e),++t;this.accept(z);)this.parseExpression(e),++t;return t},L.parse=function(e){return(new L).parse(e)},L.evaluate=function(e,t){return L.parse(e).evaluate(t)},L.Expression=r,L.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,sqrt:Math.sqrt,ln:Math.log,log:x,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,pow:Math.pow,atan2:Math.atan2,if:_,E:Math.E,PI:Math.PI},L.prototype={parse:function(e){var n=[],i=new S(this,new I(e,this.ops1,this.ops2,this.ops3,this.consts));return i.parseExpression(n),i.expect(G,"EOF"),new r(n,t(this.ops1),t(this.ops2),t(this.ops3),t(this.functions))},evaluate:function(e,t){return this.parse(e).evaluate(t)}},e.Parser=L,L}("undefined"==typeof exports?{}:exports),__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){a.label=n[1];break}if(6===n[0]&&a.label<s[1]){a.label=s[1],s=n;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(n);break}s[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},WebRTPU;!function(e){var t=function(){function e(e,t){this.RequestContentCallback=e,this.UpdateContentCallback=t}return e}();e.Content=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function e(e,t){this.Name=e,this.Parent=t}return e}();e.DataPath=t;var n=function(){function n(){}return n.traverse=function(r,i,o){e.ObservableArray.isArray(r)?n.traverseArray(r,i,o):"object"==typeof r&&null!==r?(null!=i&&(r[".path"]=new t(o,i)),n.traverseObject(r,o)):e.Tracing.logFn(40,function(){return"Path '"+o+"' is leaf."})},n.traverseArray=function(t,r,i){e.Tracing.logFn(40,function(){return"Path '"+i+"' is array."}),t.forEach(function(e,t){n.traverse(e,r,i+"["+t+"]")})},n.traverseObject=function(t,r){e.Tracing.logFn(40,function(){return"Path '"+r+"' is object."});for(var i in t)t.hasOwnProperty(i)&&"."!==i[0]&&(Array.isArray(t[i])&&(t[i]=new e.ObservableArray(t[i])),n.traverse(t[i],t,r+"."+i))},n.prepare=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null),n.traverse(e,t,r?r:null!=t&&null!=t[".path"]?t[".path"].Name:"HmiProps")},n.copy=function(t){return e.ObservableArray.isArray(t)?n.copyArray(t):"object"==typeof t&&null!==t?n.copyObject(t):t},n.copyArray=function(e){var t=[];return e.forEach(function(e){t.push(n.copy(e))}),t},n.copyObject=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&"."!==r[0]&&(t[r]=n.copy(e[r]));return t},n.clone=function(e){return n.copy(e)},n}();e.DataPreprocessor=n}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function t(){}return t.resolveOne=function(t,n,r){var i=void 0,o=t.match(/[^(\.|\'|\"|\[|\])]+/g);if("HmiProps"!==o[0]&&"LocalProps"!==o[0]&&"ParamProps"!==o[0]&&"Converter"!==o[0]&&"EventArgs"!==o[0]&&"Layout"!==o[0])throw e.Tracing.logFn(10,function(){return"Invalid variable: "+t}),new Error;if(i=o.reduce(function(t,n,i,o){var s=t&&void 0!==t[n]?t[n]:""===n?t:void 0;if(!(void 0!==s&&e.Engine.Options&&e.Engine.Options.partResolver&&i===o.length-1&&0!==i&&s&&s.constructor===Object)||s[".partResolved"]||r.Parent)return s},n),void 0===i&&"HmiProps"===o[0]&&(i=e.Engine.DefaultResolver(t,r),void 0!==i&&(i&&"object"==typeof i&&e.Engine.Options&&e.Engine.Options.partResolver&&!Array.isArray(i)&&(i[".partResolved"]=!0),o.reduce(function(e,t,n,r){return""===t?e:(n===r.length-1?e[t]=i:e[t]=e[t]||{},e[t])},n))),void 0===i)throw e.Tracing.logFn(10,function(){return"Undefined variable: "+t+" (no default)"}),new Error},t.resolve=function(e,t,n){var r=e.variables();for(var i in r)this.resolveOne(r[i],t,n)},t}();e.Defaults=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function t(){this.Converters={},this._parser=new DOMParser,this._nveTypeRegistry=new e.Helpers.Dictionary,this._templateRegistry=new e.Helpers.Dictionary,this._templatePreview=new e.Helpers.Dictionary,t._contentRegistry=new e.Helpers.Dictionary,t.DefaultResolver||(t.DefaultResolver=function(e,t){}),t.PropertyChangedCallback||(t.PropertyChangedCallback=function(e,t,n){}),t.SetCursor||(t.SetCursor=function(e,t,n){var r;switch(t){case"screen":r=document.getElementsByTagName("body")[0],r||(r=n.RootNode.parentNode?n.RootNode.parentNode:n.RootNode);break;case"item":r=n.RootNode.parentNode?n.RootNode.parentNode:n.RootNode;break;default:r=void 0!==t.style.cursor?t:n.RootNode}r.style&&void 0!==r.style.cursor&&(r.style.cursor=e)}),t.SendCommand||(t.SendCommand=function(e,t,n){}),t.SendEvent||(t.SendEvent=function(e,t,n){}),t.XLinkTransformation||(t.XLinkTransformation=function(e){return e}),e.Tracing.log||(e.Tracing.log=function(t,n){e.Tracing.Level>=t&&console.log(n)}),t.CustomEnums||(t.CustomEnums={}),t.EventRegistrationCallback||(t.EventRegistrationCallback=e.Eventing.Event.DefaultEventRegistration),t.EventDeregistrationCallback||(t.EventDeregistrationCallback=e.Eventing.Event.DefaultEventDeregistration),t.EventTransformer||(t.EventTransformer=e.Eventing.Event.DefaultEventTransformer),this.registerNVEType("content",e.NVE.BuiltIn.BuiltInContent),e.Engine.Options={partResolver:!0}}return t.prototype.registerTracer=function(t,n){e.Tracing.Level=t,e.Tracing.log=n},t.prototype.registerDefaultResolver=function(e){t.DefaultResolver=e},t.prototype.registerPropertyChangedCallback=function(e){t.PropertyChangedCallback=e},t.prototype.registerSetCursor=function(e){t.SetCursor=e},t.prototype.registerSendCommand=function(e){t.SendCommand=e},t.prototype.registerSendEvent=function(e){t.SendEvent=e},t.prototype.registerEventCallbacks=function(e,n){t.EventRegistrationCallback=e,t.EventDeregistrationCallback=n},t.prototype.registerEventTransformer=function(e){t.EventTransformer=e},t.prototype.registerXLinkTransformation=function(e){t.XLinkTransformation=e},t.prototype.registerEnums=function(e){t.CustomEnums=e},t.prototype.registerNVEType=function(t,n){this._nveTypeRegistry[t]?e.Tracing.logFn(40,function(){return"There is already a NVE for "+t+" registered!"}):this._nveTypeRegistry[t]=n},t.prototype.createNVE=function(t){var n=new this._nveTypeRegistry[t];return n.InstanceId=e.Helpers.GUID.create(),n},t.prototype.hasNVE=function(e){var t=this._nveTypeRegistry[e];return void 0!=t&&null!=t},t._createContentId=function(e,t){return e+":"+t.toLowerCase()},t.prototype.registerContent=function(n,r,i){var o=t._createContentId(n,r),s=t._contentRegistry[o];void 0==s||null==s?(t._contentRegistry[o]=i,e.Tracing.logFn(40,function(){return"Registered content handler with for type "+r})):e.Tracing.logFn(40,function(){return"There is already a content handler with for type "+r})},t.hasContent=function(e,n){var r=this._createContentId(e,n);return!!t._contentRegistry[r]},t.getContent=function(e,n){var r=this._createContentId(e,n);return t._contentRegistry[r]},t.prototype.registerTemplate=function(t,n){var r=this._templateRegistry[t];void 0==r||null==r?(this._templateRegistry[t]=n,e.Tracing.logFn(40,function(){return"Registered template with id "+t+" with type="+n.PrimaryType})):e.Tracing.logFn(40,function(){return"There is already a template with id "+t+" (2)"})},t.prototype.hasTemplate=function(e){return!!this._templateRegistry[e]},t.prototype.getTemplate=function(e){return this._templateRegistry[e]},t.prototype.loadTemplateFromUrl=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var t,r,i;return __generator(this,function(o){return t=n?n+e:e,this._templatePreview[t]?[2,this._templatePreview[t]]:(r=this,i=new Promise(function(e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return 4!==i.readyState?[2]:i.status>=200&&i.status<300||0===i.status?[4,r.loadTemplate(this.responseText,t)]:[3,2];case 1:return o.sent(),e(r.getTemplate(t)),[3,3];case 2:n({message:"Could not load template"}),o.label=3;case 3:return[2]}})})},i.open("GET",t,!0),i.send()}),this._templatePreview[t]=i,[2,i])})})},t.prototype.loadTemplate=function(t,n){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(o){switch(o.label){case 0:if(this.hasTemplate(n))return e.Tracing.logFn(40,function(){return"There is already a template from "+n+" (1)"}),[2,!1];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this._parser.parseFromString(t,"image/svg+xml"),r.doctype&&"svg"===r.doctype.name&&"-//SIEMENS//DTD SVG 1.0 TIA-HMI//EN"===r.doctype.publicId?e.Tracing.logFn(40,function(){return"Found valid document type declaration."}):e.Tracing.logFn(20,function(){return"Invalid or missing document type declaration."}),[4,this.loadTemplateDocument(r,n)];case 2:return[2,o.sent()];case 3:return i=o.sent(),[2,!1];case 4:return[2]}})})},t.prototype.loadTemplateDocument=function(t,n){return __awaiter(this,void 0,void 0,function(){var r,i,o;return __generator(this,function(s){switch(s.label){case 0:if(this.hasTemplate(n))return e.Tracing.logFn(40,function(){return"There is already a template from "+n+" (1)"}),[2,!1];s.label=1;case 1:return s.trys.push([1,3,,4]),r=t.documentElement,i=new e.RenderingTemplate(n),i.Tree=r,[4,this.walk(r,i)];case 2:return s.sent(),this.addContainerBindings(r,i),i.CleanUpReferences(),i.CleanUpBindings(),this.registerTemplate(n,i),e.Tracing.logFn(40,function(){return"--- STATISTICS ---"}),e.Tracing.logFn(40,function(){return"ELEMENTS: "+i.Statistics.NodeCount}),e.Tracing.logFn(40,function(){return"ATTRIBUTES: "+i.Statistics.AttributeCount}),e.Tracing.logFn(40,function(){return"BINDINGS: "+i.Statistics.BindingCount}),e.Tracing.logFn(40,function(){return"EVENTS: "+i.Statistics.EventCount}),[2,!0];case 3:return o=s.sent(),e.Tracing.logFn(10,function(){return"Template could not be loaded: "+o}),[2,!1];case 4:return[2]}})})},t.prototype.addContainerBindings=function(e,t){var n=function(n,r){var i=n.substr(0,n.indexOf(":")),o=e.lookupNamespaceURI(i);null===o&&(o="http://www.siemens.com/wincc/svg/bind",e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:hmi-bind",o)),e.setAttributeNS(o,n,"{{"+r+"}}");var s=e.attributes[n];t.AddBinding(e,s,s.value),e.removeAttributeNode(s)};2!==t.PrimaryType&&0!==t.PrimaryType?(n("hmi-bind:width","HmiProps.Width"),n("hmi-bind:height","HmiProps.Height")):(n("hmi-bind:width","Layout.ActualWidth"),n("hmi-bind:height","Layout.ActualHeight"),n("hmi-bind:x","Layout.ActualX"),n("hmi-bind:y","Layout.ActualY"))},t.prototype.applyTemplate=function(e,t,n,r){return void 0===r&&(r=null),this.applyTemplateInternal(e,t,n,r)},t.prototype.applyTemplateInternal=function(t,n,r,i,o,s){if(void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),!this.hasTemplate(t))return e.Tracing.logFn(10,function(){return"There is no template from "+t}),null;if(!n)return e.Tracing.logFn(10,function(){return"There was no hosting element given..."}),null;var a=this.getTemplate(t);a.CreateUniqueIDs();var u=a.Tree.cloneNode(!0);r.Converter=this.Converters,r[".links"]={},r[".compositionBindings"]=[];var l=new e.Item(u,r,a.PrimaryType,a.SecondaryType,i,o,s);return this.establishParamProperties(a,r),this.establishLocalProperties(a,r,l),this.establishNVEs(a,r,l),this.establishBindings(a,r,l),r.HmiProps&&e.DataPreprocessor.prepare(r.HmiProps),this.establishCompositions(a,r,l),n.appendChild(u),this.establishEvents(a,r,l),r[".owner"]=l,l},t.prototype.establishEvents=function(t,n,r){n[".events"]=[];for(var i=r.RootNode,o=i.getElementsByTagName("event-hint"),s=o.length,a=s-1;a>=0;a--){var u=o[a],l=t.Events[u.textContent];l&&(e.Tracing.logFn(40,function(){return"Established event for action"+l.Action.Name}),l.activate(u.parentNode,r),u.parentNode.removeChild(u))}},t.prototype.establishParamProperties=function(t,n){n.ParamProps||(n.ParamProps={}),n[".twoWay"]||(n[".twoWay"]={});for(var r in t.ParamProps)t.ParamProps[r].TwoWay&&(n[".twoWay"][r]=!0),void 0!==n.ParamProps[r]?e.Tracing.logFn(40,function(){return"Established ParamProps."+r+" with input value "+n.ParamProps[r]}):(n.ParamProps[r]=t.ParamProps[r].Default,e.Tracing.logFn(40,function(){return"Established ParamProps."+r+" with default "+n.ParamProps[r]}))},t.prototype.establishLocalProperties=function(t,n,r){n[".localBindings"]=[],n.LocalProps={};for(var i in t.LocalProps){var o=t.LocalProps[i];o.Static?(n.LocalProps[i]=o.Value,e.Tracing.logFn(40,function(){return"Established unbound local property LocalProps."+i})):(e.Tracing.logFn(40,function(){return"Established bound local property LocalProps."+i}),n.LocalProps[i]=o.bind(n,r))}},t.prototype.expandNVE=function(t,n,r,i,o){var s=this.createNVE(t.Type);for(var a in t.Attributes){var u=t.Attributes[a];u.Static?s.Attributes[a]=u.Value:s.Attributes[a]=u.bind(s,r,i)}if(s.Events)for(var l in t.Events)s.Events[l]=new e.Eventing.Event(parseInt(l),t.Events[l]);if(t.Template){var c=n.GetComposition(t.Template),p=this.establishSingleComposition(c,n,r,i,null,-1,s),h=e.Helpers.GUID.create();p.setAttribute("id",h),s.TemplateId=h,o.appendChild(p)}for(var f in t.Children){var d=this.expandNVE(t.Children[f],n,r,i,o);d.Parent=s,s.Features.push(d)}return s},t.prototype.establishNVEs=function(t,n,r){if(t.UsesNVE()){n[".nveBindings"]=[],n[".nve"]=[];for(var i=r.RootNode,o=i.getElementsByTagName("nve-hint"),s=o.length,a=s-1;a>=0;a--){var u=o[a],l=t.GetNVE(u.textContent);if(l){var c=document.createElementNS("http://www.w3.org/2000/svg","g"),p=document.createElementNS("http://www.w3.org/2000/svg","defs");c.appendChild(p);var h=this.expandNVE(l,t,n,r,p),f=h.create(r);c.appendChild(f),n[".nve"].push(new e.NVE.ElementLink(h,f)),u.parentNode.replaceChild(c,u)}}}},t.prototype.establishSingleComposition=function(t,n,r,i,o,s,a){if(void 0===o&&(o=null),void 0===s&&(s=-1),void 0===a&&(a=null),t){var u=document.createElementNS("http://www.w3.org/2000/svg","g"),l={ParamProps:{},Layout:{ActualWidth:0,ActualHeight:0,ActualX:0,ActualY:0}},c=void 0,p=new Array;for(var h in t.ParamProps){var f=t.ParamProps[h];f.Static?(l.ParamProps[h]=f.Value,e.Tracing.logFn(40,function(){return"Established unbound param property ParamProps."+h})):(e.Tracing.logFn(40,function(){return"Established bound param property ParamProps."+h}),c=f.bind(r,i),c&&(l.ParamProps[h]=c.Definition.Value,p.push(c)))}for(var d in t.LayoutProps){var v=t.LayoutProps[d];v.Static?(l.Layout[d]=v.Value,e.Tracing.logFn(40,function(){return"Established unbound param property LayoutProps."+d})):(e.Tracing.logFn(40,function(){return"Established bound param property LayoutProps."+d}),c=v.bind(r,i),c&&(l.Layout[d]=c.Definition.Value,p.push(c)))}if(t.HmiProps){var m=o?new e.Properties.ParamDefinition("forEach."+s,"{{"+o[s][".path"].Name+"}}",(!0),2):t.HmiProps;c=m.bind(r,i),c&&(l.HmiProps=c.Definition.Value,o&&s>=0&&(l.HmiProps.$index=s,l.HmiProps.$count=o.length),p.push(c))}var g=!1;
if(l.HmiProps)g=!0;else{var b=this.getTemplate(this.extractPrefix(n.URI)+t.Template);0===b.PrimaryType&&(g=!0)}if(g){var y=this.applyTemplateInternal(this.extractPrefix(n.URI)+t.Template,u,l,i.Store,i,a);for(var P in p)p[P].Item=y;return u}l=void 0;var T=r[".compositionBindings"];for(var E in p){var w=T.indexOf(p[E]);w>-1&&T.splice(w,1)}return null}},t.prototype.composeCollection=function(t,n,r,i){var o=void 0;if(t.ForEach&&t.HmiProps){o=document.createElementNS("http://www.w3.org/2000/svg","g");var s=t.HmiProps.bind(r,i);s?(s.CollectionNode=o,s.TemplateDef=t,s.Template=n,s.Engine=this):e.Tracing.logFn(20,function(){return"Failed binding against collection."});var a=t.HmiProps.resolve(r,!1);if(a.length)for(var u=0;u<a.length;u++){var l=this.establishSingleComposition(t,n,r,i,a,u);l&&o.appendChild(l)}}else o=this.establishSingleComposition(t,n,r,i);return o},t.prototype.establishCompositions=function(e,t,n){if(e.UsesCompositions())for(var r=n.RootNode,i=r.getElementsByTagName("template-hint"),o=i.length,s=o-1;s>=0;s--){var a=i[s],u=e.GetComposition(a.textContent),l=this.composeCollection(u,e,t,n);l?a.parentNode.replaceChild(l,a):a.parentElement.removeChild(a)}},t.prototype.establishBindings=function(t,n,r){n[".svgBindings"]=[];for(var i=r.RootNode,o=i.getElementsByTagName("binding-hint"),s=o.length,a=s-1;a>=0;a--){var u=o[a],l=t.GetBinding(u.textContent);if(l){e.Tracing.logFn(40,function(){return"Established SVG binding "+l.Expression});var c=l.OwnerAttribute?u.parentNode:u;l.bind(c,n,r),u.parentNode.removeChild(u)}}},t.prototype.attributes=function(t,n){for(var r=t.attributes.length,i=!1,o=r-1;o>=0;o--){var s=t.attributes[o];if("hmi"===s.prefix)"if"===s.localName?n.AddBinding(t,s,s.value):"changes"===s.localName&&"PLAINSVG "===s.value.toUpperCase()&&(i=!0),t.removeAttributeNode(s);else if("hmi-flex"===s.prefix)e.Tracing.logFn(40,function(){return"FlexBox layouting not yet supported..."}),t.removeAttributeNode(s);else if("hmi-bind"===s.prefix||"hmi-bind--xlink"===s.prefix)!t.parentNode||t.parentNode.parentNode||"width"!==s.localName&&"height"!==s.localName?n.AddBinding(t,s,s.value):e.Tracing.logFn(20,function(){return"Root element does not support bindings for width and height..."}),t.removeAttributeNode(s),t.getAttribute(s.localName)||n.Statistics.AttributeCount++;else if("hmi-event"===s.prefix){var a=0,u=s.value,l=s.value.match(/\(\#([^)]+)\)/);switch(l&&l.length>1&&l[1].length>0&&(u=l[1]),s.localName){case"mouseEnter":a=1;break;case"mouseHover":a=2;break;case"mouseLeave":a=3;break;case"wheel":a=4;break;case"up":a=11;break;case"down":a=10;break;case"tapped":a=12;break;case"pan":a=14;break;default:a=0}if(n.Actions[u]){var c=new e.Eventing.Event(a,n.Actions[u],t);n.Events[c.Id]=c}else e.Tracing.logFn(20,function(){return"Event refers to unknown action."});t.removeAttributeNode(s),n.Statistics.EventCount++}else if("xlink"!==s.prefix&&s.prefix&&""!==s.prefix||"xmlns"===s.name)"xmlns"===s.prefix||"xmlns"===s.name?"xmlns"===s.name||"xlink"===s.localName||"hmi"===s.localName||"hmi-element"===s.localName||"hmi-feature"===s.localName||"hmi-bind"===s.localName||"hmi-bind--xlink"===s.localName||"hmi-event"===s.localName||"hmi-flex"===s.localName?n.Statistics.AttributeCount++:(e.Tracing.logFn(20,function(){return"Unsupported namespace definition: "+s.name}),t.removeAttributeNode(s)):t.removeAttributeNode(s);else if("id"===s.name)n.AddId(s.value,t)?n.Statistics.AttributeCount++:(e.Tracing.logFn(20,function(){return'Invalid ID "'+s.value+'" (Redefinition)'}),t.removeAttributeNode(s));else if("style"===s.name)t.removeAttributeNode(s);else{n.Statistics.AttributeCount++;var p=s.value.trim(),h=s.name.charAt(0)>="a"?s.name:s.name.toLowerCase();t.setAttribute(h,p);var f=void 0;"url("===p.substr(0,4)&&")"===p.substr(p.length-1)?(f=p.substr(4,p.length-5),f='"'===f[0]?f.substr(2,f.length-3):f.substr(1),n.AddReference(f,t,s)||(n.Statistics.AttributeCount--,e.Tracing.logFn(20,function(){return'Invalid URL delimiter to unknown ID "'+f+'"'}),t.removeAttributeNode(s))):"href"===s.localName&&"#"===p.substr(0,1)&&(f=p.substr(1),n.AddReference(f,t,s)||(n.Statistics.AttributeCount--,e.Tracing.logFn(20,function(){return'Invalid use reference to unknown ID "'+f+'"'}),t.removeAttributeNode(s)))}}return i},t.prototype.createNVEDefinition=function(t,n,r,i){return void 0===i&&(i=null),__awaiter(this,void 0,void 0,function(){var o,s,a,u,l,c,p,h,f,d,v,m,g;return __generator(this,function(b){switch(b.label){case 0:for(o=i?new e.NVE.ElementDefinition(i,n):new e.NVE.FeatureDefinition(n),s=null,a=t.attributes.length,u=a-1;u>=0;u--)if(l=t.attributes[u],"hmi-bind"===l.prefix)s=new e.Properties.FeatureAttrDefinition(l.localName,l.value,(!0)),s.Valid&&(o.Attributes[s.Id]=s);else if("hmi-event"===l.prefix){switch(c=0,p=l.value,h=l.value.match(/\(\#([^)]+)\)/),h&&h.length>1&&h[1].length>0&&(p=h[1]),l.localName){case"mouseEnter":c=1;break;case"mouseHover":c=2;break;case"mouseLeave":c=3;break;case"wheel":c=4;break;case"up":c=11;break;case"down":c=10;break;case"tapped":c=12;break;case"pan":c=14;break;default:c=0}r.Actions[p]?o.Events[c]=r.Actions[p]:e.Tracing.logFn(20,function(){return"Event refers to unknown action."}),r.Statistics.EventCount++}else s=new e.Properties.FeatureAttrDefinition(l.localName,l.value,(!1)),o.Attributes[s.Id]=s;f=0,b.label=1;case 1:return f<t.childNodes.length?(d=t.childNodes.item(f),1!==d.nodeType||"hmi-feature"!==d.prefix?[3,3]:(m=(v=o.Children).push,[4,this.createNVEDefinition(d,d.localName,r)])):[3,6];case 2:return m.apply(v,[b.sent()]),[3,5];case 3:return 1!==d.nodeType||"hmi"!==d.prefix||"inline"!==d.localName&&"include"!==d.localName?[3,5]:(g=o,[4,this.executeComposition(d,r)]);case 4:g.Template=b.sent(),b.label=5;case 5:return f++,[3,1];case 6:return[2,o]}})})},t.prototype.walk=function(t,n){return __awaiter(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,p,h,f,d,v,m,g;return __generator(this,function(b){switch(b.label){case 0:if(n.Statistics.NodeCount++,r=this.attributes(t,n),t.childNodes.length<=0||r)return[2];i=0,b.label=1;case 1:return i<t.childNodes.length?(o=t.childNodes.item(i),1===o.nodeType||3===o.nodeType||9===o.nodeType?[3,2]:(t.removeChild(o),[3,16])):[3,17];case 2:return o instanceof SVGElement?[4,this.walk(o,n)]:[3,4];case 3:return b.sent(),[3,16];case 4:return"hmi-element"!==o.prefix?[3,8]:this.hasNVE(o.localName)?(s=document.createElement("nve-hint"),a=e.Helpers.GUID.create(),s.textContent=a,t.replaceChild(s,o),l=(u=n).AddNVE,c=[a],[4,this.createNVEDefinition(o,o.localName,n,a)]):[3,6];case 5:return l.apply(u,c.concat([b.sent()])),[3,7];case 6:e.Tracing.logFn(20,function(){return"Unknown NVE... ignoring"}),b.label=7;case 7:return[3,16];case 8:return"hmi"!==o.prefix?[3,16]:(p=!1,"action"!==o.localName?[3,9]:(this.executeHmiAction(o,n),[3,15]));case 9:return"self"!==o.localName?[3,10]:(this.executeHmiSelf(o,n),[3,15]);case 10:return"text"!==o.localName?[3,11]:(h=o,h.getAttributeNode("hmi-bind:value")?n.AddBinding(h,null,h.getAttributeNode("hmi-bind:value").value):h.getAttributeNode("value")&&(f=document.createTextNode(h.getAttributeNode("value").value),t.insertBefore(f,o)),[3,15]);case 11:return"localDef"!==o.localName?[3,12]:(d=o,v=d.getAttributeNode("name").value,n.LocalProps[v]?e.Tracing.logFn(20,function(){return'Invalid localDef ID "'+v+'" (Redefinition)'}):(m=d.getAttributeNode("type").value,g=null,d.getAttributeNode("hmi-bind:value")?(g=new e.Properties.LocalDefinition(v,d.getAttributeNode("hmi-bind:value").value,(!0),m),g.Valid&&(n.Statistics.BindingCount++,n.LocalProps[v]=g)):d.getAttributeNode("value")&&(g=new e.Properties.LocalDefinition(v,d.getAttributeNode("value").value,(!1),m),n.LocalProps[v]=g)),[3,15]);case 12:return"inline"!==o.localName&&"include"!==o.localName?[3,14]:[4,this.executeComposition(o,n)];case 13:return b.sent(),p=!0,[3,15];case 14:e.Tracing.logFn(20,function(){return"Unknown RTelement... ignored"}),b.label=15;case 15:p||t.removeChild(o),b.label=16;case 16:return i++,[3,1];case 17:return[2]}})})},t.prototype.extractPrefix=function(e){return e?e.substr(0,e.lastIndexOf("/")+1):""},t.prototype.executeComposition=function(t,n){return __awaiter(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,p,h,f,d,v,m,g,b,y,P,T,E;return __generator(this,function(w){switch(w.label){case 0:return r="inline"===t.localName,i=void 0!==t.attributes["hmi-bind:forEach"],o=e.Helpers.GUID.create(),r?[3,3]:(o=t.attributes.template.value,s=this.extractPrefix(n.URI),this.hasTemplate(s+o)?[3,2]:[4,this.loadTemplateFromUrl(o,o,s)]);case 1:w.sent(),w.label=2;case 2:return[3,7];case 3:a=0,w.label=4;case 4:return a<t.childNodes.length?"template"!==t.childNodes[a].localName?[3,6]:(u=t.childNodes[a],l=document.implementation.createDocumentType("svg","-//SIEMENS//DTD SVG 1.0 TIA-HMI//EN","http://tia.siemens.com/graphics/svg/1.2/dtd/svg12-hmi.dtd"),c=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",l),c.replaceChild(u.firstElementChild,c.documentElement),[4,this.loadTemplateDocument(c,this.extractPrefix(n.URI)+o)]):[3,7];case 5:w.sent()||e.Tracing.logFn(10,function(){return"Could not load/parse inline template"}),w.label=6;case 6:return a++,[3,4];case 7:for(p=document.createElement("template-hint"),h=p.textContent=e.Helpers.GUID.create(),t.parentNode.replaceChild(p,t),f=new e.Composition.TemplateDefinition(h,o,r,i),n.AddComposition(h,f),d=t.attributes.length,v=null,m=d-1;m>=0;m--)g=t.attributes[m],"width"===g.localName||"height"===g.localName||"x"===g.localName||"y"===g.localName?(b="Actual"+g.localName[0].toUpperCase()+g.localName.substr(1),"hmi-bind"===g.prefix?(v=new e.Properties.ParamDefinition(b,g.value,(!0),1),v.Valid&&(f.LayoutProps[b]=v)):(v=new e.Properties.ParamDefinition(b,g.value,(!1),1),f.LayoutProps[b]=v)):"for"!==g.localName||i?"forEach"===g.localName&&i&&(v=new e.Properties.ParamDefinition(g.localName,g.value,(!0),2),f.HmiProps=v):(v=new e.Properties.ParamDefinition(g.localName,g.value,(!0),2),f.HmiProps=v);for(y=0;y<t.childNodes.length;y++)"param"===t.childNodes[y].localName&&(P=t.childNodes[y],T=P.attributes.name,E=P.attributes.value?P.attributes.value:P.attributes["hmi-bind:value"],"hmi-bind"===E.prefix?(v=new e.Properties.ParamDefinition(T.value,E.value,(!0)),v.Valid&&(f.ParamProps[T.value]=v)):(v=new e.Properties.ParamDefinition(T.value,E.value,(!1)),f.ParamProps[T.value]=v));return[2,h]}})})},t.prototype.executeHmiAction=function(t,n){if(t.attributes.id){var r=t.attributes.id.value,i=t.attributes.condition?t.attributes.condition.value:"true",o=!1;t.attributes["hmi-bind:condition"]&&(i=t.attributes["hmi-bind:condition"].value,o=!0);var s=new e.Eventing.Action(r,i,o);s.Valid&&(n.Actions[r]=s);for(var a=t.childNodes.length-1;a>=0;a--){var u=t.childNodes.item(a);if(1!==u.nodeType||"hmi"!==u.prefix||"setProperty"!==u.localName&&"sendCommand"!==u.localName&&"sendEvent"!==u.localName&&"setCursor"!==u.localName&&"call"!==u.localName)3!==u.nodeType&&t.removeChild(u);else if(u.attributes.name){var l=u.attributes.name.value,c=u.attributes.condition?u.attributes.condition.value:"true",p=!1;u.attributes["hmi-bind:condition"]&&(c=u.attributes["hmi-bind:condition"].value,p=!0);var h=!1,f="";u.attributes.method?f=u.attributes.method.value:(f=u.attributes.value?u.attributes.value.value:"",u.attributes["hmi-bind:value"]&&(f=u.attributes["hmi-bind:value"].value,h=!0));var d="setProperty"===u.localName?1:"sendCommand"===u.localName?2:"sendEvent"===u.localName?3:"setCursor"===u.localName?4:"call"===u.localName?5:0,v=1!==d&&2!==d||!u.attributes.type?null:u.attributes.type.value,m=new e.Eventing.ActionElement(d,l,c,p,f,h,v);m.Valid&&s.Elements.unshift(m)}}}else e.Tracing.logFn(20,function(){return"Anonymous action cannot be referenced..."})},t.prototype.executeHmiSelf=function(t,n){if(t.attributes.type){var r=t.attributes.type.value.toLowerCase(),i=r.indexOf(":");i>0?"item"===r.substr(0,i)?(n.PrimaryType=1,n.SecondaryType=r.substr(i+1)):"part"===r.substr(0,i)?(n.PrimaryType=2,n.SecondaryType=r.substr(i+1)):"system"===r.substr(0,i)?(n.PrimaryType=5,n.SecondaryType=r.substr(i+1)):(n.PrimaryType=0,e.Tracing.logFn(20,function(){return"Invalid type declaration... fallback to <custom>"})):"widget"===r?n.PrimaryType=3:"symbol"===r?n.PrimaryType=4:"custom"===r?n.PrimaryType=0:(n.PrimaryType=0,e.Tracing.logFn(20,function(){return"Invalid type declaration... fallback to <custom>"}))}else e.Tracing.logFn(10,function(){return"Mandatory type missing!"});t.attributes.name?n.ID=t.attributes.name.value:e.Tracing.logFn(20,function(){return"Mandatory template id missing!"}),t.attributes.displayName?n.DisplayName=t.attributes.displayName.value:e.Tracing.logFn(20,function(){return"Mandatory template display name missing!"}),t.attributes.version&&(n.Version=t.attributes.version.value),t.attributes.performanceClass&&(n.PerformanceClass=t.attributes.performanceClass.value.toUpperCase()),t.attributes.optimizations;for(var o=t.childNodes.length-1;o>=0;o--){var s=t.childNodes.item(o);if(1===s.nodeType&&"hmi"===s.prefix&&"paramDef"===s.localName)if(s.attributes.name&&s.attributes.type){var a=s.attributes.name.value;n.ParamProps[a]?e.Tracing.logFn(20,function(){return'Invalid paramDef ID "'+a+'" (Redefinition)'}):n.ParamProps[a]=new e.Properties.Parameter(a,s.attributes.type?s.attributes.type.value:"",s.attributes.default?s.attributes.default.value:null,!!s.attributes["two-way"]&&e.Helpers.Parse.toBoolean(s.attributes["two-way"].value))}else e.Tracing.logFn(20,function(){return"Mandatory id and/or type missing on hmi:paramDef"});else 3!==s.nodeType&&(8!==s.nodeType&&e.Tracing.logFn(20,function(){return"Invalid child node"+(s.nodeName?" "+s.nodeName:"")}),t.removeChild(s))}},t}();e.Engine=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function t(t,n,r,i,o,s,a){void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),this.InstanceId=e.Helpers.GUID.create(),this.RootNode=t,this.RootScope=n,this.Store=o,this.Parent=s,this.NVE=a,this.PrimaryType=r,this.SecondaryType=i}return Object.defineProperty(t.prototype,"rootItem",{get:function(){for(var e=this.Parent?this.Parent:this;e.Parent;)e=e.Parent;return e},enumerable:!0,configurable:!0}),t.prototype.remove=function(t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!0),this.RootNode.parentNode&&n&&this.RootNode.parentNode.removeChild(this.RootNode),this.RootScope[".events"])for(;this.RootScope[".events"].length>0;){var r=this.RootScope[".events"].pop();e.Engine.EventDeregistrationCallback(r.Element,r.EventName,r.Handler)}if(this.RootScope[".nve"])for(;this.RootScope[".nve"].length>0;){var i=this.RootScope[".nve"].pop();i.RootNode.parentNode&&i.RootNode.parentNode.removeChild(i.RootNode),i.Element.remove()}if(this.RootScope[".compositionBindings"])for(;this.RootScope[".compositionBindings"].length>0;){var o=this.RootScope[".compositionBindings"].pop();o.Item&&o.Item.remove(t,!1)}if(t)for(var s in this.RootScope[".links"]){var a=s.match(/[^(\.|\'|\"|\[|\])]+/g);a.reduce(function(e,t,n,r){return n===r.length-1?(Object.defineProperty(e,t,{value:e[t],writable:!0,enumerable:!0,configurable:!0}),e[t]):e[t]},this.RootScope)}},t.prototype.examinePath=function(t,n){void 0===n&&(n=void 0);var r=t.match(/[^(\.|\'|\"|\[|\])]+/g);if(n&&r[0]!==n)return e.Tracing.logFn(10,function(){return"Path does not address "+n+", please prefix correctly!"}),null;var i=0,o="k",s=this,a=[],u="",l=t,c=r.reduce(function(e,n,r,c){i=t.indexOf(n,i);var p=t.lastIndexOf(".",i),h=t.lastIndexOf("[",i);if(o=p>h?"k":h>p?"i":"u",i+=n.length,""===u?u=n:"k"===o?u=u+"."+n:"i"===o&&(u=u+"["+n+"]"),r===c.length-1)return l=n,s.RootScope[".links"][u]&&a.push(u),e;if(e[n])s.RootScope[".links"][u]&&a.push(u);else{var f=t.indexOf(".",i),d=t.indexOf("[",i);d>=0&&(f<0||d<f)?e[n]=[]:e[n]={}}return e[n]},this.RootScope);return{start:c,suffix:l,bound:a}},t.prototype.setProps=function(t,n,r){var i=this,o=this.examinePath(n,r);if(o)if(this.updateProperty(o.start,o.suffix,t,n,o.bound)){e.Tracing.logFn(40,function(){return"Setting '"+n+"' did mutate value(s) and affects "+o.bound.length+" binding target(s)"});for(var s in o.bound){var a=o.bound[s];for(var u in this.RootScope[".links"][a].Affects)e.Tracing.logFn(40,function(){return i.RootScope[".links"][a].Affects[u].TargetName+" turns dirty (as parent)..."}),this.RootScope[".links"][a].Affects[u].IsDirty=!0}}else e.Tracing.logFn(40,function(){return"Setting '"+n+"' did not mutate value(s)."})},t.prototype.setHmiProps=function(t,n,r){if(void 0===n&&(n="HmiProps"),void 0===r&&(r=!1),this.setProps(t,n,"HmiProps"),r)if(this.Parent){n=n.substr(9);var i=this.Parent.RootScope[".compositionBindings"];for(var o in i){var s=i[o];if("HmiProps"===s.Affects&&s.Item&&s.Item.InstanceId===this.InstanceId){var a=(s.Ref[".path"]?s.Ref[".path"].Name:"HmiProps")+"."+n;this.Parent.setHmiProps(t,a,!0)}}}else this.update(),this.PropertyChangedCallback?this.PropertyChangedCallback(n,t):e.Engine.PropertyChangedCallback(n,t,this)},t.prototype.setParamProps=function(e,t){void 0===t&&(t="ParamProps"),this.setProps(e,t,"ParamProps")},t.prototype.setLocalProps=function(e,t){void 0===t&&(t="LocalProps"),this.setProps(e,t,"LocalProps")},t.prototype.getProps=function(e){var t=e.match(/[^(\.|\'|\"|\[|\])]+/g),n=t.reduce(function(e,t){if(e)return e[t]},this.RootScope);return n},t.prototype.updateProperty=function(t,n,r,i,o){void 0===o&&(o=[]);var s=!1;if(null!==t[n]&&void 0!==t[n]&&typeof t[n]!=typeof r&&e.Tracing.logFn(40,function(){return"Data type changed while update!"}),e.ObservableArray.isArray(r)){var a=this;r.forEach(function(e,u){a.updateProperty(t[n],u,r[u],i+"["+u+"]",o)&&(s=!0)});var u=r.length,l=t[n].length;if(u<l&&(t[n].reduce(u),s=!0),this.RootScope[".links"][i]){o.push(i);var c=!1;for(var p in this.RootScope[".links"][i].Affects)this.RootScope[".links"][i].Affects[p]instanceof e.Linkage.CompositionLink&&(c=!0);c||t[n].balance()}else t[n].balance();return s}if("object"==typeof r&&null!==r){for(var h in r)if(r.hasOwnProperty(h)&&"."!==h[0]){var f=!1;if(t instanceof e.ObservableArray&&t.cursor<=n?f=t.extend():void 0===t[n]&&(t[n]={},f=!0),s=this.updateProperty(t[n],h,r[h],i+"."+h,o)||s,f)if(e.ObservableArray.isArray(t)){var d,v=this.getCollectionPath(t,i),m=this.getCollectionDataPath(t);m||(d=this.getFallbackParent(v)),e.DataPreprocessor.prepare(t,m?m.Parent:d,v)}else e.DataPreprocessor.prepare(t[n],t,t[".path"].Name+"."+n)}return this.RootScope[".links"][i]&&o.push(i),s}return t[n]!==r&&(t[n]=r,!0)},t.prototype.getCollectionPath=function(t,n){var r=t&&e.ObservableArray.isArray(t)&&t.length>0&&t[0][".path"]?t[0][".path"].Name:n;return r&&r.lastIndexOf("[")>0&&(r=r.substr(0,r.lastIndexOf("["))),r},t.prototype.getCollectionDataPath=function(t){return t&&e.ObservableArray.isArray(t)&&t.length>0?t[0][".path"]:void 0},t.prototype.getFallbackParent=function(e){var t=e.substr(0,e.lastIndexOf(".")),n=t.match(/[^(\.|\'|\"|\[|\])]+/g);return n.reduce(function(e,t){return e[t]},this.RootScope)},t.prototype.update=function(){var e=this.RootScope[".localBindings"];for(var t in e){var n=e[t];n.IsDirty&&n.update(this.RootScope)}var r={},i=this.RootScope[".nveBindings"];for(var o in i){var s=i[o];if(s.IsDirty){s.update(this.RootScope);for(var a=s.Target;"Parent"in a;)a=a.Parent;r[a.InstanceId]=a}}for(var u in r)r[u].update();var l=this.RootScope[".svgBindings"];for(var c in l){var p=l[c];p.IsDirty&&p.update(this.RootScope)}r={};var h=this.RootScope[".compositionBindings"];for(var f in h){var d=h[f];!d.Item&&d.IsDirty&&d.update(this.RootScope)}for(var v in h){var m=h[v];m.Item&&m.IsDirty&&(m.update(this.RootScope),r[m.Item.InstanceId]=m.Item)}for(var g in r)r[g].update()},t.prototype.unbind=function(e,t,n){if(void 0===t&&(t=-1),void 0===n&&(n=-1),t>=0&&n>=0)for(var r=t;r<n;r++)this.unbind(e+"["+r+"]");else for(var i in this.RootScope[".links"])if(0===i.indexOf(e)){var o=this.RootScope[".links"][i];for(var s in o.Affects)o.Affects[s].Definition.remove(o.Affects[s],this.RootScope)}},t}();e.Item=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function t(t){this.URI=t,this.Statistics=new e.Statistics,this.IDs=new e.Helpers.Dictionary,this.References=new Array,this.Bindings=new e.Helpers.Dictionary,this.LocalProps=new e.Helpers.Dictionary,this.ParamProps=new e.Helpers.Dictionary,this.Actions=new e.Helpers.Dictionary,this.Events=new e.Helpers.Dictionary,this.NVEs=new e.Helpers.Dictionary,this.Compositions=new e.Helpers.Dictionary}return t.prototype.GetBinding=function(e){return this.Bindings[e]},t.prototype.GetNVE=function(e){return this.NVEs[e]},t.prototype.UsesNVE=function(){return Object.keys(this.NVEs).length>0},t.prototype.GetComposition=function(e){return this.Compositions[e]},t.prototype.UsesCompositions=function(){return Object.keys(this.Compositions).length>0},t.prototype.AddNVE=function(e,t){this.NVEs[e]=t},t.prototype.AddComposition=function(e,t){this.Compositions[e]=t},t.prototype.AddBinding=function(t,n,r){var i=new e.Properties.HmiDefinition(t,n,r);i.Valid&&!i.Static&&(this.Bindings[i.Id]=i,this.Statistics.BindingCount++)},t.prototype.ExistsId=function(e){return!!this.IDs[e]},t.prototype.GetId=function(e){return this.IDs[e]},t.prototype.AddId=function(t,n){return!this.ExistsId(t)&&(this.IDs[t]=new e.Svg.Id(n,t),!0)},t.prototype.AddReference=function(t,n,r){if(this.ExistsId(t)){var i=this.GetId(t);return this.References.push(new e.Svg.Reference(n,r,i)),i.IsReferenced=!0,!0}return!1},t.prototype.CleanUpReferences=function(){for(var e in this.IDs){var t=this.IDs[e];t.IsReferenced||(t.Owner.removeAttribute("id"),delete this.IDs[e])}},t.prototype.CleanUpBindings=function(){for(var e in this.Bindings){var t=this.Bindings[e];t.Valid&&!t.Static||(this.Statistics.BindingCount--,delete this.Bindings[e])}},t.prototype.CreateUniqueIDs=function(){var t=new e.Helpers.GUID;for(var n in this.IDs){var r=this.IDs[n];if(r.IsReferenced){var i=t.Generate(n);r.Owner.setAttribute("id",i)}}for(var o=0;o<this.References.length;o++){var s,a=this.References[o];s="href"===a.OwnerAttribute.localName?"#"+t.Generate(a.Target.Id):"url(#"+t.Generate(a.Target.Id)+")";var u=a.OwnerAttribute.name.charAt(0)>="a"?a.OwnerAttribute.name:a.OwnerAttribute.name.toLowerCase();a.OwnerElement.setAttribute(u,s)}},t}();e.RenderingTemplate=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function e(){this.NodeCount=0,this.AttributeCount=0,this.BindingCount=0,this.EventCount=0}return e}();e.Statistics=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function e(){}return e.logFn=function(e,t){e<=this.Level&&this.log(e,t())},e}();t.Level=0,e.Tracing=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){function t(){var e="/* @echo WEBRTPU_V */";return e="[unversioned]"}e.Version=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(t,n,r,i){this.Id=t,this.Template=n,this.Inline=r,this.ForEach=i,this.ParamProps=new e.Helpers.Dictionary,this.LayoutProps=new e.Helpers.Dictionary}return t}();t.TemplateDefinition=n}(t=e.Composition||(e.Composition={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(t,n,r){if(this.Name=t,this.Valid=!1,this.Elements=new Array,this._conExpression=null,r){var i,o=n.trim();if("{{"===o.substr(0,2)&&"}}"===o.substr(o.length-2,2)?i=o.substr(2,o.length-4):"{"===o.substr(0,1)&&"}"===o.substr(o.length-1,1)&&(i=o.substr(1,o.length-2)),i)try{var s=Parser.parse(i);try{this._conExpression=s.simplify(e.Engine.CustomEnums)}catch(e){this._conExpression=s}if(0===this._conExpression.variables().length){var a=this._conExpression.evaluate();this.Valid=Boolean(a),this._conExpression=null}else this.Valid=!0}catch(t){e.Tracing.logFn(20,function(){return"Could not evaluate bindng for action's binding \""+n+'"'})}}else this.Valid=Boolean(n)}return t.prototype.canExecute=function(t,n){if(this.Valid){if(null===this._conExpression)return!0;e.Defaults.resolve(this._conExpression,t,n);var r=this._conExpression.evaluate(t);if(!isNaN(r))return Boolean(r)}return!1},t.prototype.execute=function(e,t,n){void 0===n&&(n=null);for(var r=this.Elements.length,i=0;i<r;i++){var o=this.Elements[i];o.canExecute(e,t)&&o.execute(e,t,n)}t.update()},t}();t.Action=n}(t=e.Eventing||(e.Eventing={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(t,n,r,i,o,s,a){void 0===a&&(a=null),this.Name=n,this.Type=t,this.Valid=!1,this._conExpression=null,this._valExpression=null,this._datatype=a;var u=null,l=null;if(i){u=r.trim();var c;if("{{"===u.substr(0,2)&&"}}"===u.substr(u.length-2,2)?c=u.substr(2,u.length-4):"{"===u.substr(0,1)&&"}"===u.substr(u.length-1,1)&&(c=u.substr(1,u.length-2)),c)try{l=Parser.parse(c);try{this._conExpression=l.simplify(e.Engine.CustomEnums)}catch(e){this._conExpression=l}0===this._conExpression.variables().length?(this.Valid=Boolean(this._conExpression.evaluate()),this._conExpression=null):this.Valid=!0}catch(t){e.Tracing.logFn(20,function(){return"Invalid binding in action element's condition binding with expression \""+r+'"'})}}else this.Valid=Boolean(r);if(this.Valid)if(s){u=o.trim();var p;if("{{"===u.substr(0,2)&&"}}"===u.substr(u.length-2,2)?p=u.substr(2,u.length-4):"{"===u.substr(0,1)&&"}"===u.substr(u.length-1,1)&&(p=u.substr(1,u.length-2)),p)try{l=Parser.parse(p);try{this._valExpression=l.simplify(e.Engine.CustomEnums)}catch(e){this._valExpression=l}0===this._valExpression.variables().length?(this._value=e.Properties.LocalDefinition.convert(this._valExpression.evaluate(),this._datatype),this._valExpression=null):this.Valid=!0}catch(t){e.Tracing.logFn(20,function(){return"Invalid binding in action element's value binding with expression \""+o+'"'})}}else this._value=e.Properties.LocalDefinition.convert(o,this._datatype)}return t.prototype.canExecute=function(t,n){if(this.Valid){if(null===this._conExpression)return!0;try{e.Defaults.resolve(this._conExpression,t,n);var r=this._conExpression.evaluate(t);if(!isNaN(r))return Boolean(r)}catch(t){e.Tracing.logFn(20,function(){return"Could not evaluate action element's condition ..."})}}return!1},t.prototype.execute=function(t,n,r){void 0===r&&(r=null);var i=this._value;if(null!==this._valExpression&&(e.Defaults.resolve(this._valExpression,t,n),i=e.Properties.LocalDefinition.convert(this._valExpression.evaluate(t),this._datatype)),1===this.Type){var o=this.Name,s=o.match(/[^(\.|\'|\"|\[|\])]+/g);if("LocalProps"===s[0]&&void 0!==t.LocalProps[s[1]]){for(var a=0;a<t[".localBindings"].length;a++){var u=t[".localBindings"][a];u.Target===s[1]&&(e.Tracing.logFn(40,function(){return"Disabled expression for LocalProps."+s[1]}),u.Disabled=!0)}t.LocalProps[s[1]]=i}else"HmiProps"===s[0]?(""===s[s.length-1]&&s.pop(),s.reduce(function(t,r,s,a){if(s===a.length-1)if(t[r]=i,n.Parent){var u=o.substr(9),l=n.Parent.RootScope[".compositionBindings"];for(var c in l){var p=l[c];if("HmiProps"===p.Affects&&p.Item&&p.Item.InstanceId===n.InstanceId){var h=(p.Ref[".path"]?p.Ref[".path"].Name:"HmiProps")+"."+u,f=n.examinePath(o);n.Parent.setHmiProps(i,h,!0);for(var d=0;d<f.bound.length;d++){var v=n.RootScope[".links"][f.bound[d]];for(var m in v.Affects)v.Affects[m].IsDirty=!0}n.update()}}}else n.PropertyChangedCallback?n.PropertyChangedCallback(o,i):e.Engine.PropertyChangedCallback(o,i,n);else t[r]=t[r]||{};return t[r]},t)):"ParamProps"===s[0]&&(t[".twoWay"]&&t[".twoWay"][s[1]]?(""===s[s.length-1]&&s.pop(),s.reduce(function(t,r,a,u){if(a===u.length-1)if(t[r]=i,n.Parent){var l=n.Parent.RootScope[".compositionBindings"];for(var c in l){var p=!1,h=l[c];if("ParamProps"===h.Affects&&h.Target===s[1]&&h.Definition.Direct&&h.Item&&h.Item.InstanceId===n.InstanceId){e.Tracing.logFn(40,function(){return"TODO: set ParamProps."+s[1]});var f=h.Definition.DirectProperty,d=f.match(/[^(\.|\'|\"|\[|\])]+/g);"LocalProps"===d[0]?(n.Parent.setLocalProps(i,f),p=!0):"ParamProps"===d[0]?(n.Parent.setParamProps(i,f),p=!0):"HmiProps"===d[0]&&(n.Parent.setHmiProps(i,f,!0),p=!0),p&&n.Parent.update(),n.update()}}}else n.PropertyChangedCallback?n.PropertyChangedCallback(o,i):e.Engine.PropertyChangedCallback(o,i,n);else t[r]=t[r]||{};return t[r]},t)):e.Tracing.logFn(40,function(){return"Cannot set ParamProps."+s[1]+" (not two-way!)"}))}else 4===this.Type?e.Engine.SetCursor(this.Name,"element"===i?n.RootScope.EventArgs[".currentTaget"]:i,n):2===this.Type?e.Engine.SendCommand(this.Name,i,n.rootItem):3===this.Type?e.Engine.SendEvent(this.Name,i,n):5===this.Type&&this.findNveRoot(r,i,this.Name,t.EventArgs)},t.prototype.findNveRoot=function(t,n,r,i){t.Parent?this.findNveRoot(t.Parent,n,r,i):t.Methods&&t.Methods[n]?t.Methods[n](r,i):e.Tracing.logFn(20,function(){return"Action element 'call' addresses method "+n+" which is not available at the associated NVE..."})},t}();t.ActionElement=n}(t=e.Eventing||(e.Eventing={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function n(t,n,r){if(void 0===r&&(r=null),this.Id=e.Helpers.GUID.create(),this.Type=t,this.Action=n,r){var i=document.createElement("event-hint");i.textContent=this.Id,r.appendChild(i)}}return n.prepareEvent=function(e,t){switch(e.Modifiers=(e.getModifierState("Control")?1:0)+(e.getModifierState("Shift")?2:0)+(e.getModifierState("Alt")?4:0),e.Trigger=0!==e.which?e.button+16:0,e.deltaX=0,e.deltaY=0,t){case 14:e.deltaX=e.pageX-n.LastMouseX,e.deltaY=e.pageY-n.LastMouseY,n.LastMouseX=e.pageX,n.LastMouseY=e.pageY}},n.DefaultEventTransformer=function(e,t,n){var r=n.RootNode.getBoundingClientRect(),i={".type":t,X:e.pageX-r.left,Y:e.pageY-r.top,Modifiers:e.Modifiers,Trigger:e.Trigger,PanDeltaX:e.deltaX,PanDeltaY:e.deltaY};return i[".currentTaget"]=e.currentTarget,i},n.prototype.activate=function(n,r,i){if(void 0===i&&(i=null),r.NVE)return e.Tracing.logFn(20,function(){return"Child template of NVE element or feature does not support eventing! "}),null;var o=this,s=null,a=function(t){r.RootScope.EventArgs=e.Engine.EventTransformer(t,o.Type,r),o.Action.canExecute(r.RootScope,r)&&o.Action.execute(r.RootScope,r,i),t.preventDefault(),delete r.RootScope.EventArgs};if(e.Engine.EventRegistrationCallback(n,this.Type,a,s)){var u=new t.EventLink(n,this.Type,null===s?a:s);return i||r.RootScope[".events"].push(u),u}return null},n.prototype.deactivate=function(t){e.Engine.EventDeregistrationCallback(t.Element,t.EventName,t.Handler)},n.DefaultEventRegistration=function(e,t,r,i){var o,s,a=function(e){n.prepareEvent(e,t),r(e)},u=function(){document.removeEventListener("mousemove",a,!0),document.removeEventListener("mouseup",u,!0)},l=function(e){n.LastMouseX=e.pageX,n.LastMouseY=e.pageY,document.addEventListener("mousemove",a,!0),document.addEventListener("mouseup",u,!0)},c=function(e){document.removeEventListener("mouseup",c,!0),a(e)},p=function(){document.addEventListener("mouseup",c,!0)};switch(i=a,t){case 10:o="mousedown";break;case 11:o="mousedown",s=p,i=p;break;case 12:o="click";break;case 1:o="mouseenter";break;case 3:o="mouseleave";break;case 2:o="mousemove";break;case 13:o="contextmenu";break;case 4:o="wheel";break;case 14:o="mousedown",s=l,i=l;break;default:o=null}return null!==o&&(e.addEventListener(o,s?s:a),!0)},n.DefaultEventDeregistration=function(e,t,n){var r;switch(t){case 10:r="mousedown";break;case 11:r="mousedown";break;case 12:r="click";break;case 1:r="mouseenter";break;case 3:r="mouseleave";break;case 2:r="mousemove";break;case 13:r="contextmenu";break;case 4:r="wheel";break;case 14:r="mousedown";break;default:r=null}return null!==r&&(e.removeEventListener(r,n),!0)},n}();t.Event=n}(t=e.Eventing||(e.Eventing={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.Element=e,this.EventName=t,this.Handler=n}return e}();e.EventLink=t}(t=e.Eventing||(e.Eventing={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.Dictionary=t}(t=e.Helpers||(e.Helpers={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(){}return t.translate=function(e){if("string"==typeof e&&e.length>0){var t=e.trim().toLowerCase().replace(/-(.)/g,function(e,t){
return e="",t.toUpperCase()});return t.replace(/^[a-z]/,t[0].toUpperCase())}return null},t.resolve=function(t,n){return"number"==typeof n?n:e.Engine.CustomEnums[t][this.translate(n)]},t}();t.Enums=n}(t=e.Helpers||(e.Helpers={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function t(){this.Map=new e.Dictionary}return t.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},t.create=function(){return(this.s4()+this.s4()+"-"+this.s4()+"-4"+this.s4().substr(0,3)+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()).toLowerCase()},t.prototype.AlreadyMapped=function(e){return!!this.Map[e]},t.prototype.Generate=function(e){return void 0===e&&(e=null),null===e?t.create():(this.Map[e]||(this.Map[e]=t.create()),this.Map[e])},t}();e.GUID=t}(t=e.Helpers||(e.Helpers={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t=function(){function e(e){if(void 0===e&&(e=null),this.diff=0,this.max=0,this.length=0,Array.isArray(e))for(var t in e)this[t]=e[t],this.length++;this.max=this.length}return Object.defineProperty(e.prototype,"cursor",{get:function(){return this.length+this.diff},enumerable:!0,configurable:!0}),e.prototype.pop=function(){return this.diff--,this[this.length+this.diff]},e.prototype.push=function(e){var t=this.length+ ++this.diff;this[t-1]=e,t>this.max&&(this.max=t)},e.prototype.extend=function(){var e=this.length+ ++this.diff,t=!this[e-1];return this[e-1]=this[e-1]||{},e>this.max&&(this.max=e),t},e.prototype.reduce=function(e){this.cursor>e&&(this.diff=-1*(this.length-e))},e.prototype.balance=function(){if(0!==this.diff){if(this.cursor<this.max)for(var e=this.max-1;e>=this.cursor;e--)delete this[e];this.length=this.cursor,this.max=this.length,this.diff=0}},e.prototype.forEach=function(e){for(var t=0;t<this.cursor;t++)e(this[t],t,this)},e.isArray=function(t){return Array.isArray(t)||t instanceof e},e}();e.ObservableArray=t}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(){}return e.toBoolean=function(e){return"false"!==e&&"null"!==e&&"NaN"!==e&&"undefined"!==e&&"0"!==e&&!!e},e}();e.Parse=t}(t=e.Helpers||(e.Helpers={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(e){this.Target=e.Id,this.Definition=e,this.IsDirty=!1,this.Disabled=!1,this.TwoWay=!1;var t=e.Affects;this.Affects=0===t?"ParamProps":2===t?"HmiProps":"Layout"}return Object.defineProperty(t.prototype,"TargetName",{get:function(){return this.Affects+"."+this.Target},enumerable:!0,configurable:!0}),t.prototype.update=function(e){if(this.Disabled)return void(this.IsDirty=!1);var t=void 0;if(1===this.Definition.Affects)t=this.Definition.resolve(e,!0,this),this.Item.RootScope[this.Affects][this.Target]!==t&&(this.Item.RootScope[this.Affects][this.Target]=t);else if(0===this.Definition.Affects)t=this.Definition.resolve(e,!0,this),this.Item.RootScope[this.Affects][this.Target]!==t&&this.Item.setParamProps(t,"ParamProps."+this.Target);else if(this.Item)t=this.Definition.resolve(e,!0,this),this.Item.RootScope[this.Affects]!==t&&this.Item.setHmiProps(t);else{var n=this.getCollectionPath(),r=this.getCollectionLength(!1);t=this.Definition.resolve(e,!0,this);var i=this.getCollectionPath(),o=this.getCollectionLength(),s=e[".owner"];if(n!==i){s.unbind(n);var a=this.Engine.composeCollection(this.TemplateDef,this.Template,e,s);this.CollectionNode.parentNode.replaceChild(a,this.CollectionNode)}else if(r!==o){if(r<o)for(var u=this.TemplateDef.HmiProps.resolve(e,!1),l=r;l<o;l++){var c=this.Engine.establishSingleComposition(this.TemplateDef,this.Template,e,s,u,l);this.CollectionNode.appendChild(c)}else s.unbind(n,o,r);this.resetCollectionLength()}else this.resetCollectionLength()}this.IsDirty=!1},t.prototype.getCollectionPath=function(){var t=this.Ref&&e.ObservableArray.isArray(this.Ref)&&this.Ref.length>0?this.Ref[0][".path"].Name:void 0;return t&&t.lastIndexOf("[")>0&&(t=t.substr(0,t.lastIndexOf("["))),t},t.prototype.getCollectionLength=function(t){return void 0===t&&(t=!0),this.Ref&&this.Ref instanceof e.ObservableArray?t?this.Ref.cursor:this.Ref.length:0},t.prototype.resetCollectionLength=function(){this.Ref&&this.Ref instanceof e.ObservableArray&&this.Ref.balance()},t}();t.CompositionLink=n}(t=e.Linkage||(e.Linkage={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Value=e,this.Affects=new Array,this.Affects.push(t)}return e}();e.Data=t}(t=e.Linkage||(e.Linkage={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e){this.Target=e.Id,this.Definition=e,this.IsDirty=!1,this.Disabled=!1}return Object.defineProperty(e.prototype,"TargetName",{get:function(){return"LocalProps."+this.Target},enumerable:!0,configurable:!0}),e.prototype.update=function(e){if(this.Disabled)return void(this.IsDirty=!1);var t=this.Definition.resolve(e);e.LocalProps[this.Target]!==t&&(e.LocalProps[this.Target]=t),this.IsDirty=!1},e}();e.LocalLink=t}(t=e.Linkage||(e.Linkage={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Target=e,this.Definition=t,this.IsDirty=!1}return Object.defineProperty(e.prototype,"TargetName",{get:function(){return this.Definition.Id},enumerable:!0,configurable:!0}),e.prototype.update=function(e){this.Target.Attributes[this.Definition.Id]=this.Definition.resolve(e),this.Target.propertyChanged&&this.Target.propertyChanged(this.Definition.Id),this.IsDirty=!1},e}();e.FeatureAttrLink=t}(t=e.Linkage||(e.Linkage={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Target=e,this.Definition=t,this.IsDirty=!1}return Object.defineProperty(e.prototype,"TargetName",{get:function(){return"<"+this.Target.localName+" "+(this.Definition.OwnerAttribute?this.Definition.OwnerAttribute.localName:"")+"> "},enumerable:!0,configurable:!0}),e.prototype.update=function(e){this.Definition.resolve(this.Target,e),this.IsDirty=!1},e}();e.SvgLink=t}(t=e.Linkage||(e.Linkage={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(){this.Attributes={},this.Features=new Array,this.Methods=new e.Helpers.Dictionary}return t.prototype.create=function(t){if(e.Engine.hasContent(t.PrimaryType,t.SecondaryType))this._item=t,this._content=e.Engine.getContent(t.PrimaryType,t.SecondaryType),this._dom=document.createElementNS("http://www.w3.org/2000/svg","g"),this._dom.setAttribute("transform","translate("+this.Attributes.left+","+this.Attributes.top+")"),this._node=this._content.RequestContentCallback(t,this.Attributes.left,this.Attributes.top,this.Attributes.width,this.Attributes.height),this._dom.appendChild(this._node);else{this._dom=document.createElementNS("http://www.w3.org/2000/svg","g");var n=document.createComment("There is no item-specific content to show...");this._dom.appendChild(n)}return this._dom},t.prototype.remove=function(){},t.prototype.update=function(){this._dom.setAttribute("transform","translate("+this.Attributes.left+","+this.Attributes.top+")"),this._item&&this._content&&this._content.UpdateContentCallback(this._item,this.Attributes.left,this.Attributes.top,this.Attributes.width,this.Attributes.height,this._node)},t}();t.BuiltInContent=n}(n=t.BuiltIn||(t.BuiltIn={}))}(t=e.NVE||(e.NVE={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(t,n){this.Id=t,this.Type=n,this.Children=new Array,this.Attributes=new e.Helpers.Dictionary,this.Events=new e.Helpers.Dictionary,this.Template=null}return t}();t.ElementDefinition=n}(t=e.NVE||(e.NVE={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Element=e,this.RootNode=t}return e}();e.ElementLink=t}(t=e.NVE||(e.NVE={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function t(t){this.Type=t,this.Children=new Array,this.Attributes=new e.Helpers.Dictionary,this.Template=null,this.Events=new e.Helpers.Dictionary}return t}();t.FeatureDefinition=n}(t=e.NVE||(e.NVE={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(){function n(){}return Object.defineProperty(n.prototype,"Static",{get:function(){return!this._expression&&!this._fastLane},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Direct",{get:function(){return!!this._fastLane},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"DirectProperty",{get:function(){return this._fastLane},enumerable:!0,configurable:!0}),n.prototype.sharedParse=function(n,r,i,o){var s=this;void 0===o&&(o=function(e){return e});var a=null,u=this;if(this.Id=n,i){this.Valid=!1;var l=r.trim();if("{{"===l.substr(0,2)&&"}}"===l.substr(l.length-2,2))try{var c=l.substr(2,l.length-4),p=Parser.parse(c);this._expression=p.simplify(e.Engine.CustomEnums);var h=this._expression.variables().length;if(0===h){this.Valid=!0;var f=this._expression.evaluate();a=f,this._expression=null}else e.Tracing.logFn(40,function(){return"Properties to be bound: "+s._expression.variables()}),this.Valid=!0,1===h&&1===this._expression.numberOfTokens()&&(this._expression=null,u._fastLane=c.trim(),e.Tracing.logFn(40,function(){return"FasdtLane is used for : "+u._fastLane}))}catch(t){e.Tracing.logFn(20,function(){return"Faulty binding expression: "+n+" => "+r})}else if("{"===l.substr(0,1)&&"}"===l.substr(l.length-1,1)){var d=this instanceof t.ParamDefinition,v=this instanceof t.FeatureAttrDefinition,m=this instanceof t.LocalDefinition;if(d||v||m){var g=l.substr(1,l.length-2).trim();g.indexOf(" ")<0?(u._fastLane=g,e.Tracing.logFn(40,function(){return"Property to be bound directly (no expression): "+u._fastLane}),this.Valid=!0):e.Tracing.logFn(20,function(){return"Faulty direct binding (contains spaces, seems to be an expression?) "+n+" => "+r})}else e.Tracing.logFn(20,function(){return"Trying to use direct binding syntax within unsupported attribute... (for/forEach/paramters only!)"})}}else this.Valid=!0,a=o(r);return a},n.prototype.defaultSetter=function(e,t){return e.Value!==t&&(e.Value=t,!0)},n.prototype._resolveDirect=function(t,n){var r=t.match(/[^(\.|\'|\"|\[|\])]+/g);if("HmiProps"!==r[0]&&"LocalProps"!==r[0]&&"ParamProps"!==r[0]&&"Layout"!==r[0])throw e.Tracing.logFn(10,function(){return"Invalid variable: "+t}),new Error;return r.reduce(function(e,t){return e&&void 0!==e[t]?e[t]:""===t?e:void 0},n)},n.prototype._setupOne=function(t,n,r,i){var o=t.match(/[^(\.|\'|\"|\[|\])]+/g);""===o[o.length-1]&&o.pop(),"HmiProps"!==o[0]&&"LocalProps"!==o[0]&&"ParamProps"!==o[0]&&"Layout"!==o[0]||o.reduce(function(s,a,u,l){var c=t;if(u===l.length-1)if(r[".links"][c])r[".links"][c].Affects.push(n);else{"LocalProps"===o[0]&&s[".path"]&&e.Tracing.logFn(10,function(){return"Spock: Fascinating!"});var p=new e.Linkage.Data(s[a],n),h=Object.getOwnPropertyDescriptor(s,a);h&&!h.hasOwnProperty("value")?e.Tracing.logFn(10,function(){return"Trying to create getter/setter for already bound."}):(r[".links"][c]=p,Object.defineProperty(s,a,{get:function(){return p.Value},set:function(t){if(i(p,t)){e.Tracing.logFn(40,function(){return"New value for "+c+": "+t});for(var n in p.Affects)e.Tracing.logFn(40,function(){return p.Affects[n].TargetName+" turns dirty..."}),p.Affects[n].IsDirty=!0}else e.Tracing.logFn(40,function(){return"Value for "+c+" remained the same: "+t})}}))}return s[a]},r)},n.prototype.sharedSetup=function(e,t,n){if(void 0===n&&(n=this.defaultSetter),this._fastLane)this._setupOne(this._fastLane,e,t,n);else{var r=this._expression.variables();for(var i in r)this._setupOne(r[i],e,t,n)}},n.prototype.remove=function(t,n){var r=this._fastLane?Array(this._fastLane):this._expression.variables();for(var i in r){var o=r[i],s=o.match(/[^(\.|\'|\"|\[|\])]+/g);""===s[s.length-1]&&s.pop(),"HmiProps"!==s[0]&&"LocalProps"!==s[0]&&"ParamProps"!==s[0]&&"Layout"!==s[0]||s.reduce(function(r,i,s,a){var u=o;if(s===a.length-1)if(n[".links"][u]){for(var l=n[".links"][u].Affects.length-1,c=l;c>=0;c--){var p=n[".links"][u].Affects[c];p===t&&(n[".links"][u].Affects.splice(c,1),t instanceof e.Linkage.CompositionLink&&t.Item&&t.Item.remove())}0===n[".links"][u].Affects.length&&(delete n[".links"][u],Object.defineProperty(r,i,{value:r[i],writable:!0,enumerable:!0,configurable:!0}))}else e.Tracing.logFn(10,function(){return"No link related to binding... seems something went wrong!"});return r[i]},n)}},n}();t.Definition=n}(t=e.Properties||(e.Properties={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(t){function n(e,n,r){var i=t.call(this)||this;return i.Value=i.sharedParse(e,n,r),i}return __extends(n,t),n.prototype.resolve=function(t){var n=this._fastLane?this._resolveDirect(this._fastLane,t):this._expression.evaluate(t);return"object"==typeof n&&(n=e.DataPreprocessor.clone(n)),n},n.prototype.setup=function(t,n){var r=new e.Linkage.FeatureAttrLink(t,this),i=n[".nveBindings"];i.push(r),this.sharedSetup(r,n)},n.prototype.bind=function(t,n,r){return this._fastLane?e.Defaults.resolveOne(this._fastLane,n,r):e.Defaults.resolve(this._expression,n,r),this.setup(t,n),this.resolve(n)},n}(t.Definition);t.FeatureAttrDefinition=n}(t=e.Properties||(e.Properties={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(t){function n(n,r,i){var o=t.call(this)||this;o.Valid=!1,o.Id=e.Helpers.GUID.create(),o.OwnerAttribute=r,o.OwnerElement=n,o.Expression=i.trim();var s="",a=n;if(!r||"d"!==r.localName&&"points"!==r.localName&&"transform"!==r.localName)"{{"===o.Expression.substr(0,2)&&"}}"===o.Expression.substr(o.Expression.length-2,2)?s=o.Expression.substr(2,o.Expression.length-4):"{"===o.Expression.substr(0,1)&&"}"===o.Expression.substr(o.Expression.length-1,1)&&(o._fastLane=o.Expression.substr(1,o.Expression.length-2).trim(),o.Valid=!0,s="");else{var u=o.Expression;u="{{"===u.substr(0,2)?u.replace("{{","("):"{"===u.substr(0,1)?u.replace("{","("):"'"+u,"}}"===u.substr(u.length-2)?(u=u.substr(0,u.length-2),u+=")"):"}"===u.substr(u.length-1)?(u=u.substr(0,u.length-1),u+=")"):u+="'",u=u.replace(/{{/g,"' + ("),u=u.replace(/}}/g,") + '"),u=u.replace(/{/g,"' + ("),s=u.replace(/}/g,") + '")}if(""!==s)try{var l=Parser.parse(s);o._expression=l.simplify(e.Engine.CustomEnums);var c=o._expression.variables().length;if(0===c){o.Valid=!0;var p=o._expression.evaluate();null!==r?(e.Tracing.logFn(40,function(){return"Binding has no bound properties, resolved attribute once!"}),o.applyAttribute(a,r,p,!0)):(e.Tracing.logFn(40,function(){return"Binding has no bound properties, resolved text content once!"}),o.applyText(a,p,!0)),o._expression=null}else e.Tracing.logFn(40,function(){return"Properties to be bound: "+o._expression.variables()}),o.Valid=!0,1===c&&1===o._expression.numberOfTokens()&&(o._expression=null,o._fastLane=s.trim(),e.Tracing.logFn(40,function(){return"FasdtLane is used for : "+o._fastLane}))}catch(t){e.Tracing.logFn(20,function(){return"Faulty binding expression => "+i})}if(o.Valid&&!o.Static){var h=document.createElement("binding-hint");h.textContent=o.Id,null!==r?n.appendChild(h):n.parentNode.insertBefore(h,n),e.Tracing.logFn(40,function(){return"Added binding hint to DOM."})}return o}return __extends(n,t),n.prototype.applyAttribute=function(t,n,r,i){if(void 0===i&&(i=!1),"hmi"===n.prefix)"if"===n.localName&&(r?t.setAttribute("display","block"):(i&&t.parentNode.removeChild(t),t.setAttribute("display","none")));else if("hmi-bind--xlink"===n.prefix){var o=e.Engine.XLinkTransformation;t.setAttributeNS("http://www.w3.org/1999/xlink",n.localName,o?o(r):r)}else t.setAttribute(n.localName,r)},n.prototype.applyText=function(e,t,n){if(void 0===n&&(n=!0),!(e instanceof Text)){var r=document.createTextNode(t);return n===!1?e.parentNode.insertBefore(r,e):e.parentNode.replaceChild(r,e),r}e.textContent=t},n.prototype.setup=function(t,n){var r=new e.Linkage.SvgLink(t,this),i=n[".svgBindings"];i.push(r),this.sharedSetup(r,n)},n.prototype.resolve=function(t,n){var r=t;try{var i=this._fastLane?this._resolveDirect(this._fastLane,n):this._expression.evaluate(n),o=this.OwnerAttribute;if(null!==o)this.applyAttribute(r,o,i);else{if(i=i.replace(/ /g," "),!(r instanceof Text))return this.applyText(r,i,!1);r.textContent=i}return t}catch(t){e.Tracing.logFn(20,function(){return"Error evaluating expression and/or setting result..."})}},n.prototype.bind=function(t,n,r){try{this._fastLane?e.Defaults.resolveOne(this._fastLane,n,r):e.Defaults.resolve(this._expression,n,r),this.setup(this.resolve(t,n),n)}catch(t){e.Tracing.logFn(20,function(){return"Not all bound properties could be resolved..."})}return!1},n}(t.Definition);t.HmiDefinition=n}(t=e.Properties||(e.Properties={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(t){function n(e,r,i,o){var s=t.call(this)||this;return s.Value=s.sharedParse(e,r,i,function(e){return n.convert(e,o)}),s}return __extends(n,t),n._parseBoolean=function(e){if("string"==typeof e){if("true"===e)return!0;if("false"===e)return!1;var t=Number(e);return!isNaN(t)&&0!==t}return"boolean"==typeof e?e:"number"==typeof e&&(!isNaN(e)&&0!==e)},n.convert=function(e,t){var n;return n="number"===t?Number(e):"boolean"===t?this._parseBoolean(e):e},n.prototype.resolve=function(t){var n=this._fastLane?this._resolveDirect(this._fastLane,t):this._expression.evaluate(t);return"object"==typeof n&&(n=e.DataPreprocessor.clone(n)),n},n.prototype.setup=function(t){var r=new e.Linkage.LocalLink(this),i=t[".localBindings"];i.push(r),this.sharedSetup(r,t,function(e,t){var r=n.convert(t,typeof e.Value);return e.Value!==r&&(e.Value=r,!0)})},n.prototype.bind=function(t,n){return this._fastLane?e.Defaults.resolveOne(this._fastLane,t,n):e.Defaults.resolve(this._expression,t,n),this.setup(t),this.resolve(t)},n}(t.Definition);t.LocalDefinition=n}(t=e.Properties||(e.Properties={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(t){var n=function(t){function n(e,n,r,i){void 0===i&&(i=0);var o=t.call(this)||this;return o.Affects=i,o.Value=o.sharedParse(e,n,r),o}return __extends(n,t),n.prototype.resolve=function(t,n,r){void 0===n&&(n=!0),void 0===r&&(r=null);var i=this._fastLane?this._resolveDirect(this._fastLane,t):this._expression.evaluate(t);return"object"==typeof i&&(r&&(r.Ref=i),n&&(i=e.DataPreprocessor.clone(i))),i},n.prototype.setup=function(t){var n=new e.Linkage.CompositionLink(this),r=t[".compositionBindings"];return r.push(n),this.sharedSetup(n,t),n},n.prototype.bind=function(t,n){try{this._fastLane?e.Defaults.resolveOne(this._fastLane,t,n):e.Defaults.resolve(this._expression,t,n);var r=this.setup(t);return this.Value=this.resolve(t,!0,r),r}catch(t){e.Tracing.logFn(20,function(){return"Not all bound properties could be resolved... (composition)"})}},n}(t.Definition);t.ParamDefinition=n}(t=e.Properties||(e.Properties={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function t(t,n,r,i){this.Id=t,this.Default=e.LocalDefinition.convert(r,n),this.TwoWay=i}return t}();e.Parameter=t}(t=e.Properties||(e.Properties={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Owner=e,this.Id=t,this.IsReferenced=!1}return e}();e.Id=t}(t=e.Svg||(e.Svg={}))}(WebRTPU||(WebRTPU={}));var WebRTPU;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.OwnerElement=e,this.OwnerAttribute=t,this.Target=n}return e}();e.Reference=t}(t=e.Svg||(e.Svg={}))}(WebRTPU||(WebRTPU={}));
//# sourceMappingURL=webrtpu.min.js.map
