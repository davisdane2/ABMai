/* Version 1.0.0, copyright (C) 2015, Siemens AG. All Rights Reserved. */
SWAC.Component=function(a,b,c,d,e){var f=null,g=a,h=b,i=""!==e&&null!==e&&void 0!==e?e:b.src,j=d,k=null,l=function(){return c},m=!1,n="hidden",o=!1,p=new SWAC.Eventing.Event("onReady"),q={},r=new SWAC.Authentication(a),s={},t={},u={},v=SWAC.Guid.generate(),w=function(a){var b,c=new SWAC.Defer,d=a?"visible":"hidden";return o?c.reject("Invalid component"):"ui"!==j.flavor?c.reject("Component needs to be UI"):d===n?c.fulfill():(b=function(){n=d,h.style.width=j.width,h.style.height=j.height,h.style.display=a?"block":"none",c.fulfill()},SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Internal||1e3,"show",[a]).then(b,b)),c.promise},x=function(a){var b=new SWAC.Defer,c=function(){h.src="",h.parentNode.removeChild(h),SWAC.Container._internal.remove(g),o=!0,s=null,t=null,u=null};return o?b.reject("Component is invalid."):SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Remove||2e3,"remove",[a]).then(function(){c(),b.fulfill()},function(a){c(),b.reject(a)}),b.promise},y=function(){var a=new SWAC.Defer;return SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.CleanUp||6e4,"cleanUp",[],!0).then(function(){a.fulfill()},function(b){a.reject(b)}),a.promise},z=function(a,b,c,d){var e=new SWAC.Defer;return o||"ui"!==j.flavor?(e.reject("Invalid component or UI not present"),e.promise):("hidden"!==n&&(h.style.left=a,h.style.top=b,h.style.width=c,h.style.height=d),SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Internal||1e3,"position",[a,b,c,d]).then(function(){e.fulfill()},function(a){e.reject(a)}),e.promise)},A=function(){return{left:h.style.left,top:h.style.top,width:h.style.width,height:h.style.height}},B=function(a,b){var c=new SWAC.Defer;return SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Proxy.Functions||5e3,"call",[a,b]).then(function(a){c.fulfill(a)},function(a){c.reject(a)}),c.promise},C=function(a){var b=new SWAC.Defer;return SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Proxy.Internal||1e3,"beginRequestInterface",[a]).then(function(c){var d=c;d?(k._internal.exposeInterface(d.name,d.api,d.events),k.beginGet(a).then(function(a){b.fulfill(a)},function(a){b.reject(a)})):b.reject("Interface not found")},function(a){b.reject(a)}),b.promise},D=function(a){return SWAC.Services._internal.beginRequestService(a,g)},E=function(a,b,c){return SWAC.Services._internal.callMethod(g,c,a,b)},F=function(a,b,c,d){var e,h,i,j,l,m,n,o=new SWAC.Defer,r=0;for(n in a)a.hasOwnProperty(n)&&(j=a[n].join(", "),l="return function ("+j+') { var myargs = Array.prototype.slice.call(arguments, 0); var args = ["'+n+'", myargs ]; return fn.apply( ctx, args ); };',s[n]=new Function("ctx","fn",l)(this,B));for(r=0;r<b.length;r++)m=b[r],s[m]=new SWAC.Eventing.Event(m);return this.interfaces=k=new SWAC.Interfaces(d,this),e=function(a){o.reject(a)},h=function(){var a=SWAC.Services.list();SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Internal||1e3,"ready",[a]).then(function(a){SWAC.Container.onReady.fire({name:g}),p.fire({name:g}),o.fulfill(a)},e)},i=SWAC.DPC.Flags.Proxy|SWAC.DPC.Permissions.Write|SWAC.DPC.Permissions.Read,f=new SWAC.DPC.Node(H(),v,i),q=f.access(v),SWAC.Communication._internal.beginCall(g,SWAC.Config.TimeOuts.Internal||1e3,"bind",[]).then(h,e),o.promise},G=function(a,b,c){"string"==typeof c?k._internal.fire(a,b,c):s[a].fire(b)},H=function(){return function(a,b,c){if("add"===b||"set"===b||"remove"===b)SWAC.Communication._internal.dpcChanged(g,a,b,c);else if("get"===b)return SWAC.Communication._internal.beginDpcGet(g,a)}},I=function(a,b,c){var d;"remove"===b?q.remove(a):"add"===b?(-1!==a.toLowerCase().indexOf("private.")&&(c.flags=c.flags^SWAC.DPC.Permissions.Write),q.add(a,c.flags),"private"===a&&(t=f.open("private").access(),this.status=t),"public"===a&&(u=f.open("public").access(),this.dpc=u)):"set"===b&&(-1!==a.toLowerCase().indexOf("private.")&&(c.flags=c.flags^SWAC.DPC.Permissions.Write),q.set(a,null,c.type,c.flags),window.addEventListener||"private.isDirty"===a&&"boolean"==typeof c.value&&SWAC.Container._internal.setComponentInternalStatus(g,c.value)),"set"===b&&-1!==a.toLowerCase().indexOf("private.")&&(d=function(){return function(a){"boolean"==typeof a&&SWAC.Container._internal.setComponentInternalStatus(g,a)}},f.access().open(a).beginGet().then(d()))},J=function(a){x(a)},K=function(a,b){return r._internal.beginHandshake(a,null,b)},L=function(a){r._internal.receiveMessage(a)},M=function(){return i},N=function(a){i=a},O=function(){return r.getDomain()};this.beginShow=w,this.beginRemove=x,this.getDomain=O,this.beginPosition=z,this.beginCleanUpRequest=y,this.getPosition=A,this.type=l,this.name=function(){return g},this.lastIsDirtyValue=m,this.hasUI=function(){return"ui"===j.flavor},this.onReady=p,this._internal={beginExpose:F,close:J,fire:G,dpcChanged:I,beginHandshake:K,tlsMessage:L,beginRequestInterface:C,beginRequestService:D,callService:E,setCurrentUrl:N,getCurrentUrl:M,iframe:h},this.proxy=s,this.interfaces=null},SWAC.Container=function(){var a={},b={},c=new SWAC.DPC.Node(null,"Owner",SWAC.DPC.Permissions.Read,"status",!1);c.set("Owner","isDirty",!1,"boolean");var d=function(c){var d=new SWAC.Defer,e=c.parent?c.parent:document.body,f=c.source,g=c.settings,h=c.name,i=null,j=null,l=document.createElement("iframe");return l.src=f,l.frameBorder=0,l.name=h,l.style.position="absolute",l.SWACLoaded=!1,"ui"===g.flavor||g.left&&g.top?window.addEventListener||g.left&&g.top?(l.style.left=g.left,l.style.top=g.top):(g.left="0px",g.top="0px"):(g.left="0px",g.top="0px"),l.style.width="0px",l.style.height="0px",l.style.display="none",b[c.name].iframe=l,i=function(c){var e=c.target?c.target:c.srcElement;return e?((b[e.name]||a[e.name])&&(l.SWACLoaded===!1?(l.SWACLoaded=!0,d.fulfill(l)):(k(e.name),l.src="",l.parentNode.removeChild(l))),void 0):(d.reject("Error creating Iframe"),void 0)},l.addEventListener?l.addEventListener("load",i):l.attachEvent("onload",i),j=function(){l.src="",e.removeChild(l),d.reject("Error creating Iframe")},l.addEventListener?l.addEventListener("error",j):l.attachEvent("onerror",j),e.appendChild(l),d.promise},e=function(c){var e,f=new SWAC.Defer,g=0,h=0,i=0,j=null,k=null,l=0;if(Array.isArray(c)){for(i=c.length,e=function(){g===i?f.fulfill():g+h===i&&f.reject("Error during component/s creation")},j=function(){g++,e()},k=function(){h++,e()},l=0;l<c.length;l++)b[c[l].name]||a[c[l].name]?(h++,e(),SWAC.Container.onFailure.fire({name:c[l].name,details:{phase:"creation",proceed:"no"}})):SWAC.Container.beginCreate(c[l]).then(j,k);return f.promise}return"object"==typeof c&&null!==c?(b[c.name]={name:c.name,type:c.type,state:"pending",settings:c.settings,promise:f,lastUrl:""},d(c).then(function(a){var d=function(){b[c.name]&&"pending"===b[c.name].state&&(a.src="",a.parentNode.removeChild(a),SWAC.Container.onFailure.fire({name:c.name,details:{phase:"creation",proceed:"no"}}),b[c.name].promise.reject("Time-out expired during IFrame creation. (SWAC.Config.TimeOuts.Create)"),delete b[c.name])};b[c.name]&&(b[c.name].timeout=window.setTimeout(d,SWAC.Config.TimeOuts.Create||1e3))},function(a){f.reject(a)}),f.promise):(f.reject("Container.create: Wrong argument(s)"),f.promise)},f=function(c,d){var e=d?a:b,g=null,h=null;for(g in e)if(e.hasOwnProperty(g))if(h=e[g],e===b){if(h.iframe.contentWindow===c||h.iframe===c)return h}else if(h._internal.iframe.contentWindow===c||h._internal.iframe===c)return h;return d?void 0:f(c,!0)},g=function(c){var d=f(c);return d&&d.promise?(window.clearTimeout(d.timeout),d.state="hidden",a[d.name]=new SWAC.Component(d.name,d.iframe,d.type,d.settings,d.lastUrl),a[d.name].lastIsDirtyValue=!1,d.authentication&&a[d.name]._internal.beginHandshake(SWAC.Config.Container.Authentication.TlsHandler,SWAC.Config.TimeOuts.Authentication.Handshake).then(function(){},function(){var b=a[d.name];b&&b.beginRemove({reason:"auth-failed"})}),delete b[d.name],d.promise.fulfill(),SWAC.Container.onCreated.fire({name:d.name}),!0):!1},h=function(a,b){var c,d,e,f=t({name:a}),g=!0,h=!1,i=0;if(f){if(c=f.lastIsDirtyValue,f.lastIsDirtyValue=b,c===b)return;if(s(),n===!0&&(d=function(){return function(){o.reject("Aborted by the user"),window.clearTimeout(p),n=!1}},f.lastIsDirtyValue===!0&&c===!1&&m===!0&&f.beginCleanUpRequest().then(null,d()),f.lastIsDirtyValue===!1)){if(m===!1&&q!==f.name())return;for(i=0;i<l.length;i++)if(e=l[i].lastIsDirtyValue,e&&(m&&(g=!1),!m)){h=!0,q=l[i].name(),l[i].beginCleanUpRequest().then(null,d());break}if(m&&g||!m&&!h){for(i=0;i<l.length;i++)l[i].beginRemove();o.fulfill(),n=!1,window.clearTimeout(p)}}}},i=function(a){var b=t({name:a});if(b)return b.lastIsDirtyValue;throw new SWAC.Exception(1001)},j=function(a){var c=f(a);c&&(window.clearTimeout(c.timeout),c.state="removing",c.promise.reject("Component has been discarded"),SWAC.Container.onFailure.fire({name:c.name,details:{phase:"creation",proceed:"no"}}),delete b[c.name])},k=function(b){SWAC.Services._internal.removeServices(b),delete a[b],SWAC.Container.onRemoved.fire({name:b})},l=null,m=null,n=!1,o=new SWAC.Defer,p=null,q=null,r=function(a,b,c){var d,e=null,f=!0,g=null,h=null,i=!1,j=0;for(c=c||SWAC.Config.TimeOuts.CleanUp,b=null===b||void 0===b?!0:b,m=b,n=!0,e=null===a||void 0===a?t():t({name:a}),l=e,g=function(){for(j=0;j<e.length;j++)e[j].beginRemove();o.fulfill(),n=!1},p=window.setTimeout(function(){SWAC.Config.Container.Behaviors.CloseTimeoutConfirm?g():(o.reject("Time-out expired. (SWAC.Config.TimeOuts.CleanUp or direct user input)"),n=!1)},c),h=function(){return function(){o.reject("Aborted by the user"),window.clearTimeout(p),n=!1}},j=0;j<e.length;j++)if(d=e[j].lastIsDirtyValue,d&&(b&&(f=!1),e[j].beginCleanUpRequest().then(null,h()),!b)){q=e[j].name(),i=!0;break}return(b&&f||!b&&!i)&&(g(),window.clearTimeout(p)),o.promise},s=function(){var a=!1,b=t({dirty:!0});b.length>0&&(a=!0),c.set("Owner","isDirty",a,"boolean")},t=function(b){var c,d,e,f=[],g=0,h=[];if(b){if(b&&b.name)if("string"==typeof b.name){if(!b.type&&!b.dirty)return a[b.name];f.push(a[b.name])}else if("[object Array]"===Object.prototype.toString.call(b.name))for(d in b.name)for(c in a)a.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c].name()===b.name[d]&&f.push(a[c]);if(b&&b.type)if(b.name)for(g=f.length-1;g>=0;g--)f[g]&&f[g].type()!==b.type&&f.splice(g,1);else for(c in a)a.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c].type()===b.type&&f.push(a[c]);if(b&&b.dirty)if(b.name||b.type)for(g=f.length-1;g>=0;g--)f[g]&&i(f[g].name())!==b.dirty&&f.splice(g,1);else for(c in a)a.hasOwnProperty(c)&&a.hasOwnProperty(c)&&i(a[c].name())===b.dirty&&f.push(a[c]);return f}for(e in a)a.hasOwnProperty(e)&&h.push(a[e]);return h};return{beginCreate:e,beginClose:r,get:t,status:c.access(),onCreated:new SWAC.Eventing.Event("onCreated"),onReady:new SWAC.Eventing.Event("onReady"),onRemoved:new SWAC.Eventing.Event("onRemoved"),onFailure:new SWAC.Eventing.Event("onFailure"),_internal:{accept:g,discard:j,remove:k,identify:f,setComponentInternalStatus:h,getComponentInternalStatus:i}}}(),SWAC.Interfaces=function(a,b){var c={},d=a,e=b,f=function(){return d},g=function(a){return d.indexOf(a)>=0},h=function(a){var b=new SWAC.Defer;return c[a]?b.fulfill(c[a]):g(a)?e._internal.beginRequestInterface(a).then(function(c){b.fulfill(c),SWAC.Communication._internal.call(e.name(),"interfaceReady",[a])},function(a){b.reject(a)}):b.reject("Interface not found"),b.promise},i=function(a,b,c){var d=new SWAC.Defer;return SWAC.Communication._internal.beginCall(e.name(),SWAC.Config.TimeOuts.Proxy.Functions||5e3,"call",[a,b,c]).then(function(a){d.fulfill(a)},function(a){d.reject(a)}),d.promise},j=function(a,b,d){var e,f,g,h,j={},k=0;if(!c[a]){for(e in b)b.hasOwnProperty(e)&&(f=b[e].join(", "),g="return function ("+f+') { var myargs = Array.prototype.slice.call(arguments, 0); var args = ["'+e+'", myargs, "'+a+'" ]; return fn.apply( ctx, args ); };',j[e]=new Function("ctx","fn",g)(this,i));for(k=0;k<d.length;k++)h=d[k],j[h]=new SWAC.Eventing.Event(h);c[a]=j}},k=function(a,b,d){c[d]&&c[d][a].fire(b)};this.list=f,this.beginGet=h,this.has=g,this._internal={exposeInterface:j,fire:k}},SWAC.Services=function(){var a={},b=new SWAC.Eventing.Event("onServiceCreated"),c={},d=function(){return Object.keys(a)},e=function(b,c){return a[b]?!1:(a[b]=c,!0)},f=function(a){var b,c,d=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,e=/,/,f=/^\s*(_?)(\S+?)\1\s*$/,g=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,h=[],i=a.toString().replace(g,""),j=i.match(d),k=j[1].split(e),l=function(a,b,c){h.push(c)};for(b=0;b<k.length;b++)c=k[b],c.replace(f,l);return h},g=function(a,b,c){return function(d){SWAC.Communication._internal.fire(a,b,d,c)}},h=function(d,e){var h,i,j,k=null,l={},m=[],n=Object.keys(a);if(n.indexOf(d)>=0){h=a[d],i=!(h instanceof Function),i||(c[e]=c[e]||{},c[e][d]?h=c[e][d]:(h=new a[d](e),c[e][d]=h,b.fire({component:e,service:d})));for(j in h)h.hasOwnProperty(j)&&("function"==typeof h[j]?l[j]=f(h[j]):"object"==typeof h[j]&&h[j].subscribe&&1===h[j].subscribe.length&&(h[j].subscribe(g(e,j,d)),m.push(j)));k={name:d,api:l,events:m}}return k},i=function(a){var b,d=c[a],e=0;if(d)for(b=Object.keys(d),e=0;e<b.length;e++)delete c[a][b[e]]},j=function(b,d,e,f){var g=null,h=null;return c[b]&&c[b][d]?(g=c[b][d],h=g[e].apply(d,f)):a[d]&&(g=a[d],h=g[e].apply(d,f)),h};return{list:d,register:e,onServiceCreated:b,_internal:{beginRequestService:h,removeServices:i,callMethod:j}}}(),SWAC.Wire=function(a,b,c,d,e,f){var g=this,h=a,i=d,j=e,k=f||{},l=b,m=c,n="unwired",o=[],p=[],q=null,r=function(){var a=!0;return"unwired"!==n&&(a=x()),a=SWAC.Wiring._internal.remove(g)},s=function(){var a=null;try{a=i?i(p,j):p}catch(b){throw new SWAC.Wiring.CancelExecutionException(b)}"loose"===n?g.onValueChanged.fire(a):q&&q(a)},t=function(a){return function(b){p[a]=b}},u=function(){var a,b,c,d,e,f,i,j,u,v=0,y=function(a,b){return function(c){if(b)if(b.beginGet)b.beginGet().then(function(b){p[a]=b;try{s()}catch(c){}});else{p[a]=b.get();try{s()}catch(d){}}else{p[a]=c.data;try{s()}catch(d){}}}};try{var z=function(a){return function(b){t(a)(b),c()}};for(v=0;v<l.length;v++)d=l[v],d.component?(e=SWAC.Container.get({name:d.component}),d.event&&e.proxy[d.event]?(a=y(v),e.proxy[d.event].subscribe(a),o.push([e.proxy,d.event,a]),p.push(null)):d.dpc&&e.dpc&&(b=e.dpc.open(d.dpc),b&&(c=y(v,b),b.onValueChanged.subscribe(c),o.push([b,"onValueChanged",c]),p.push(null),b.beginGet().then(z(v))))):d.wire&&(f=SWAC.Wiring.get({name:d.wire}),i=y(v),f.onValueChanged.subscribe(i),o.push([f,"onValueChanged",i]),p.push(w(f)))}catch(A){return k.removeOnFailure?r():x(),!1}return m?(m.component&&m.method?(j=SWAC.Container.get({name:m.component}),q=function(a){a instanceof Array||(a=[a]),j.proxy[m.method].apply(j,a)}):m.component&&m.dpc&&(u=SWAC.Container.get({name:m.component}),q=u.dpc?function(a){u.dpc.open(m.dpc).set(a)}:null),n="wired",g.onWired.fire({name:h}),SWAC.Wiring._internal.toWired(g)):(n="loose",g.onWired.fire({name:h,loose:!0}),SWAC.Wiring._internal.toLoose(g)),!0},v=[],w=function(a){var b,c,d=null,e=function(){return function(a){d=a}},f=function(){return function(a){g.push(a)}},g=[],h=0;if(0===a.description.input.length||null===a.description.input||void 0===a.description.input)return null;if(a.description.converter){for(h=0;h<a.description.input.length;h++)if(a.description.input[h].wire){if(-1!==v.indexOf(a.description.input[h].wire))return null;v.push(a.description.input[h].wire),g.push(w(SWAC.Wiring.get({name:a.description.input[h].wire})))}else a.description.input[h].component&&a.description.input[h].dpc&&(b=SWAC.Container.get({name:a.description.input[h].component}),c=b.dpc.open(a.description.input[h].dpc),c&&c.beginGet().then(f()));d=a.description.converter(g,a.description.parameter)}else if(a.description.input[0].wire){if(-1!==v.indexOf(a.description.input[0].wire))return null;v.push(a.description.input[0].wire),d=w(SWAC.Wiring.get({name:a.description.input[0].wire}))}else a.description.input[0].component&&(b=SWAC.Container.get({name:a.description.input[0].component}),c=b.dpc.open(a.description.input[0].dpc),c&&c.beginGet().then(e()));return d},x=function(a){var b,c,d,e=0;for(a=a||!1,e=o.length-1;e>=0;e--){b=o[e][0],c=o[e][1],d=o[e][2];try{b[c].unsubscribe(d)}catch(f){return!1}}return p=[],q=null,a||(n="unwired",k.removeOnUnwired&&r(),g.onUnwired.fire({name:h}),SWAC.Wiring._internal.toUnwired(g)),!0};this.remove=r,this.wire=u,this.unwire=x,this.onWired=new SWAC.Eventing.Event("onWired"),this.onUnwired=new SWAC.Eventing.Event("onUnWired"),this.onValueChanged=new SWAC.Eventing.Event("onValueChanged"),this._internal={},this.description={input:l,output:m,name:h,state:n,converter:i,parameter:j}},SWAC.Wiring=function(){var a={},b={},c={},d=function(a){var b,d=!0,e=0;if(Array.isArray(a)){for(b=new Array(a.length),e=0;e<a.length;e++)b[e]=SWAC.Wiring.create(a[e]),d=d&&b[e];return d}return"object"==typeof a&&null!==a?void 0===a.input?!1:(c[a.name]=new SWAC.Wire(a.name,a.input,a.output,a.converter,a.parameter,a.options),SWAC.Wiring.onCreated.fire({name:a.name}),f(),!0):!1},e=function(a){var c,d,e,f,g,h,i,j=0;if(!a)return!1;if(c=a.description.input,d=a.description.output,!c)return!1;for(j=0;j<c.length;j++)if(e=c[j],e.component){if(f=SWAC.Container.get({name:e.component}),!f)return!1;if(e.event){if(!f.proxy[e.event])return!1}else{if(!e.dpc)return!1;if(!f.dpc)return!1;if(g=f.dpc.open(e.dpc),!g)return!1}}else{if(!e.wire)return!1;if(!b[e.wire])return!1}if(d&&d.component){if(h=SWAC.Container.get({name:d.component}),!h)return!1;if(d.method){if(!h.proxy[d.method])return!1}else{if(!d.dpc)return!1;if(!h.dpc)return!1;if(i=h.dpc.open(d.dpc),!i)return!1}}return!0},f=function(){var a="";for(a in c)if(c.hasOwnProperty(a)){var b=c[a];e(b)&&h(b)}},g=function(){var c,d,f,g,h=function(a){var b;return a?(b=e(a),b||i(a),b):!1};for(c in a)a.hasOwnProperty(c)&&(f=a[c],h(f));for(d in b)b.hasOwnProperty(d)&&(g=b[d],h(g))},h=function(a){a.wire()?SWAC.Wiring.onWired.fire({name:a.description.name}):SWAC.Wiring.onFailure.fire({message:"Wiring system detected a potential wire, but wiring failed."})},i=function(a){a?a.unwire()?SWAC.Wiring.onUnwired.fire({name:a.description.name}):SWAC.Wiring.onFailure.fire({message:"Wiring system detected a invalid wire, but unwiring failed."}):SWAC.Wiring.onFailure.fire({message:"Wiring system detected a null wire, unwiring failed."})},j=function(d){var e=[],f=null,g=null,h=null,i=null;if(d=d||{wired:!0,unwired:!0,loose:!0},d.name)return a[d.name]?a[d.name]:b[d.name]?b[d.name]:c[d.name];if(d.wired)for(var j in a)a.hasOwnProperty(j)&&e.push(a[j]);if(d.loose)for(var k in b)b.hasOwnProperty(k)&&e.push(b[k]);if(d.unwired)for(var l in c)c.hasOwnProperty(l)&&e.push(c[l]);if("[object Array]"===Object.prototype.toString.call(d.inputComponents)||"[object Array]"===Object.prototype.toString.call(d.outputComponents)){void 0!==d.wired&&null!==d.wired||void 0!==d.loose&&null!==d.loose||void 0!==d.unwired&&null!==d.unwired||(d.wired=d.loose=d.unwired=!0);for(f in d.inputComponents){if(d.wired)for(g in a)if(a[g].description.input)if("[object Array]"===Object.prototype.toString.call(a[g].description.input))for(h in a[g].description.input)a[g].description.input[h].component===d.inputComponents[f]&&-1===e.indexOf(a[g])&&e.push(a[g]);else a[g].description.input.component===d.inputComponents[f]&&-1===e.indexOf(a[g])&&e.push(a[g]);if(d.loose)for(g in b)if(b[g].description.input)if("[object Array]"===Object.prototype.toString.call(b[g].description.input))for(h in b[g].description.input)b[g].description.input[h].component===d.inputComponents[f]&&-1===e.indexOf(b[g])&&e.push(b[g]);else b[g].description.input.component===d.inputComponents[f]&&-1===e.indexOf(b[g])&&e.push(b[g]);if(d.unwired)for(g in c)if(c[g].description.input)if("[object Array]"===Object.prototype.toString.call(c[g].description.input))for(h in c[g].description.input)c[g].description.input[h].component===d.inputComponents[f]&&-1===e.indexOf(c[g])&&e.push(c[g]);else c[g].description.input.component===d.inputComponents[f]&&-1===e.indexOf(c[g])&&e.push(c[g])}for(i in d.outputComponents){if(d.wired)for(g in a)a[g].description.output&&a[g].description.output.component&&a[g].description.output.component===d.outputComponents[i]&&-1===e.indexOf(a[g])&&e.push(a[g]);if(d.loose)for(g in b)b[g].description.output&&b[g].description.output.component&&b[g].description.output.component===d.outputComponents[i]&&-1===e.indexOf(b[g])&&e.push(b[g]);if(d.unwired)for(g in c)c[g].description.output&&c[g].description.output.component&&c[g].description.output.component===d.outputComponents[i]&&-1===e.indexOf(c[g])&&e.push(c[g])}}return e},k=function(d){var e=d.description.name,f=!0,g=!1;return"unwired"!==d.description.state&&i(d),void 0!==a[e]&&(delete a[e],g=!0),void 0!==b[e]&&(delete b[e],g=!0),void 0!==c[e]&&(delete c[e],g=!0),g&&SWAC.Wiring.onRemoved.fire({name:e}),f=g},l=function(a){var b=SWAC.Container.get({name:a}),c=function(a){return a?function(){f()}:function(){g()}};b&&b.dpc&&(b.dpc.onAdded.subscribe(c(!0)),b.dpc.onRemoved.subscribe(c(!1)))},m=function(a){l(a.data.name),f()},n=function(){g()},o=function(b){var d=b.description.name;a[d]=c[d],delete c[d]},p=function(a){var d=a.description.name;b[d]=c[d],delete c[d],f()},q=function(d){var e=d.description.name;a[e]?(c[e]=a[e],delete a[e]):b[e]&&(c[e]=b[e],delete b[e]),g()};!function(){SWAC.Container.onReady.subscribe(m),SWAC.Container.onRemoved.subscribe(n)}();var r=function(a){SWAC.Exception.call(this,a)};return r.prototype=new SWAC.Exception,{create:d,get:j,onCreated:new SWAC.Eventing.Event("onCreated"),onWired:new SWAC.Eventing.Event("onWired"),onUnwired:new SWAC.Eventing.Event("onUnwired"),onRemoved:new SWAC.Eventing.Event("onRemoved"),onFailure:new SWAC.Eventing.Event("onFailure"),_internal:{remove:k,toWired:o,toUnwired:q,toLoose:p},CancelExecutionException:r}}();