/* Version 1.0.0, copyright (C) 2015, Siemens AG. All Rights Reserved. */
var SWAC=SWAC||{};SWAC.isContainer=!0,SWAC.Config=function(){return{LevelLog:0,TimeOuts:{Enabled:!0,Create:1e3,Remove:2e3,CleanUp:6e4,Internal:1e3,Proxy:{Functions:5e3,Events:1e3},Authentication:{Handshake:3e3}},Container:{URLs:{BaseLibrary:""},Authentication:{Request:!1,TlsHandler:null},Behaviors:{CloseTimeoutConfirm:!0}}}}(),SWAC.Exception=function(a){var b={1001:"Component not found.",1002:"Corresponding node does no longer exist",1003:"No compatible node for the given key.",1004:"No node for the given key.",1005:"Data node with different flags does already exist.",1006:"Unable to set value on a structural node.",1007:"Handshake cannot be restarted.",1008:"Authorization handshake not active.",1009:"Handshake no longer active.",2001:"Permission denied.",3001:"Flags cannot be both Proxy and Stub",3002:"Invalid Key, key not nullable.",3003:"Invalid Key, key must be a string.",3004:"Invalid Key. Not multiple key accepted.",3005:"Invalid Key. Key cannot start/end with dot.",3006:"Invalid Key, key cannot be an empty string.",3007:"Flags Invalid",4001:"Converter function exception"};if(isNaN(a))this.errorCode=-1,this.message=a;else{this.errorCode=a;var c=b[a];this.message="Internal Error",null!==c&&void 0!==c&&(this.message=c)}},SWAC.Exception.prototype=new Error,SWAC.Exception.prototype.constructor=SWAC.Exception,SWAC.Exception.prototype.toString=function(){return this.message},SWAC.AccessViolationException=function(a){SWAC.Exception.call(this,a)},SWAC.AccessViolationException.prototype=new SWAC.Exception,SWAC.InvalidArgumentException=function(a){SWAC.Exception.call(this,a)},SWAC.InvalidArgumentException.prototype=new SWAC.Exception,SWAC.InternalException=function(a){SWAC.Exception.call(this,a)},SWAC.InternalException.prototype=new SWAC.Exception,Object.keys||(Object.keys=function(){"use strict";var a=[],b=Object.prototype.hasOwnProperty,c=!{toString:null}.propertyIsEnumerable("toString"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],e=d.length;return function(f){var g,h;if("object"!=typeof f&&("function"!=typeof f||null===f))throw new TypeError("Object.keys called on non-object");for(g in f)b.call(f,g)&&a.push(g);if(c)for(h=0;e>h;h++)b.call(f,d[h])&&a.push(d[h]);return a}}()),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d,e,f,g;if(null==this)throw new TypeError(" this is null or not defined");if(e=Object(this),f=e.length>>>0,"function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=0;f>d;)d in e&&(g=e[d],a.call(c,g,d,e)),d++}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(){"use strict";var a=Object.prototype.hasOwnProperty;return function(b){var c=[];for(var d in b)a.call(b,d)&&c.push(d);return c}}()),SWAC.Guid=function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},b=function(){return(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase()};return{generate:b}}(),SWAC.Eventing=function(){var a=function(){this._listeners={}};a.prototype={constructor:a,addListener:function(a,b){"undefined"==typeof this._listeners[a]&&(this._listeners[a]=[]),this._listeners[a].push(b)},fire:function(a){var b,c=0,d=0;if("string"==typeof a&&(a={type:a}),a.target||(a.target=this),!a.type)throw new Error("Event object missing 'type' property.");if(this._listeners[a.type]instanceof Array)for(b=this._listeners[a.type],c=0,d=b.length;d>c;c++)b[c].call(this,a)},removeListener:function(a,b){var c,d=0,e=0;if(this._listeners[a]instanceof Array)for(c=this._listeners[a],d=0,e=c.length;e>d;d++)if(c[d]===b){c.splice(d,1);break}}};var b=function(b){var c=new a,d=b;return{fire:function(a){var b={type:d,data:a};c.fire(b)},subscribe:function(a){c.addListener(d,a)},unsubscribe:function(a){c.removeListener(d,a)}}};return{Event:b,EventEx:a}}(),SWAC.Defer=function(){this.promise=new SWAC.Promise},SWAC.Defer.prototype={fulfill:function(a){var b=this.promise;b.value=a,b.status="fulfilled",b.fulfilled.forEach(function(c){b.executeCallback(c.func,c.defer,a)})},reject:function(a){var b=this.promise;b.reason=a,b.status="rejected",b.rejected.forEach(function(c){b.executeCallback(c.func,c.defer,a)})},bind:function(){this.promise.then(function(a){this.fulfill(a)},function(a){this.reject(a)})}},SWAC.Promise=function(){this.fulfilled=[],this.rejected=[]},SWAC.Promise.prototype={status:"pending",reason:null,value:null,then:function(a,b){var c=new SWAC.Defer;return a&&this.fulfilled.push({func:a,defer:c}),b&&this.rejected.push({func:b,defer:c}),"fulfilled"===this.status?this.executeCallback(a,c,this.value,this.status):"rejected"===this.status&&this.executeCallback(b,c,this.reason,this.status),c.promise},executeCallback:function(a,b,c,d){"function"==typeof a&&setTimeout(function(){var e=a(c);e instanceof SWAC.Promise?b.bind(e):"fulfilled"===d?b.fulfill(e):b.reject(e)},0)}},SWAC.Reason=function(a){this.message=a},SWAC.Authentication=function(a){var b=this,c=SWAC.Guid.generate(),d=a,e="",f=null,g=null,h=function(){return null!==f&&"fulfilled"===f.promise.status?!0:!1},i=function(a,b,c){if(f)throw new SWAC.Exception(1007);return f=new SWAC.Defer,window.setTimeout(function(){f&&"pending"===f.promise.status&&f.reject("Handshake time-out expired. (SWAC.Config.TimeOuts.Authentication.Handshake)")},c||SWAC.Config.TimeOuts.Authentication.Handshake||3e3),g=a,b&&m(b),f.promise},j=function(){if(null===f||null===g)throw new SWAC.Exception(1008);if(f&&"pending"!==f.promise.status&&"fulfilled"!==f.promise.status)throw new SWAC.Exception(1009)},k=function(){j(),f.fulfill(),this.onSuccess.fire({})},l=function(a){j(),f.reject(a),this.onFailure.fire({})},m=function(a){j(),SWAC.Communication._internal.call(d,"tlsMessage",[a])},n=function(a){try{j(),g(a,b)}catch(c){}},o=function(){var a,b,c,f,g,h="";return null===d?h=e:(a=SWAC.Container.get({name:d}),a&&!a.promise&&(h=a._internal.getCurrentUrl())),""!==h&&null!==h&&void 0!==h&&(b=new RegExp(/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/),h=b.exec(h),c=h[1],"file"===c?h=h[10]:(f=h[6],g=h[7],h=""===g||null===g||void 0===g?f:f+":"+g)),h},p=function(a){e=a};this.accept=k,this.reject=l,this.sendMessage=m,this.isAuthenticated=h,this.getDomain=o,this.onFailure=new SWAC.Eventing.Event("onFailure"),this.onSuccess=new SWAC.Eventing.Event("onSuccess"),this._internal={receiveMessage:n,beginHandshake:i,setDomain:p},this.session=c},SWAC.Communication=function(){var a={},b=null,c=function(a){return a===window.parent?!1:!0},d=function(a){return"undefined"==typeof window.constructor?a instanceof window.constructor:a.window===a},e=function(a,b){return JSON.stringify({t:a,c:b})},f=function(a,b,c){var d,f,g,h,i,j;switch(b.message){case"ping":if(d=SWAC.Container._internal.identify(a),!d)break;f=SWAC.Config.Container.URLs.BaseLibrary,g="function"==typeof f?f(b.version):f,h=SWAC.Config.Container.Authentication.TlsHandler?SWAC.Config.Container.Authentication.Request?"req":"can":"no",d.lastUrl=c,"req"===b.authentication&&"no"===h||"string"!=typeof g?(a.postMessage(e("boot",{message:"peng",reason:"no"===h?"Authentication not supported":"No appropriate SWAC library"}),"*"),SWAC.Container._internal.discard(a)):(d.authentication="req"===b.authentication,a.postMessage(e("boot",{message:"pong",url:g,name:d.name,type:d.type,authentication:"req"===b.authentication?"can":h}),"*"));break;case"ok":SWAC.Container._internal.accept(a)?a.postMessage(e("boot",{message:"ok2",name:SWAC.Container._internal.identify(a).name()}),"*"):(i=SWAC.Container._internal.identify(a),j=i instanceof SWAC.Component?i._internal.iframe:i.iframe,SWAC.Container._internal.remove(SWAC.Container._internal.identify(a).name()),j.src="",j.parentNode.removeChild(j));break;case"failed":SWAC.Container._internal.discard(a);break;case"pong":break;case"ok2":}},g=function(a){var b=JSON.parse(a.data);if(b.t)switch(b.t){case"boot":f(a.source,b.c,a.origin);break;case"msg":l(a.source,b.c,a.origin)}},h=function(a){if(null===a||""===a||void 0===a)return window.parent;if(d(a))return a;if(SWAC.Container){var b=SWAC.Container.get({name:a});if(b instanceof SWAC.Component)return b._internal.iframe.contentWindow}return null},i=function(a,b,c){var d,f=h(a);f&&(d=e("msg",{t:"call",m:b,a:c}),f.postMessage(d,"*"))},j=function(a,b,c,d){return c?(a&&a.postMessage(e("msg",{t:"result",g:b,e:1}),"*"),void 0):("object"==typeof d&&"function"==typeof d.then?(a&&a.postMessage(e("msg",{t:"prolong",g:b}),"*"),d.then(function(c){a&&a.postMessage(e("msg",{t:"result",g:b,v:c,s:0,e:0}),"*")},function(c){a&&a.postMessage(e("msg",{t:"result",g:b,v:c,s:1,e:0}),"*")})):a&&a.postMessage(e("msg",{t:"result",g:b,v:d,e:0}),"*"),void 0)},k=function(b,c,d,f,g){var i,j,k,l=SWAC.Guid.generate(),m=new SWAC.Defer,n=h(b),o=0,p={};return g=g===!0,n?(i=function(){return o=setTimeout(function(){if(!p.handled&&!p.prolonged){switch(d){case"beginExpose":case"show":case"position":case"ready":case"bind":k="SWAC.Config.TimeOuts.Internal";break;case"callService":case"call":k="SWAC.Config.TimeOuts.Proxy.Functions";break;case"beginRequestService":case"beginRequestInterface":k="SWAC.Config.TimeOuts.Proxy.Internal";break;case"remove":k="SWAC.Config.TimeOuts.Remove";break;case"cleanUp":k="SWAC.Config.TimeOuts.CleanUp";break;default:k="unhandled time-out"}m.reject("Time-out expired. ("+k+")")}delete a[l]},c)},p={guid:l,promise:m,handled:!1,prolonged:!1,timer:i()},a[l]=p,j=e("msg",{t:g?"begin":"call",g:l,m:d,a:f}),n.postMessage(j,"*")):m.reject("Invalid target."),m.promise},l=function(d,e,f){var g=e.g,h=null,i=null,k=null,l=null,m=function(a){return function(b){"string"==typeof g&&j(d,g,a,b)}};switch(c(d)?(l=SWAC.Container._internal.identify(d),l&&!l.promise&&l._internal.setCurrentUrl(f)):b&&b._internal.setDomain(f),e.t){case"call":c(d)?(l=SWAC.Container._internal.identify(d),l&&l._internal[e.m]?(k=l._internal[e.m].apply(l,e.a),m(!1)(k)):m(!0)(null)):b&&b._internal[e.m]?(k=b._internal[e.m].apply(b,e.a),m(!1)(k)):m(!0)(null);break;case"begin":c(d)?(l=SWAC.Container._internal.identify(d),l&&l._internal[e.m]?l._internal[e.m].apply(l,e.a).then(m(!1),m(!0)):m(!0)(null)):b&&b._internal[e.m]?b._internal[e.m].apply(b,e.a).then(m(!1),m(!0)):m(!0)(null);break;case"prolong":h=a[g],h&&(h.prolonged=!0,window.clearTimeout(h.timer));break;case"result":i=a[g],i&&(i.handled=!0,window.clearTimeout(i.timer),e.e?i.promise.reject("Result message rejected"):e.s?i.promise.reject(e.v):i.promise.fulfill(e.v)),delete a[g]}},m=function(a,b,c,d){i(a,"fire",[b,c,d])},n=function(a,b,c,d){i(a,"dpcChanged",[b,c,d])},o=function(a,b){return k(a,SWAC.Config.TimeOuts.Internal||1e3,"dpcGet",[b])},p=function(a){b=a},q=function(){window.addEventListener?window.addEventListener("message",g,!1):window.attachEvent("onmessage",g)};return function(){q()}(),{_internal:{beginCall:k,call:i,fire:m,dpcChanged:n,beginDpcGet:o,associateHub:p,activate:q}}}(),SWAC.Hub=function(a){var b=this,c={},d=[],e=null,f=null,g=SWAC.Guid.generate(),h=a,i=[],j=[],k={},l=new SWAC.Authentication(null),m=function(a){var b=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,c=/,/,d=/^\s*(_?)(\S+?)\1\s*$/,e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,f=[],g=a.toString().replace(e,""),h=g.match(b),i=0,j=[],k=h[1].split(c),l=function(a,b,c){f.push(c)};for(i=0;i<k.length;i++)j=k[i],j.replace(d,l);return f},n=function(a,b){return function(c){b&&i.indexOf(b)<0||SWAC.Communication._internal.fire(null,a,c,b)}},o=function(){var a,b,c,d=h.dpc,g=0;if(e.root.add("private",SWAC.DPC.Permissions.Read),e.root.add("public",SWAC.DPC.Permissions.Read|SWAC.DPC.Permissions.Write|SWAC.DPC.Flags.Stub),this.DPC=f.open("public").access(),this.status=f.open("private").access(),d&&(a=d.structure))for(g=0;g<a.length;g++)b=a[g],c=SWAC.DPC.Permissions.Read|SWAC.DPC.Permissions.Write,b.flags&&-1===b.flags.toLowerCase().indexOf("rw")&&-1===b.flags.toLowerCase().indexOf("wr")&&(-1!==b.flags.toLowerCase().indexOf("r")&&(c=SWAC.DPC.Permissions.Read),-1!==b.flags.toLowerCase().indexOf("w")&&(c=SWAC.DPC.Permissions.Write)),void 0!==b.value?e.root.open("public").set(b.key,b.value,b.type,c):e.root.open("public").add(b.key,c);e.root.open("private").set("isDirty",!1,"boolean",SWAC.DPC.Permissions.Read|SWAC.DPC.Permissions.Write),e.root.onAdded.unsubscribe(e.addHandler),e.root.onRemoved.unsubscribe(e.remHandler),e.root.onValueChanged.unsubscribe(e.setHandler),d&&d.bind(e.root.open("public"))},p=function(){return function(a,b,c){("add"===b||"set"===b||"remove"===b)&&SWAC.Communication._internal.dpcChanged(null,a,b,c)}},q=function(a){return function(b){var c=p();"onAdded"===a?"node"===b.data.node?c(b.data.key,"add",{isEvent:!0,flags:b.data.flags}):c(b.data.key,"set",{isEvent:!0,flags:b.data.flags}):"onRemoved"===a&&c(b.data.key,"remove",{isEvent:!0})}},r=function(a){this.onVisible.fire({visible:a})},s=function(a){j=a,this.onReady.fire({})},t=function(a,b,c,d){this.onPosition.fire({left:a,top:b,width:c,height:d})},u=function(a){this.onRemove.fire({reason:a})},v=function(a,b,c){var d="string"==typeof c?h.interfaces[c]:h;return d[a].apply(d,b)},w=function(a,b,c){"remove"===b?e.root.remove(a):"add"===b?e.root.add(a,c.flags):"set"===b&&e.root.set(a,c.value,c.type,c.flags)},x=function(a){return e.root.get(a)},y=function(){var a,b={},i={},j={},k=new SWAC.Defer,l=SWAC.DPC.Flags.Stub|SWAC.DPC.Permissions.Read|SWAC.DPC.Permissions.Write,o=h.dpc?!0:!1,r=h.interfaces?Object.keys(h.interfaces):[];for(a in h)h.hasOwnProperty(a)&&("function"==typeof h[a]?c[a]=m(h[a]):"object"==typeof h[a]&&h[a].subscribe&&1===h[a].subscribe.length&&(h[a].subscribe(n(a)),d.push(a)));return f=new SWAC.DPC.Node(p(),g,l,null,!0),b=q("onRemoved"),i=q("onAdded"),j=q("onValueChanged"),e={},e.root=f.access(g),e.remHandler=b,e.root.onRemoved.subscribe(b),e.addHandler=i,e.root.onAdded.subscribe(i),e.setHandler=j,e.root.onValueChanged.subscribe(j),SWAC.Communication._internal.beginCall(null,SWAC.Config.TimeOuts.Internal||1e3,"beginExpose",[c,d,o,r],!0).then(function(a){k.fulfill(a)},function(a){SWAC.Communication._internal.associateHub(null),k.reject(a)}),k.promise},z=function(a){var b,c={},d=[],e={},f=h.interfaces?Object.keys(h.interfaces):[],g=null;if(f.indexOf(a)>=0){e=h.interfaces[a];for(b in e)e.hasOwnProperty(b)&&("function"==typeof e[b]?c[b]=m(e[b]):"object"==typeof e[b]&&e[b].subscribe&&1===e[b].subscribe.length&&(e[b].subscribe(n(b,a)),d.push(b)));g={name:a,api:c,events:d}}return g},A=function(a){return i.indexOf(a)<0?!1:!0},B=function(a){i.indexOf(a)<0&&(i.push(a),b.onInterfaceActivated.fire(a))},C=function(a){SWAC.Communication._internal.call(null,"close",[a])},D=function(a){l._internal.receiveMessage(a)},E=function(a,b,c){return l._internal.beginHandshake(a,b,c)};SWAC.Communication._internal.associateHub(this);var F=function(){var a=new SWAC.Defer;return this.onCleanUp.fire({defer:a}),a.promise},G=function(){return j},H=function(a){return j.indexOf(a)>=0},I=function(a,b,c){var d=new SWAC.Defer;return SWAC.Communication._internal.beginCall(null,SWAC.Config.TimeOuts.Proxy.Functions||5e3,"callService",[a,b,c]).then(function(a){d.fulfill(a)},function(a){d.reject(a)}),d.promise},J=function(a,b,c){var d,e,f,g,h={},i=0;if(!k[a]){for(d in b)b.hasOwnProperty(d)&&(e=b[d].join(", "),f="return function ("+e+') { var myargs = Array.prototype.slice.call(arguments, 0); var args = ["'+d+'", myargs, "'+a+'" ]; return fn.apply( ctx, args ); };',h[d]=new Function("ctx","fn",f)(this,I));for(i=0;i<c.length;i++)g=c[i],h[g]=new SWAC.Eventing.Event(g);k[a]=h}},K=function(a){var b=new SWAC.Defer,c={};return k[a]?b.fulfill(k[a]):H(a)?SWAC.Communication._internal.beginCall(null,SWAC.Config.TimeOuts.Proxy.Internal||1e3,"beginRequestService",[a]).then(function(d){c=d,c?(J(c.name,c.api,c.events),b.fulfill(k[a])):b.reject("Service not found")},function(a){b.reject(a)}):b.reject("Service not found"),b.promise},L=function(a,b,c){k[c]&&k[c][a]&&k[c][a].fire(b.data)},M=function(){return l.getDomain()},N=function(a){l._internal.setDomain(a)};this.beginExpose=y,this.beginAuthenticationHandshake=E,this.close=C,this.getDomain=M,this.isInterfaceActivated=A,this.onInterfaceActivated=new SWAC.Eventing.Event("onInterfaceActivated"),this.services={list:G,beginGet:K,has:H},this.onReady=new SWAC.Eventing.Event("onReady"),this.onRemove=new SWAC.Eventing.Event("onRemove"),this.onVisible=new SWAC.Eventing.Event("onVisible"),this.onPosition=new SWAC.Eventing.Event("onPosition"),this.onCleanUp=new SWAC.Eventing.Event("onCleanUp"),this._internal={bind:o,remove:u,ready:s,show:r,position:t,call:v,fire:L,dpcChanged:w,dpcGet:x,tlsMessage:D,cleanUp:F,beginRequestInterface:z,interfaceReady:B,setDomain:N}},SWAC.DPC=SWAC.DPC||{},SWAC.DPC.Data=function(a,b,c,d,e,f,g){var h=this,i=b,j=g||!1,k=function(a,b,c,d){if(b===!1&&(null===a||void 0===a))throw new SWAC.InvalidArgumentException(3002);if(null!==a&&void 0!==a){if("string"!=typeof a)throw new SWAC.InvalidArgumentException(3003);if(c===!1&&-1!==a.indexOf("."))throw new SWAC.InvalidArgumentException(3004);if(d===!1&&""===a.trim())throw new SWAC.InvalidArgumentException(3006)}};k(d,!1,!1,!1);var l,m=function(a){var b=SWAC.DPC.Flags.None;if("string"==typeof a||"boolean"==typeof a||"function"==typeof a||"object"==typeof a&&null!==a)throw new SWAC.InvalidArgumentException(3007);if(null===a||void 0===a)return a;if(0>a)throw new SWAC.InvalidArgumentException(3007);if((a&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub&&(b|=SWAC.DPC.Flags.Stub),(a&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy&&(b|=SWAC.DPC.Flags.Proxy),(a&SWAC.DPC.Permissions.Read)===SWAC.DPC.Permissions.Read&&(b|=SWAC.DPC.Permissions.Read),(a&SWAC.DPC.Permissions.Write)===SWAC.DPC.Permissions.Write&&(b|=SWAC.DPC.Permissions.Write),(b&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub&&(b&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy)throw new SWAC.InvalidArgumentException(3001);return b},n=m(c)||SWAC.DPC.Permissions.Read|SWAC.DPC.Permissions.Write,o=!1,p=d,q=e,r=f,s=(n&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy,t=(n&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub,u=function(a){return!A(a)&&(s||t)||j},v=function(a){if(A(a)||(y()&SWAC.DPC.Permissions.Read)===SWAC.DPC.Permissions.Read)return s&&u(a)?F(p,"get",{}):q;throw new SWAC.AccessViolationException(2001)},w=function(a,b){var c;if(!A(a)&&(y()&SWAC.DPC.Permissions.Write)!==SWAC.DPC.Permissions.Write)throw new SWAC.AccessViolationException(2001);s?C():(c=q,q=b,C(b,c)),u(a)&&F(p,"set",{value:s?b:null})},x=function(){return r},y=function(){return n},z=function(a){return void 0!==a&&(o=!0),o},A=function(a){return i===a?!0:!1},B=new SWAC.Eventing.Event("onValueChanged"),C=function(a,b){B.fire({key:p,value:a,oldValue:b}),l&&l.fireOnValueChanged&&l.fireOnValueChanged(p,a,b)},D=new SWAC.Eventing.Event("onRemoved"),E=function(){D.fire({key:p}),l&&l.fireOnRemoved&&l.fireOnRemoved(p)},F=function(a,b,c){return l&&l.forward?l.forward(a,b,c):void 0};if(this.get=v,this.set=w,this.type=x,this.flags=y,this.dirty=z,this.mine=A,this.onRemoved=D,this.fireOnRemoved=E,this.access=function(a){var b=function(){if(z())throw new SWAC.Exception(1002)},c={type:function(){return b(),x()},flags:function(){return b(),y()},onRemoved:D,forceForward:j};if(A(a)||(y()&SWAC.DPC.Permissions.Read)===SWAC.DPC.Permissions.Read){var d=function(){return b(),v(a)};s&&u(a)?c.beginGet=d:c.get=d,c.onValueChanged=B}return(A(a)||(y()&SWAC.DPC.Permissions.Write)===SWAC.DPC.Permissions.Write)&&(c.set=function(c){return b(),w(a,c)}),c},a instanceof SWAC.DPC.Node){if(!a.mine(b)&&(a.flags&SWAC.DPC.Flags.Stub)!==SWAC.DPC.Flags.Stub)throw new SWAC.AccessViolationException(2001);l=a,a.add(b,d,c,h,e)}else l=void 0},SWAC.DPC.Flags={None:0,Proxy:128,Stub:256},SWAC.DPC.Node=function(a,b,c,d,e){var f=function(a,b,c,d){if(b===!1&&(null===a||void 0===a))throw new SWAC.InvalidArgumentException(3002);if(null!==a&&void 0!==a){if("string"!=typeof a)throw new SWAC.InvalidArgumentException(3003);if(c===!1&&-1!==a.indexOf("."))throw new SWAC.InvalidArgumentException(3004);if(0===a.indexOf(".")||a.length>0&&a.lastIndexOf(".")===a.length-1)throw new SWAC.InvalidArgumentException(3005);if(d===!1&&""===a.trim())throw new SWAC.InvalidArgumentException(3006)}};f(d,!0,!1,!1);var g,h=this,i=e||!1,j=d,k=function(a){var b=SWAC.DPC.Flags.None;if("string"==typeof a||"boolean"==typeof a||"function"==typeof a||"object"==typeof a&&null!==a)throw new SWAC.InvalidArgumentException(3007);if(null===a||void 0===a)return a;if(0>a)throw new SWAC.InvalidArgumentException(3007);if((a&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub&&(b|=SWAC.DPC.Flags.Stub),(a&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy&&(b|=SWAC.DPC.Flags.Proxy),(a&SWAC.DPC.Permissions.Read)===SWAC.DPC.Permissions.Read&&(b|=SWAC.DPC.Permissions.Read),(a&SWAC.DPC.Permissions.Write)===SWAC.DPC.Permissions.Write&&(b|=SWAC.DPC.Permissions.Write),(b&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub&&(b&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy)throw new SWAC.InvalidArgumentException(3001);return b},l="function"==typeof a?a:void 0,m=b,n=k(c)||SWAC.DPC.Permissions.Read|SWAC.DPC.Permissions.Write,o=!1,p={},q=function(a){return void 0!==a&&(o=!0),o},r=(n&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy,s=(n&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub,t=function(a){return m===a?!0:!1},u=function(a){return t(a)||(n&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub},v=u,w=function(a){return!t(a)&&(r||s)||i},x=function(){return Object.getOwnPropertyNames(p).sort()},y=function(a,b){var c,d,e=1;if(f(b,!1,!0,!0),!t(a)&&(E()&SWAC.DPC.Permissions.Read)!==SWAC.DPC.Permissions.Read)throw new SWAC.AccessViolationException(2001);if(""===b||null===b)return void 0;if(b.indexOf(".")>-1){if(c=b.split("."),d=C(c[0]),void 0===d)return void 0;for(e=1;e<c.length-1;e++){if(void 0===d)return void 0;d=d.open(c[e])}return void 0===d?void 0:d.get(a,c[c.length-1])}if(void 0!==p[b]&&p[b]instanceof SWAC.DPC.Data&&p[b].get)return p[b].get(a);if(void 0!==p[b])throw new SWAC.Exception(1003);if(window.addEventListener)throw new SWAC.Exception(1004)},z=function(a){return a=a||n,(n&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub?((a&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy&&(a^=SWAC.DPC.Flags.Proxy),a|=SWAC.DPC.Flags.Stub):(n&SWAC.DPC.Flags.Proxy)===SWAC.DPC.Flags.Proxy&&((a&SWAC.DPC.Flags.Stub)===SWAC.DPC.Flags.Stub&&(a^=SWAC.DPC.Flags.Stub),a|=SWAC.DPC.Flags.Proxy),a},A=function(a,b,c,d,e){var g,j=h,k=0;if(f(b,!1,!0,!1),t(a)||(E()&SWAC.DPC.Permissions.Write)===SWAC.DPC.Permissions.Write){if(e=z(e),b.indexOf(".")>-1){for(g=b.split("."),k=0;k<g.length-1;k++)j=j.list().indexOf(g[k])>=0?j.open(g[k]):j.add(a,g[k],e);return j.set(a,g[g.length-1],c,d,e)}if(void 0===p[b])w(a)&&M(b,"set",{value:c,type:d,flags:e}),p[b]=new SWAC.DPC.Data(h,m,e,b,c,d,i);else{if(!(p[b]instanceof SWAC.DPC.Data))throw new SWAC.Exception(1006);p[b].set(a,c)}return p[b]}throw new SWAC.AccessViolationException(2001)},B=function(a,b,c,d,e){var g,j,k=1;if(f(b,!1,!0,!1),!u(a))throw new SWAC.AccessViolationException(2001);if(c=z(c),b.indexOf(".")>-1){for(g=b.split("."),j=B(a,g[0],c),k=1;k<g.length;k++)j=j.add(a,g[k],c);return j}return void 0===p[b]&&(w(a)&&M(b,"add",{flags:c}),null===d||void 0===d?p[b]=new SWAC.DPC.Node(h,m,c,b,i):(p[b]=d,d instanceof SWAC.DPC.Node?L(b,"node",null,c):L(b,"data",e,c))),p[b]},C=function(a){var b,c,d=1;if(f(a,!1,!0,!1),""===a||null===a)return h;if(a.indexOf(".")>-1){if(b=a.split("."),c=C(b[0]),void 0===c)return void 0;for(d=1;d<b.length;d++){if(void 0===c)return void 0;c=c.open(b[d])}return c}return void 0!==p[a]&&(p[a]instanceof SWAC.DPC.Node||p[a]instanceof SWAC.DPC.Data)?p[a]:void 0},D=function(a,b){var c,d,e,g,h,i=1;if(f(b,!1,!0,!1),!v(a))throw new SWAC.AccessViolationException(2001);if(b.indexOf(".")>-1){for(c=b.split("."),d=C(c[0]),i=1;i<c.length-1;i++){if(void 0===d)return!1;d=d.open(c[i])}return void 0===d?!1:d.remove(a,c[c.length-1])}if(void 0!==p[b]){if(p[b]instanceof SWAC.DPC.Node)for(g=p[b].list(),h=g.length-1;h>-1;h--)p[b].remove(a,g[h]);return e=p[b],e.dirty(!0),w(a)&&M(b,"remove",{}),p[b]=null,delete p[b],e instanceof SWAC.DPC.Data&&e.fireOnRemoved(),!0}return!1},E=function(){return n},F=function(a){var b=a;return j&&g&&(b=j+"."+b),b},G=new SWAC.Eventing.Event("onValueChanged"),H=function(a,b,c){var d=F(a);(-1!==d.indexOf("public.")||-1!==d.indexOf("private."))&&(d=d.substr(d.indexOf(".")+1)),G.fire({key:d,value:b,oldValue:c}),g&&g.fireOnValueChanged&&g.fireOnValueChanged(d,b,c)},I=new SWAC.Eventing.Event("onRemoved"),J=function(a){var b=F(a);(-1!==b.indexOf("public.")||-1!==b.indexOf("private."))&&(b=b.substr(b.indexOf(".")+1)),I.fire({key:b}),g&&g.fireOnRemoved&&g.fireOnRemoved(b)},K=new SWAC.Eventing.Event("onAdded"),L=function(a,b,c,d){var e=F(a);(-1!==e.indexOf("public.")||-1!==e.indexOf("private."))&&(e=e.substr(e.indexOf(".")+1)),K.fire("node"===b?{key:e,node:b,flags:d}:{key:e,node:b,value:c,flags:d}),g&&g.fireOnAdded&&g.fireOnAdded(e,b,c,d)},M=function(a,b,c){var d=F(a);return l&&"function"==typeof l?l(d,b,c):g&&g.forward?g.forward(d,b,c):void 0};if(this.get=y,this.set=A,this.open=C,this.add=B,this.remove=D,this.list=x,this.flags=E,this.dirty=q,this.mine=t,this.fireOnAdded=L,this.fireOnRemoved=J,this.fireOnValueChanged=H,this.forward=M,this.access=function(a){var b=function(){if(q())throw new SWAC.Exception(1002)},c={list:function(){return b(),x()},open:function(c){var d={};return b(),d=C(c),d instanceof SWAC.DPC.Node||d instanceof SWAC.DPC.Data?d.access(a):void 0},flags:function(){return b(),E()},onRemoved:I,onAdded:K,forceForward:i};if(t(a)||(E()&SWAC.DPC.Permissions.Read)===SWAC.DPC.Permissions.Read){var d=function(c){return b(),y(a,c)};r&&w(a)?c.beginGet=d:c.get=d,c.onValueChanged=G}return(t(a)||(E()&SWAC.DPC.Permissions.Write)===SWAC.DPC.Permissions.Write)&&(c.set=function(c,d,e,f){var g={};return b(),g=A(a,c,d,e,f),g instanceof SWAC.DPC.Data?g.access(a):void 0}),u(a)&&(c.remove=function(c){return b(),D(a,c)},c.add=function(c,d){var e={};return b(),e=B(a,c,d),e instanceof SWAC.DPC.Node?e.access(a):void 0}),c},a instanceof SWAC.DPC.Node){if(!a.mine(b)&&(a.flags&SWAC.DPC.Flags.Stub)!==SWAC.DPC.Flags.Stub)throw new SWAC.AccessViolationException(2001);g=a,a.add(b,d,c,h)}else g=void 0},SWAC.DPC.Permissions={None:0,Read:1,Write:2};