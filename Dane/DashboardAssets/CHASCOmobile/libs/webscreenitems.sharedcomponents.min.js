/* SCADA Innovation/WebUX 7.700.106.1 File version: 7.700.106.1  Copyright (C) Siemens AG 2018. All Rights Reserved. */
var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.ColumnHeader=function(a){"use strict";var b=null,c=null,d=null,e=12,f=.5,g=[],h=function(){b||(b=a.utils.createSVG("g",null,null,null),a.utils.setSVGAttribute(b,"clip-path","url(#"+a.clipPath.id+")"),a.parentGroup.appendChild(b))},i=function(){var d=a.utils.getTitleFontPropeties(a.model);c?a.utils.setSVGStyles(c,d):(c=a.utils.createSVG("g",{id:a.id+"_HeaderGroup"},null,d),b.appendChild(c))},j=function(){var c={vLines:null,hLines:null,offsetVLines:null,dShadowLines:null,lShadowLines:null},d={stroke:a.model.titleGridLineColor,strokeWidth:a.model.gridLineWidth,"pointer-events":"none"},f={stroke:a.model.titleDarkShadowColor,strokeWidth:a.tableProps.shadowLineWidth,"pointer-events":"none"},g={stroke:a.model.titleLightShadowColor,strokeWidth:a.tableProps.shadowLineWidth,"pointer-events":"none"},h={stroke:"transparent",strokeWidth:e};return a.model.gridLineWidth>h.strokeWidth&&(h.strokeWidth=a.model.gridLineWidth),c.vLines=a.utils.createSVG("g",{id:a.id+"_VLinesHeaderGroup"},null,d),b.appendChild(c.vLines),c.offsetVLines=a.utils.createSVG("g",{id:a.id+"_OffSetVLinesHeaderGroup"},null,h),b.appendChild(c.offsetVLines),c.hLines=a.utils.createSVG("g",{id:a.id+"_HLinesHeaderGroup"},null,d),b.appendChild(c.hLines),a.model.title3D&&(c.dShadowLines=a.utils.createSVG("g",{id:a.id+"_DarkShadowHeaderGroup"},null,f),b.appendChild(c.dShadowLines),c.lShadowLines=a.utils.createSVG("g",{id:a.id+"_LightShadowHeaderGroup"},null,g),b.appendChild(c.lShadowLines)),c},k=function(b){var c={x1:0,y1:a.tableProps.y,x2:0,y2:a.tableProps.y},d=a.tableProps.width-a.getRowHeaderWidth(),e=a.getTotalColumnWidth();b.hLines&&((a.model.autoCompleteColumns||e>d)&&(e=d),c.x1=a.tableProps.x+a.getRowHeaderWidth(),c.x2=c.x1+e,c.y1+=a.getHeaderHeight()-a.model.gridLineWidth/2,c.y2=c.y1,b.hLines.appendChild(a.utils.createSVG("line",c)))},l=function(b){var c={x1:0,y1:0,x2:0,y2:0},d=a.getHeaderHeight(),e=a.columns.length,f=a.tableProps.defaultCursorStyle;if(b.vLines)for(var g=0;e>g;g++)"autocomplete"!==a.columns[g].columnDataType&&(c.x1=a.columns[g].x+a.columns[g].width-a.model.gridLineWidth/2,c.x2=c.x1,c.y1=a.tableProps.y,c.y2=a.tableProps.y+d,a.appMode===PWC.Components.AppMode.RUNTIME&&a.model.enabled&&(f=a.model.columnResize?"e-resize":"cell"),b.vLines.appendChild(a.utils.createSVG("line",c,null)),b.offsetVLines&&b.offsetVLines.appendChild(a.utils.createSVG("line",c,null,{cursor:f})))},m=function(b){var c={mx:0,my:0,lx1:0,ly1:0,lx2:0,ly2:0},d=null,e=null,g=a.getHeaderHeight(),h=a.columns.length;if(a.model.title3D&&b.dShadowLines&&b.lShadowLines)for(var i=0;h>i;i++)c.mx=a.columns[i].x,c.my=a.tableProps.y+g-a.model.gridLineWidth-f,c.lx1=c.mx+a.columns[i].width-f,"autocomplete"!==a.columns[i].columnDataType&&(c.lx1-=a.model.gridLineWidth),c.ly1=c.my,c.lx2=c.lx1,c.ly2=a.tableProps.y+f,d="M"+c.mx+" "+c.my+" L"+c.lx1+" "+c.ly1+" L"+c.lx2+" "+c.ly2,e=a.utils.createSVG("path",{d:d,fill:"none"}),b.dShadowLines.appendChild(e),c.mx=c.lx2,c.my=c.ly2,c.lx1=a.columns[i].x+f,c.ly1=c.my,c.lx2=c.lx1,c.ly2=a.tableProps.y+g-a.model.gridLineWidth-f,d="M"+c.mx+" "+c.my+" L"+c.lx1+" "+c.ly1+" L"+c.lx2+" "+c.ly2,e=a.utils.createSVG("path",{d:d,fill:"none"}),b.lShadowLines.appendChild(e)},n=function(){b&&(c=null,a.utils.clearElement(b)),p(),u()},o=function(b,c){var d={path:null,child:null};d.path=a.utils.createSVG("clipPath",{id:c}),a.svgDef.appendChild(d.path),d.child=a.utils.createSVG("rect",{x:b.x,y:a.tableProps.y,width:b.width,height:a.tableProps.height}),d.path.appendChild(d.child),g.push(d)},p=function(){var b=0;for(b;b<g.length;b++)null!==g[b].path&&g[b].path.parentNode===a.svgDef&&a.svgDef.removeChild(g[b].path);g.length=0},q=function(b){var d,e=a.model.gridColumns,f=0,g=a.utils.getCellConfig(),h=a.utils.getCellConfig(),n=0,p=a.tableProps.x,q=0,s=0,t=0,u=null;for(a.model.columnTitles&&(i(),u=j()),g.height=h.height=a.tableProps.cellHeight,g.y=h.y=a.tableProps.y,g.fill=a.model.titleColor,g.forecolor=a.model.titleForeColor,g.dx=h.dx=0,g.dy=h.dy=a.getTextOffsetdy(PWC.Components.Grid.CellType.ColumnHeader),g.alignment=a.model.columnTitleAlignment,g.imageSize=a.getImageSize(),g.contentHeight=a.tableProps.contentHeight,h.contentHeight=a.tableProps.contentHeight,n=a.getRowHeaderWidth(),null!==b&&(f=b),f;f<e.length;f++)h.actualColumnIndex=f,g.id=h.id=a.id+"_column"+f,t=e[f].width+a.model.gridLineWidth,s=p+n,s<a.tableProps.x+a.tableProps.width&&(g.width=h.width=t,g.x=h.x=s,h.alignment=e[f].alignment,h.showIcon=e[f].showIcon,h.showText=e[f].showText,h.sortOrder=e[f].sortOrder,h.sortIndex=e[f].sortIndex,h.useColoumnBackgroundColor=e[f].useColoumnBackgroundColor,h.useColumnForeColor=e[f].useColumnForeColor,h.flashing=e[f].flashing,h.flashingType=e[f].flashingType,a.model.columnTitleAlignment===PWC.Components.Grid.HorizantalAlignment.JustifiedToContent&&(g.alignment=h.alignment),a.setContentAlignment(g,g.alignment),a.setContentAlignment(h,e[f].alignment),g.textContent=null,g.imageUrl=null,g.imageOffset=0,g.textOffset=0,g.fillOpacity=1,g.imageFilter="none",o(g,h.id),c&&a.model.columnTitles&&(d=a.createEmptyCell(g,"header-cell"),g.textContent=a.shortenTextContent(e[f].displayName,g.width,g.alignment,a.model.shortenTitleContent,null,PWC.Components.Grid.CellType.ColumnHeader),e[f].showTitleText&&a.utils.renderText(d,g,a.model.gridLineWidth,a.tableProps.contentHeight),c.appendChild(d),d=null),h.textContent=e[f].displayName,r(h,e[f].columnDataType)),p=s,n=t;q=a.getTotalColumnWidth(),a.model.autoCompleteColumns&&q<a.tableProps.width-a.getRowHeaderWidth()&&(g.width=a.tableProps.width-a.getRowHeaderWidth()-q,g.height=a.getHeaderHeight(),g.x=p+n,g.textContent=null,g.actualColumnIndex=null,c&&a.model.columnTitles&&(d=a.createEmptyCell(g,"header-cell"),c.appendChild(d),d=null),r(g,"autocomplete")),a.model.columnTitles&&(l(u),k(u),m(u))},r=function(b,c){a.columns.push({x:b.x,width:b.width,dx:b.dx,textAnchor:b.textAnchor,columnName:b.textContent,columnDataType:c,showIcon:b.showIcon,showText:b.showText,alignment:b.alignment,sortOrder:b.sortOrder,sortIndex:b.sortIndex,id:b.id,useColoumnBackgroundColor:b.useColoumnBackgroundColor,useColumnForeColor:b.useColumnForeColor,actualColumnIndex:b.actualColumnIndex,flashing:b.flashing,flashingType:b.flashingType})},s=function(){d||(d=a.utils.createSVG("g",null),a.utils.setSVGAttribute(d,"clip-path","url(#"+a.clipPath.id+")"),a.parentGroup.appendChild(d))},t=function(b){var c=null,f={x1:0,y1:0,x2:0,y2:0,opacity:.4},g=a.tableProps.height;f.x1=a.columns[b].x+a.columns[b].width-a.model.gridLineWidth/2,f.x2=f.x1,f.y1=a.tableProps.y,f.y2=a.tableProps.y+g,c=a.utils.createSVG("line",f,null,{stroke:"#8B668B","stroke-width":e,"pointer-events":"none"}),d.appendChild(c)},u=function(){for(;d.firstChild;)d.removeChild(d.firstChild)},v=function(a){var b=null;return c&&(b=c.childNodes[a]),b},w=function(){b=null,c=null,d=null,g.length=0};return{init:h,clearGroup:n,createColumns:q,getChild:v,displayResizeLine:t,clearResizeLine:u,createHighlightGroup:s,clearData:w}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.DataRow=function(a){"use strict";var b=null,c=null,d={},e=null,f=null,g=12,h=function(){i(),j(),k(),l()},i=function(){b||(b=a.utils.createSVG("g",null,null,null),a.utils.setSVGAttribute(b,"clip-path","url(#"+a.clipPath.id+")"),a.parentGroup.appendChild(b))},j=function(){var d=a.utils.getTableFontPropeties(a.model),e={id:a.id+"_DataGroup"};c?a.utils.setSVGStyles(c,d):(c=a.utils.createSVG("g",e,null,d),b.appendChild(c))},k=function(){var c={stroke:a.model.tableGridLineColor,strokeWidth:a.model.gridLineWidth,pointerEvents:"none"},e={stroke:"transparent",strokeWidth:g};d.vLines||(d.vLines=a.utils.createSVG("g",{id:a.id+"_VLinesDataGroup"}),b.appendChild(d.vLines)),d.hLines||(d.hLines=a.utils.createSVG("g",{id:a.id+"_HLinesDataGroup"}),b.appendChild(d.hLines)),a.model.gridLineWidth>e.strokeWidth&&(e.strokeWidth=a.model.gridLineWidth),a.model.columnTitles||d.offsetVLines||(d.offsetVLines=a.utils.createSVG("g",{id:a.id+"_OffSetVLinesDataGroup"}),b.appendChild(d.offsetVLines)),a.utils.setSVGStyles(d.vLines,c),a.utils.setSVGStyles(d.hLines,c),d.offsetVLines&&a.utils.setSVGStyles(d.offsetVLines,e)},l=function(){var c={id:a.id+"_DataCloneSourceGroup"},d={display:"none"};e||(e=a.utils.createSVG("g",c,null,d),b.appendChild(e))},m=function(){if(a.model.verticalGridLines){var b,e={x1:0,y1:a.tableProps.y,x2:0,y2:a.tableProps.y},f=a.columns.length,g=c.childNodes.length,h=d.vLines.childNodes.length,i=null,j=a.tableProps.defaultCursorStyle;for(e.y1+=a.getHeaderHeight(),e.y2=e.y1,d.offsetVLines&&(i=d.offsetVLines.childNodes.length),e.y2+=a.model.autoCompleteRows?a.dataMapper.getViewPortSize()*a.tableProps.cellHeight:g*a.tableProps.cellHeight,b=0;f>b;b++)"autocomplete"!==a.columns[b].columnDataType&&(e.x1=a.columns[b].x+a.columns[b].width-a.model.gridLineWidth/2,e.x2=e.x1,h>b?a.utils.setSVGAttribute(d.vLines.childNodes[b],"y2",e.y2):d.vLines.appendChild(a.utils.createSVG("line",e)),!a.model.columnTitles&&d.offsetVLines&&(a.appMode===PWC.Components.AppMode.RUNTIME&&a.model.enabled&&(j=a.model.columnResize?"e-resize":"cell"),i>b?a.utils.setSVGAttribute(d.offsetVLines.childNodes[b],"y2",e.y2):d.offsetVLines.appendChild(a.utils.createSVG("line",e,null,{cursor:j}))))}},n=function(b){if(a.model.horizontalGridLines){var c={x1:0,y1:0,x2:0,y2:0},e=a.tableProps.width-a.getRowHeaderWidth(),f=0;a.model.autoCompleteColumns||(f=a.getTotalColumnWidth()),(a.model.autoCompleteColumns||f>e)&&(f=e),c.x1=a.tableProps.x+a.getRowHeaderWidth(),c.x2=c.x1+f,c.y1=a.tableProps.y+a.getHeaderHeight()+(b+1)*a.tableProps.cellHeight-a.model.gridLineWidth/2,c.y2=c.y1,d.hLines.appendChild(a.utils.createSVG("line",c))}},o=function(){c&&a.utils.clearElement(c),d.vLines&&a.utils.clearElement(d.vLines),d.hLines&&a.utils.clearElement(d.hLines),d.offsetVLines&&a.utils.clearElement(d.offsetVLines),y()},p=function(a){a<d.hLines.childNodes.length&&d.hLines.removeChild(d.hLines.childNodes[a])},q=function(){var b=null;return f||(f=r(),e.appendChild(f)),b=a.utils.createSVG("g",{},f)},r=function(){var b=0,c={},d=null,e=a.utils.createSVG("g",{"class":"row-group"},null,{textDecoration:"inherit"});for(b;b<a.columns.length;b++)c.width=a.columns[b].width,c.height=a.tableProps.cellHeight,c.x=a.columns[b].x,c.y=a.tableProps.y,c.fill=a.model.tableColor,d=a.createEmptyCell(c,"row-cell"),e.appendChild(d),d=null;return e},s=function(b,c,d,e){var f=0,g=0,h=null,i=null,j=null,k=a.utils.getCellConfig();if(null!==b&&null!==c)for(k.fill=a.model.tableColor,k.forecolor=a.model.tableForeColor,k.dy=a.getTextOffsetdy(PWC.Components.Grid.CellType.DataRow),k.imageSize=a.getImageSize(),k.contentHeight=a.tableProps.contentHeight,g=a.tableProps.y+a.getHeaderHeight()+c*a.tableProps.cellHeight,f;f<b.childNodes.length;f++)j=a.columns[f],k.width=j.width,k.height=a.tableProps.cellHeight,k.x=j.x,k.y=g,k.dx=j.dx,k.textAnchor=j.textAnchor,k.alignment=j.alignment,k.textContent=null,k.imageUrl=null,k.imageOffset=0,k.textOffset=0,k.fillOpacity=1,k.imageFilter="none",k.id=j.id,k.fontStrikeOut="inherit",void 0===d||null===d||"autocomplete"===j.columnDataType?a.setCellStyleOverrideEnabled(k,c,f,null,null):(h=f,i=a.getCellData(d,a.columns[f].actualColumnIndex),null===i.value||void 0===i.value?(k.textContent=null,k.imageUrl=null):("string"!=typeof i.value&&(i.value=String(i.value)),a.applyShortenContent(PWC.Components.Grid.CellType.DataRow,k,i.value,a.columns[f].actualColumnIndex)),a.setCellStyleOverrideEnabled(k,c,f,i.style,e)),a.modifyCell(b.childNodes[f],k,j.showText,j.showIcon)},t=function(b){var d=0,e=0,f=a.dataMapper.getDataIndex(b),g=null,h=null,i=a.model.tableColor;if(null!==b&&c.childNodes[b])for(g=c.childNodes[b],a.isAlternateRowColor(f)&&(i=a.model.tableColor2),d;d<g.childNodes.length;d++)for(h=g.childNodes[d],e=h.childNodes.length-1;e>=0;e--)"rect"===h.childNodes[e].tagName?a.utils.setSVGAttribute(h.childNodes[e],"fill",i):h.removeChild(h.childNodes[e])},u=function(){var a=0;return c&&(a=c.childNodes.length),a},v=function(a){return c.childNodes[a]},w=function(a){c.appendChild(a)},x=function(a){null!==a&&c.childNodes[a]&&(c.removeChild(c.childNodes[a]),p(a))},y=function(){e&&a.utils.clearElement(e),f=null},z=function(){b=null,c=null,d.vLines=null,d.hLines=null,d.offsetVLines=null,f=null,e=null};return{init:h,createVLines:m,createHLine:n,deleteHLine:p,getChildCount:u,getChild:v,append:w,deleteRow:x,getEmptyRow:q,modifyRow:s,clearRow:t,clearGroup:o,clearData:z}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.EditHandler=function(a,b,c){"use strict";var d=b,e={rowIndex:null,columnIndex:null,editElementType:null},f=a.id+"_editBox",g=null,h=function(b,h){var k=a.iGridRef.onCellEditBegin(b,a.columns[h].actualColumnIndex),l=null,m="",n=a.dataMapper.getRowIndex(b),o=c(PWC.Components.Grid.GetInstance.Scroll),p=null;k.authorize&&d&&a.columns[h].showText&&(g||(g=document.createElement("div"),g.setAttribute("id",f),g.style.position="absolute"),g.style.width=a.getCellWidth(h,o)+"px",g.style.height=a.tableProps.contentHeight+"px",g.style.boxSizing="border-box",g.style.border="none",g.style.left=a.columns[h].x+"px",g.style.top=a.tableProps.y+a.getHeaderHeight()+n*a.tableProps.cellHeight+"px",0===g.childNodes.length?k.editElementType===PWC.Components.Grid.EditElementType.Custom?g.appendChild(k.customDom):(p=document.createElement("input"),p.setAttribute("id",f+"_input"),p.style.outline="none",p.style.border="none",p.style.width="100%",p.style.height="90%",p.style.verticalAlign="top",p.addEventListener("blur",j),p.addEventListener("keypress",i),p.style.fontSize=a.model.tableFontSize+"px",p.style.fontFamily=a.model.tableFontName,l=a.getCellData(b,a.columns[h].actualColumnIndex),m=a.columns[h].showIcon?l.value.split("|")[1]:l.value,p.value=m,g.appendChild(p)):p=g.childNodes[0],d.appendChild(g),k.editElementType===PWC.Components.Grid.EditElementType.Standard&&p.focus(),a.tableProps.isEditStarted=!0,e.rowIndex=b,e.columnIndex=h,e.editElementType=k.editElementType)},i=function(a){var b=a.keyCode?a.keyCode:a.which;13===b&&j()},j=function(){var b=null,c=!1,f=null;g&&g.childNodes.length>0&&d&&(e.editElementType!==PWC.Components.Grid.EditElementType.Custom&&(b=g.childNodes[0],b.removeEventListener("blur",j),f=b.value),c=a.iGridRef.onCellEditEnd(e.rowIndex,a.columns[e.columnIndex].actualColumnIndex,f),a.utils.clearElement(g),d.removeChild(g)),a.tableProps.isEditStarted=!1,e.rowIndex=null,e.columnIndex=null},k=function(){a.tableProps.isEditStarted&&j()},l=function(){d=null,e.editElementType=null,e.rowIndex=null,e.columnIndex=null,g=null};return{handleCellEdit:h,endEdit:k,clearData:l}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.EventManager=function(a,b){"use strict";var c=null,d=null,e=PWC.Components.Grid.EventSource,f=null,g=null,h=null,i=function(b){c=b,c&&c.selection&&document.body.addEventListener("keydown",c.selection.selectionKeyNavigation),a.parentSvg.addEventListener("mousedown",o),a.parentSvg.addEventListener("mouseup",o),a.parentSvg.addEventListener("contextmenu",l),a.parentSvg.addEventListener("touchstart",o),a.parentSvg.addEventListener("touchend",o),j()},j=function(){requirejs.config({baseUrl:location.href+"/libs",paths:{Hammer:"hammer-2.0.2"}}),require(["Hammer"],function(b){f=new b.Manager(a.parentSvg,{domEvents:!0}),f.add(new b.Tap({event:"doubletap",taps:2})),f.add(new b.Tap({event:"singletap"})),f.get("doubletap").recognizeWith("singletap"),f.get("singletap").requireFailure("doubletap"),f.on("doubletap",v),f.add(new b.Pan({event:"pan",pointers:1,direction:b.DIRECTION_ALL,threshold:1})),f.on("panstart",x),f.on("pan",x),f.on("panend",x)})},k=function(){c&&c.selection&&document.body.removeEventListener("keydown",c.selection.selectionKeyNavigation),a.parentSvg.removeEventListener("mousedown",o),a.parentSvg.removeEventListener("mouseup",o),a.parentSvg.removeEventListener("contextmenu",l),a.parentSvg.removeEventListener("touchstart",o),a.parentSvg.removeEventListener("touchend",o),f&&(f.destroy(),f=null)},l=function(a){return a.preventDefault(),!1},m=function(){c&&c.scrollBar&&c.scrollBar.attachMouseWheelEvent(a.parentSvg)},n=function(){c&&c.scrollBar&&c.scrollBar.removeMouseWheelEvent(a.parentSvg)},o=function(a){"touchstart"===a.type||"touchend"===a.type?(g||(g=!0),p(a)):("mousedown"===a.type||"mouseup"===a.type)&&(g||p(a))},p=function(b){var d=null;switch(b.type){case"mousedown":case"touchstart":c&&c.editHandler&&c.editHandler.endEdit(),d=q(b),d&&(a.eventReference.target=b.target||b.srcElement,"mousedown"!==b.type||3!==b.which&&1!==b.button?s(b):(r(b),a.clearEventReferences()));break;case"mouseup":case"touchend":h||t(b)}},q=function(b){var c=null,d=null;return null===a.eventReference.targetGroup&&(c=a.utils.getMousePoint(b,a.parentSvg,a.isAdoptToScreen,a.zoomFactorCB),d=y(c,b)),d},r=function(b){var d=a.eventReference.targetGroup;(d===e.Data||d===e.ColumnTitles)&&c.tooltip.createRightClickGroup(b)},s=function(b){var d=a.eventReference.targetGroup;switch(d){case e.RowTitles:case e.ColumnTitles:case e.Data:a.tableProps.isPauseMode&&(c.selection.selectionClickHandler(b,d),c.sortHandler.setSortKeyOnSelection());break;case e.ScrollBar:c.scrollBar.onScrollClickEvent(b);break;case e.ColumnVlines:a.model.columnResize&&D(b)}d===e.ColumnTitles&&a.tableProps.isPauseMode&&a.model.sortMode===PWC.Components.Grid.TableSortMode.ByClick&&c.sortHandler.onsortHandler(b)},t=function(b){var d=null,f=null,g=null,h=null,i=a.eventReference.targetGroup;switch("mouseup"!==b.type||3!==b.which&&1!==b.button||c.tooltip.clearTooltip(),i){case e.RowTitles:case e.ColumnTitles:case e.Data:!a.eventReference.isAutoCompleteArea&&a.eventReference.target&&(d=a.getCellPosition(b),a.model.columnTitles&&(d.cellRowIndex=d.cellRowIndex-1),null!==d.cellRowIndex&&(f=a.dataMapper.getDataIndex(d.cellRowIndex)),null!==d.cellColumnIndex&&(g=a.columns[d.cellColumnIndex].actualColumnIndex)),u(f,g),c.selection.fireSelection();break;case e.ColumnVlines:a.eventReference.target&&a.parentSvg.removeChild(a.eventReference.target),E(),a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnColumnResize)&&(h=a.columns[a.eventReference.index].actualColumnIndex,a.iGridRef.onColumnResize(h,a.model.gridColumns[h].width));break;case e.ScrollBar:"panend"===b.type?c.scrollBar.onScrollEvent(b):c.scrollBar.onScrollClickEvent(b)}a.clearEventReferences()},u=function(b,c){switch(a.eventReference.targetGroup){case e.RowTitles:a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnRowHeaderClick)&&a.iGridRef.onRowHeaderClick(b);break;case e.ColumnTitles:a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnColumnHeaderClick)&&a.iGridRef.onColumnHeaderClick(c);break;case e.Data:a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnCellClick)&&a.iGridRef.onCellClick(b,c)}},v=function(b){var d=q(b);d&&a.tableProps.isPauseMode&&a.eventReference.targetGroup===e.ColumnTitles&&a.model.sortMode===PWC.Components.Grid.TableSortMode.ByDoubleClick&&c.sortHandler&&c.sortHandler.onsortHandler(b),(a.eventReference.targetGroup===e.Data||a.eventReference.targetGroup===e.RowTitles||a.eventReference.targetGroup===e.ColumnTitles)&&w(b,d),a.clearEventReferences()},w=function(b,d){var f=null,g=null,h=a.eventReference.isAutoCompleteArea,i=a.getCellPosition(b);a.model.columnTitles&&(i.cellRowIndex=i.cellRowIndex-1),f=a.dataMapper.getDataIndex(i.cellRowIndex),null!==i.cellColumnIndex&&(g=a.columns[i.cellColumnIndex].actualColumnIndex),h&&(a.eventReference.targetGroup===e.Data&&f<a.dataMapper.getTotalRecords()?g=null:f=g=null),a.eventReference.targetGroup===e.RowTitles?a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnRowHeaderDoubleClick)&&a.iGridRef.onRowHeaderDoubleClick(f):a.eventReference.targetGroup===e.ColumnTitles?a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnColumnHeaderDoubleClick)&&a.iGridRef.onColumnHeaderDoubleClick(g):a.eventReference.targetGroup===e.Data&&(a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnCellDoubleClick)&&a.iGridRef.onCellDoubleClick(f,g),d&&a.tableProps.isEditEnabled&&a.tableProps.isPauseMode&&c.editHandler&&c.editHandler.handleCellEdit(f,i.cellColumnIndex))},x=function(b){var f=null,g=null,i=null;if("panstart"!==b.type||(a.eventReference.targetGroup===PWC.Components.Grid.EventSource.ScrollBar&&a.clearEventReferences(),f=q(b)))if(g=b.pointers[0].target||b.srcElement,b.preventDefault(),"panstart"===b.type||"pan"===b.type){if(h=!0,a.eventReference.targetGroup===e.ScrollBar)"panstart"===b.type&&(a.eventReference.target=g),c.scrollBar.onScrollEvent(b);else if(a.eventReference.targetGroup===e.ColumnVlines&&a.model.columnResize)D(b);else if(a.eventReference.targetGroup===e.Data||a.eventReference.targetGroup===e.RowTitles)if(i=A(b),i.required)d||(d=setInterval(B,100,i));else{if(d&&(clearInterval(d),d=null),-1!==g.id.indexOf("OuterBorder")||-1!==g.id.indexOf("ParentSvg"))return;c.selection.selectionDragHandler(b),c.sortHandler.setSortKeyOnSelection()}}else d&&(clearInterval(d),d=null),t(b),h=!1},y=function(b,d){var e=!1,f=d.target||d.srcElement,g=a.tableProps.y,h=a.tableProps.x,i=a.getRowHeaderWidth(),j=a.getHeaderHeight(),k=c.scrollBar.getVScrollBarWidth();return f&&"line"===f.tagName&&f.parentNode.id&&-1!==f.parentNode.id.indexOf("OffSetVLinesHeaderGroup")&&a.model.columnResize?(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ColumnVlines,e=!0):f&&"line"===f.tagName&&f.parentNode.id&&-1!==f.parentNode.id.indexOf("OffSetVLinesDataGroup")&&a.model.columnResize?(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ColumnVlines,e=!0):b&&null!==b.x&&null!==b.y&&b.x>h&&b.y>g&&(b.x<h+i?b.y<g+j?(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.RowTitles,a.eventReference.isAutoCompleteArea=!0,e=!0):b.y>g+j&&b.y<=g+a.tableProps.height?"rect"===d.target.tagName&&(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.RowTitles,e=z(d,b,i,j)):b.y>g+a.tableProps.height&&(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ScrollBar,e=!0):b.x>h+i&&b.x<=h+a.tableProps.width-k?b.y<g+j?"rect"===d.target.tagName&&(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ColumnTitles,e=z(d,b,i,j)):b.y>g+j&&b.y<=g+a.tableProps.height?"rect"===d.target.tagName&&(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.Data,e=z(d,b,i,j)):b.y>g+a.tableProps.height&&(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ScrollBar,e=!0):b.x>h+a.tableProps.width-k&&(b.y<g+j?a.model.useSortKey?c.sortHandler.sortKeyGroupEventListner(d):(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ScrollBar,e=!0):b.y>g+j&&b.y<=g+a.tableProps.height?(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ScrollBar,e=!0):b.y>g+a.tableProps.height&&(a.eventReference.targetGroup=PWC.Components.Grid.EventSource.ScrollBar,e=!0))),e},z=function(b,d,e,f){var g=null;return d.y>a.tableProps.y+a.dataMapper.getViewPortDisplayedRowCount()*a.tableProps.cellHeight+f||d.x>a.getTotalColumnWidth()+e+a.tableProps.x?(a.eventReference.isAutoCompleteArea=!0,a.tableProps.isPauseMode&&!b.ctrlKey&&(c.selection.clearPrevSelection(),c.selection.clearSelectionInfo(),c.selection.clearSelectionRects(),c.sortHandler.setSortKeyOnSelection()),g=!1):(a.eventReference.isAutoCompleteArea=!1,g=!0),g},A=function(b){var c=a.utils.getMousePoint(b,a.parentSvg,a.isAdoptToScreen,a.zoomFactorCB),d=null,e={required:!1,direction:null};return d=c.y,c.y>a.tableProps.height?(e.required=!0,e.direction="down"):c.y<a.getHeaderHeight()+a.tableProps.y&&(e.required=!0,e.direction="up"),e},B=function(b){var d={cellRowIndex:null,cellColumnIndex:null},e=a.dataMapper.getTotalRecords(),f=a.dataMapper.getViewPortEndIndex(),g=a.dataMapper.getViewPortStartIndex(),h=c.selection.getSelection().selectedCellColumnIndex;d.cellColumnIndex=a.getViewportColumnIndex(h),null!==a.eventReference.targetGroup&&("down"===b.direction&&e-1>f?(c.scrollBar.scrollVertical(g+1),d.cellRowIndex=a.dataMapper.getViewPortDisplayedRowCount(),a.model.columnTitles||d.cellRowIndex--):"up"===b.direction&&g>0&&(c.scrollBar.scrollVertical(g-1),d.cellRowIndex=1,a.model.columnTitles||d.cellRowIndex--),c.selection.dragAutoSelection(d))},C=function(){var b=c.scrollBar,d=a.tableProps.width;return d-=a.getRowHeaderWidth(),b&&(d-=b.getVScrollBarWidth()),d},D=function(b){var c,d=null,e=null,f=null,g=null,h=null;null!==a.eventReference.target&&null!==a.eventReference.index?d=a.eventReference.index:(d=F(b.target||b.srcElement),a.eventReference.index=d,b.target.style.display="none",a.parentSvg.appendChild(b.target)),h=a.utils.getMousePoint(b,a.parentSvg,a.isAdoptToScreen,a.zoomFactorCB),c=h.x-(a.columns[d].x+a.columns[d].width),e=a.columns[d].actualColumnIndex,c=parseInt(c,10),c>0?(f=a.getTotalColumnWidth(),g=C(),e===a.model.gridColumns.length-1&&f+c>=g?(a.model.gridColumns[e].width=g-(f-a.model.gridColumns[e].width),a.actionHandler(PWC.Components.Grid.GridActions.Reload)):(a.model.gridColumns[e].width+=c,a.actionHandler(PWC.Components.Grid.GridActions.Reload)),E(a.eventReference.index,!0)):a.model.gridColumns[e].width+c>=a.getMinColumnWidth()&&(a.model.gridColumns[e].width+=c,a.actionHandler(PWC.Components.Grid.GridActions.Reload),E(a.eventReference.index,!0))},E=function(c,d){var e=b(PWC.Components.Grid.GetInstance.Column);e&&(d&&null!==c?e.displayResizeLine(a.eventReference.index):e.clearResizeLine())},F=function(a){for(var b=0;null!=(a=a.previousSibling);)b++;return b},G=function(a){c&&(c.editHandler=a)},H=function(){c=null,d=null,g=null,h=null};return{addListeners:i,removeListeners:k,addMouseWheelEventListener:m,removeMouseWheelEventListener:n,setEditHandler:G,clearData:H}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.FilterColumn=function(a,b,c){"use strict";var d=[],e=null,f=1,g=function(){var d=0,f=null,g=a.getRowHeaderWidth(),k=a.getTotalColumnWidth(),l=a.tableProps.width-g;f=c(PWC.Components.Grid.GetInstance.Scroll),f&&(f.getVScrollBarConfig().visible&&(l-=f.getVScrollBarWidth(),l-=a.model.borderWidth),d=k>l?l:k),d+=g,h(d),a.model.rowTitles&&i(),j(d),b.appendChild(e)},h=function(b){var c=k();c.id="filterDiv_"+a.id,c.width=b,c.height=a.filterColumnProps.height,c.top=a.tableProps.y+a.tableProps.contentHeight,c.left=a.tableProps.x,c.background="transparent",c.position="absolute",e=o(c),e.style.borderTop=a.model.gridLineWidth+"px solid "+a.model.titleGridLineColor},i=function(){var b,c=k(),d=a.getRowHeaderWidth();c.width=d-a.model.gridLineWidth,c.height=a.filterColumnProps.height,c.id="rowHeaderDiv"+a.id,c.background=a.model.titleColor,c.position="absolute",c.top=0,c.left=0,a.model.title3D&&(c.width=c.width-a.tableProps.shadowLineWidth,c.height=c.height-a.tableProps.shadowLineWidth,c.left=c.left+a.tableProps.shadowLineWidth/2),b=o(c),a.model.rowTitles&&e.appendChild(b)},j=function(b){var c=null,g=null,h=0,i=0,j=k(),l=a.columns.length,m=a.getRowHeaderWidth();for(h=0;l>h;h++){for(c=null,g=null,j.id="innerDiv_"+h,j.width=a.columns[h].width-a.model.gridLineWidth,j.left=m,j.height=a.filterColumnProps.height,a.model.title3D&&(j.width=j.width-2*a.tableProps.shadowLineWidth,j.left=j.left+a.tableProps.shadowLineWidth,j.height=j.height-a.tableProps.shadowLineWidth),j.background=a.model.titleColor,c=o(j),g=p(h),i=0;i<d.length;i++)d[i].actualColumnIndex===a.columns[h].actualColumnIndex&&(g.value=d[i].textValue);b>m&&(m+j.width>=b?(j.width=b-m-f,c.style.width=j.width+"px",g.style.width=j.width+"px",c.appendChild(g)):(g.style.width=j.width-a.filterColumnProps.imageWidth+"px",c.appendChild(g),c.appendChild(q())),e.appendChild(c),m+=a.columns[h].width)}},k=function(){var a={id:null,top:0,left:0,height:0,width:0,position:"absolute",border:"none",background:"none"};return a},l=function(b){var d=0,e=null,f={actualColumnIndex:null,textValue:null},g=b.target||b.srcElement,h=g.id.split("_"),i=b.keyCode?b.keyCode:b.which;return 13===i?void b.target.blur():(d=parseInt(h[0],10),f.actualColumnIndex=a.columns[d].actualColumnIndex,f.textValue=b.target.value,m(f),d===a.columns.length-1&&a.columns[d].width+a.columns[d].x>=a.model.left+a.tableProps.width&&(e=c(PWC.Components.Grid.GetInstance.Scroll),e&&e.scrollHorizontal(PWC.Components.Grid.ArrowKeySelection.MoveColumnToLeft,f.actualColumnIndex)),void(a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnFilterEditEnd)&&a.iGridRef.onFilterTextChange(f.actualColumnIndex,b.target.value)))},m=function(a){var b=null;0===d.length?d.push(a):(b=n(a.actualColumnIndex),null!==b?""===a.textValue||"*"===a.textValue?d.splice(b,1):d[b].textValue=a.textValue:d.push(a))},n=function(a){for(var b=null,c=0;c<d.length;c++)if(d[c].actualColumnIndex===a){b=c;break}return b},o=function(a){var b=null;return b=document.createElement("div"),b.setAttribute("id",a.id),b.style.position=a.position,b.style.width=a.width+"px",b.style.height=a.height+"px",b.style.background=a.background,b.style.left=a.left+"px",b.style.top=a.top+"px",b.style.pointerEvents="inherit",b},p=function(b){var c=null,d=a.filterColumnProps.height;return a.model.title3D&&(d-=a.tableProps.shadowLineWidth),c=document.createElement("input"),c.setAttribute("type","text"),c.setAttribute("id",b+"_input"),c.style.width="100px",c.style.height=d+"px",c.style.border="none",c.value="*",c.style.verticalAlign="top",c.style.verticalAlign="left",c.style.pointerEvents="inherit",c.style.boxSizing="border-box",a.appMode===PWC.Components.AppMode.RUNTIME&&a.model.enabled||(c.readOnly=!0),c.addEventListener("keyup",l),c},q=function(){var b=null;return b=document.createElement("img"),b.style.marginRight=0,b.style.marginTop="4px",b.src=a.model.filterImagURL,b.style.width=a.filterColumnProps.imageWidth+"px",b.style.height=a.filterColumnProps.imageHeight+"px",b.style.pointerEvents="none",b.style.boxSizing="border-box",b},r=function(){e&&(b.removeChild(e),e=null)},s=function(){d.length=null,e=null};return{createFilterBoxes:g,clearFilterBoxes:r,clearData:s}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.GridControl=function(a,b){"use strict";var c=a,d=null,e=!1,f=!1,g=null,h=null,i=null,j=.9,k="9999",l=new PWC.Components.Grid.GridHelper,m=null,n=null,o=null,p=null,q=null,r=null,s=null,t=function(a,c,d){if(a&&"object"==typeof a&&c&&"object"==typeof c&&!e){if(l.id=b,!l.id)return;l.iGridRef=c,l.model=a,void 0!==d&&null!==d&&(l.appMode=d),l.actionHandler=X,l.dataMapper=new PWC.Components.Grid.DataMapper,l.clipPath.id=l.id+"_svgHClipPath",l.clipPathRowHeader.id=l.id+"_svgRowHeaderClipPath",l.imageFilter.id=l.id+"_imageBlur",l.utils.clearData(),f=!1,l.utils.validateGridModel(l.model)&&(l.setDefaultCursorStyle(),u(),g=new PWC.Components.Grid.ColumnHeader(l),g&&(q=new PWC.Components.Grid.SortHandler(l,W)),h=new PWC.Components.Grid.RowHeader(l),i=new PWC.Components.Grid.DataRow(l),m=new PWC.Components.Grid.ScrollHandler(l,W),n=new PWC.Components.Grid.ToolTip(l,W),p=new PWC.Components.Grid.SelectionHandler(l,W),r=new PWC.Components.Grid.EventManager(l,W),l.tableProps.isRecordLevelSelection||p.enableRowLevelSelection(),v(),M(),l.appMode===PWC.Components.AppMode.RUNTIME&&l.model.enabled&&V(),e=!0)}return e},u=function(){l.parentSvg||(l.parentSvg=l.utils.createSVG("svg",{id:l.id+"_ParentSvg","data-tif-type":"WSI:SvgGrid","data-tif-id":"Tif"+l.id+"_ParentSvg"},null,{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none"}),c.appendChild(l.parentSvg)),l.parentGroup||(l.parentGroup=l.utils.createSVG("g",{id:l.id+"_ParentGroup"},null,{userSelect:"none",WebkitUserSelect:"none",cursor:l.tableProps.defaultCursorStyle}))},v=function(){var a=m.getHScrollBarConfig().columnStartIndex;l.utils.validateColumnModel(l.model),x(),C(),w(a),m.handleScrollBars()},w=function(a){g.createColumns(a),q&&q.handleColumnSortGroup(),l.model.columnTitles&&h.add("header",null),l.model.autoCompleteRows&&O(),s&&s.clearFilterBoxes(),l.model.columnTitles&&l.tableProps.isFilterEnabled&&s.createFilterBoxes()},x=function(){var a=null;
m&&(m.setScrollBarProps(),a=m.getHScrollBarHeight()),A(),y(),z(a),p&&p.setAutoSelectionColors()},y=function(){var b=l.utils.calculateFontDimensions(null,l.model,PWC.Components.Grid.CellType.DataRow),c=l.utils.calculateFontDimensions(null,l.model,PWC.Components.Grid.CellType.ColumnHeader),d=b.contentHeight>c.contentHeight?b.contentHeight:c.contentHeight,e=m.getHScrollBarHeight(),f=0,g=null;l.tableProps.borderWidth=l.model.borderWidth,g=2*l.tableProps.borderWidth,l.tableProps.x=l.tableProps.y=l.tableProps.borderWidth,l.tableProps.tableWidthFactor=b.widthFactor,l.tableProps.titleWidthFactor=c.widthFactor,l.tableProps.contentHeight=d+l.model.cellSpaceTop,l.tableProps.cellHeight=l.tableProps.contentHeight+l.model.gridLineWidth+l.model.cellSpaceBottom,l.model.rowTitles&&(f=l.tableProps.rowHeaderContentWidth+l.model.gridLineWidth),l.model.width<f+g&&(l.model.width=f+g),l.tableProps.width=l.model.width-g,l.model.height<e+g&&(l.model.height=e+g),l.tableProps.height=l.getTableHeight()-g-e,l.utils.setSVGAttribute(a,"height",l.getTableHeight())},z=function(a){var b=l.getHeaderHeight(),c=2*l.tableProps.borderWidth,d=null,e=l.getTableHeight()-c;"number"==typeof a&&(e-=a),l.model.columnTitles&&(e-=b),d=Math.ceil(e/l.tableProps.cellHeight),l.dataMapper.setViewPortSize(d),l.dataMapper.setSkipLastRow(e%l.tableProps.cellHeight!==0&&e%l.tableProps.cellHeight<l.tableProps.contentHeight?!0:!1)},A=function(){var a,b=null,c=l.dataMapper.getTotalRecords(),d=l.dataMapper.getViewPortSize(),e=c,f=null,g=null,h=k.length,i=!1;l.model.autoCompleteRows&&(e=d>c?d:c),"number"==typeof e&&(f=e.toString().length),f>=h?(g=e.toString(),l.tableProps.rowHeaderLength=f,i=!0):(g=k,l.tableProps.rowHeaderLength=h),b=l.utils.calculateFontDimensions(g,l.model,PWC.Components.Grid.CellType.RowHeader),l.tableProps.rowHeaderContentWidth=b.contentWidth,i&&f>=l.tableProps.rowHeaderLength&&(a=l.utils.calculateFontDimensions("99",l.model,PWC.Components.Grid.CellType.RowHeader).contentWidth,l.tableProps.rowHeaderContentWidth+=a,l.tableProps.rowHeaderLength+=2)},B=function(){var a=l.dataMapper.getTotalRecords(),b=l.dataMapper.getViewPortSize(),c=a,d=null,e=k.length;l.model.autoCompleteRows&&(c=b>a?b:a),"number"==typeof c&&(d=c.toString().length),e>d&&e!==l.tableProps.rowHeaderLength?hb():l.tableProps.rowHeaderLength>e&&d<l.tableProps.rowHeaderLength&&d+2!==l.tableProps.rowHeaderLength?hb():d>=l.tableProps.rowHeaderLength&&hb()},C=function(){D(),E(),F(),g.init(),i.init(),h.init(),p.createSelectionRectGroup(),m.createScrollBarGroup(),g.createHighlightGroup()},D=function(){d?(l.utils.setSVGAttribute(d,"x",l.tableProps.borderWidth/2),l.utils.setSVGAttribute(d,"y",l.tableProps.borderWidth/2),l.utils.setSVGAttribute(d,"width",l.model.width-l.tableProps.borderWidth),l.utils.setSVGAttribute(d,"height",l.getTableHeight()-l.tableProps.borderWidth),l.utils.setSVGAttribute(d,"stroke-width",l.tableProps.borderWidth),l.utils.setSVGAttribute(d,"stroke",l.model.borderColor),l.utils.setSVGAttribute(d,"fill",l.model.backgroundColor)):(d=l.utils.createSVG("rect",{id:l.id+"_OuterBorder",x:l.tableProps.borderWidth/2,y:l.tableProps.borderWidth/2,width:l.model.width-l.tableProps.borderWidth,height:l.getTableHeight()-l.tableProps.borderWidth,fill:l.model.backgroundColor,"stroke-width":l.tableProps.borderWidth,stroke:l.model.borderColor},null),l.parentGroup.appendChild(d))},E=function(){var a=null;for(l.svgDef||(l.svgDef=l.utils.createSVG("defs",{id:l.id+"_SvgDef"}),l.parentGroup.appendChild(l.svgDef)),l.clipPath.path||(l.clipPath.path=l.utils.createSVG("clipPath",{id:l.clipPath.id}),l.svgDef.appendChild(l.clipPath.path));l.clipPath.path.firstChild;)l.clipPath.path.removeChild(l.clipPath.path.firstChild);for(a=l.utils.createSVG("rect",{x:l.tableProps.x,y:l.tableProps.y,width:l.tableProps.width,height:l.tableProps.height}),l.clipPath.path.appendChild(a),l.clipPathRowHeader.path||(l.clipPathRowHeader.path=l.utils.createSVG("clipPath",{id:l.clipPathRowHeader.id}),l.svgDef.appendChild(l.clipPathRowHeader.path));l.clipPathRowHeader.path.firstChild;)l.clipPathRowHeader.path.removeChild(l.clipPathRowHeader.path.firstChild);a=l.utils.createSVG("rect",{x:l.tableProps.x,y:l.tableProps.y,width:l.getRowHeaderWidth(),height:l.tableProps.height}),l.clipPathRowHeader.path.appendChild(a)},F=function(){l.imageFilter.filter||(l.imageFilter.filter=l.utils.createSVG("filter",{id:l.imageFilter.id}),l.svgDef.appendChild(l.imageFilter.filter)),l.imageFilter.feGaussianBlur||(l.imageFilter.feGaussianBlur=l.utils.createSVG("feGaussianBlur",{stdDeviation:j}),l.imageFilter.filter.appendChild(l.imageFilter.feGaussianBlur))},G=function(a){var b=!1;return"boolean"==typeof a&&(l.tableProps.autoScrollToLatest=a,b=!0),b},H=function(a,b){a?(l.isAdoptToScreen=a,l.zoomFactorCB=b):(l.isAdoptToScreen=a,l.zoomFactorCB=null)},I=function(a){var b=!1;return a&&(l.tableProps.isCustomSortingEnabled=a,b=!0),b},J=function(a,b){var c=!1;return e&&(a?(l.tableProps.isEditEnabled=!0,o||(o=new PWC.Components.Grid.EditHandler(l,b,W),c=!0,r.setEditHandler(o))):(l.tableProps.isEditEnabled=!1,o&&o.endEdit(),o=null)),c},K=function(a,b){var c=!1;return e&&(a?(l.tableProps.isFilterEnabled=!0,s||(c=!0,s=new PWC.Components.Grid.FilterColumn(l,b,W))):(l.tableProps.isFilterEnabled=!1,s&&s.clearFilterBoxes(),s=null),hb()),c},L=function(){return l.tableProps.autoScrollToLatest},M=function(){f||(l.parentSvg.appendChild(l.parentGroup),f=!0)},N=function(){f&&(l.parentSvg.removeChild(l.parentGroup),f=!1)},O=function(){P(l.dataMapper.getViewPortSize())},P=function(a){var b=i.getChildCount(),c=b;for(c;b+a>c;c++)Q(c);h.createVLine(),i.createVLines()},Q=function(a){var b=i.getChild(a);null==a||b||(b=i.getEmptyRow(),i.modifyRow(b,a,null,null),i.append(b),h.add("data",a),i.createHLine(a))},R=function(a,b){var c=a,d=null,e=null,f=a+b,g=null;for(c;f>c;c++)d=l.dataMapper.getRowIndex(c),g=l.iGridRef.getRowFlashInfo(c),e=i.getChild(d),null!==d&&e&&i.modifyRow(e,d,c,g);h.update()},S=function(a,b){var c=a,d=a+b;for(c;d>c;c++)i.clearRow(c)},T=function(a,b){var c=a+b-1;for(c;c>=a;c--)U(c);h.createVLine(),i.createVLines()},U=function(a){i.deleteRow(a),l.model.columnTitles&&a++,h.remove(a)},V=function(){var a={selection:p,tooltip:n,scrollBar:m,sortHandler:q,editHandler:o};r.addListeners(a)},W=function(a){var b=null;switch(a){case PWC.Components.Grid.GetInstance.Column:b=g;break;case PWC.Components.Grid.GetInstance.DataRow:b=i;break;case PWC.Components.Grid.GetInstance.RowHeader:b=h;break;case PWC.Components.Grid.GetInstance.Scroll:b=m;break;case PWC.Components.Grid.GetInstance.Selection:b=p;break;case PWC.Components.Grid.GetInstance.Sort:b=q;break;case PWC.Components.Grid.GetInstance.Edit:b=o}return b},X=function(a,b){switch(a){case PWC.Components.Grid.GridActions.Partial_Load:Y(b);break;case PWC.Components.Grid.GridActions.Load:_(l.dataMapper.getTotalRecords());break;case PWC.Components.Grid.GridActions.Reload:hb()}},Y=function(a){N(),gb(),l.columns.length=0,l.dataMapper.setViewPortStartIndex(null),l.dataMapper.setViewPortEndIndex(null),l.utils.validateColumnModel(l.model),w(a),_(l.dataMapper.getTotalRecords()),M()},Z=function(a){var b=null;m&&(b=m.getVScrollBarConfig().visible),l.model.verticalScrollbarMode===PWC.Components.Grid.ScrollBarMode.OnDemand&&b&&a<=l.dataMapper.getViewPortSize()?hb():!b&&a>l.dataMapper.getViewPortSize()?hb():m.handleVerticalScrollbar()},$=function(a){var b=!1,c=null;return e&&(c=l.dataMapper.getTotalRecords(),b=_(a),l.tableProps.isPauseMode&&c!==a&&Z(a)),b},_=function(a){var b=!1,c=null,d=null,e=0;return"number"==typeof a&&(l.dataMapper.setTotalRecords(a),B(),c=ab(a),m&&(d=m.getVScrollBarConfig().scrolledValue),d>=0&&l.tableProps.isPauseMode?e=d+c-1>a-1?a-c:d:a>c&&L()&&(e=a-c),bb(e,c),b=!0),b},ab=function(a){var b=l.dataMapper.getMaxRowsToDisplay();return b>a&&(b=a),b},bb=function(a,b){var c=l.dataMapper.getViewPortSize(),d=l.dataMapper.getViewPortDisplayedRowCount();l.dataMapper.setViewPortStartIndex(a),l.dataMapper.setViewPortEndIndex(a+b-1),b>=0&&(N(),p&&p.clearSelectionRects(),l.model.autoCompleteRows?(R(a,b),c>b&&S(b,c-b)):(b>d?P(b-d):d>b&&T(b,d-b),R(a,b)),p&&p.applySelection(),M())},cb=function(a,b){var c=!1,d=!1;return e&&"object"==typeof a&&"number"==typeof b&&a.length>0&&(l.tableProps.isPauseMode&&b!==l.dataMapper.getTotalRecords()&&(d=!0),l.dataMapper.setTotalRecords(b),B(),1===a.length?"number"==typeof a[0].value&&"number"==typeof a[0].type&&(a[0].type===PWC.Components.Grid.DataOperationType.Add?a[0].value<=b&&(c=!0,db(a[0].value,b)):a[0].type===PWC.Components.Grid.DataOperationType.Delete?(c=!0,fb(a[0].value,b)):a[0].type===PWC.Components.Grid.DataOperationType.Update&&(c=!0,eb(a[0].value))):(_(b),c=!0),d&&Z(b)),c},db=function(a,b){var c=l.dataMapper.getViewPortStartIndex(),d=l.dataMapper.getViewPortEndIndex(),e=0,f=l.dataMapper.getViewPortDisplayedRowCount();0===f?_(b):(e=ab(b),L()?(a>=d?d=a:d+=1,c=d-e+1,bb(c,e)):bb(c,e))},eb=function(a){var b=l.dataMapper.getViewPortStartIndex(),c=l.dataMapper.getViewPortEndIndex();a>=b&&c>=a&&(R(a,1),p&&p.applySelection())},fb=function(a,b){var c=l.dataMapper.getViewPortEndIndex();c>=a&&a>=0&&_(b)},gb=function(){i.clearGroup(),g.clearGroup(),h.clearGroup(),q&&q.clearGroup()},hb=function(){o&&o.endEdit(),N(),gb(),l.columns.length=0,v(),l.dataMapper.setViewPortStartIndex(null),l.dataMapper.setViewPortEndIndex(null),_(l.dataMapper.getTotalRecords()),M()},ib=function(){e&&(N(),bb(l.dataMapper.getViewPortStartIndex(),l.dataMapper.getViewPortDisplayedRowCount()),M())},jb=function(){var a=!1;return e&&(l.dataMapper.setViewPortStartIndex(null),l.dataMapper.setViewPortEndIndex(null),l.dataMapper.setTotalRecords(0),p.clearSelectionInfo(),m.resetHorizontalScroll(),m.resetVerticalScroll(),N(),p.clearSelectionRects(),hb(),a=!0,M()),a},kb=function(a){var b=!1;return"number"==typeof a&&(l.subscribedEvents.push(a),b=!0),b},lb=function(a){var b=!1,c=null;return"number"==typeof a&&(c=l.subscribedEvents.indexOf(a),-1!==c&&(l.subscribedEvents.splice(c,1),b=!0)),b},mb=function(a){var b=null,c=null,d=!1;if(e){if(void 0!==a&&null!==a&&"object"==typeof a)for(b in a)b&&l.model.hasOwnProperty(b)&&(l.model[b]=a[b],"selectionType"===b&&p&&p.resetSelectionInfo(),d=!0);else p.resetSelectionInfo(),d=!0;c=l.utils.validateGridModel(l.model),c?(l.model.gridColumns&&0===l.model.gridColumns.length&&m&&m.resetHorizontalScroll(),z(),hb(),p&&p.fireSelection()):d=!1}return d},nb=function(){var a=0,b=null,c=null,d=l.dataMapper.getViewPortStartIndex(),f=l.dataMapper.getViewPortDisplayedRowCount(),g=null;if(e){for(l.isFlashingOn=!l.isFlashingOn,g=d,a=0;f>a;a++)b=l.dataMapper.getRowIndex(g),c=l.iGridRef.getRowFlashInfo(g),c&&null!==b&&i.modifyRow(i.getChild(b),b,g,c),g++;p.clearSelectionRects(),p.applySelection()}},ob=function(a,b){e&&"boolean"==typeof a&&(l.tableProps.isRecordLevelSelection=a,a===!0?p&&"object"==typeof b&&p.enableRecordLevelSelection(b):a===!1&&p&&p.enableRowLevelSelection())},pb=function(a){"boolean"==typeof a&&(l.tableProps.isAutoSelectionEnabled=a)},qb=function(){var a=l.dataMapper.getViewPortStartIndex(),b=l.dataMapper.getViewPortEndIndex(),c=l.dataMapper.getViewPortDisplayedRowCount(),d=l.dataMapper.getMaxRowsToDisplay(),e={startIndex:null,endIndex:null,size:null};return c>0&&(e.startIndex=a,e.endIndex=b),d&&(e.size=d),e},rb=function(){l.appMode===PWC.Components.AppMode.RUNTIME&&l.model.enabled&&e&&(l.tableProps.isPauseMode||(l.tableProps.isPauseMode=!0,l.tableProps.autoSelection=!1,hb(),r.addMouseWheelEventListener()),m.setScrollPosition(),p.fireSelection())},sb=function(){l.appMode===PWC.Components.AppMode.RUNTIME&&l.model.enabled&&e&&(l.tableProps.isPauseMode&&(l.tableProps.isPauseMode=!1,l.tableProps.autoSelection=!0,r.removeMouseWheelEventListener(),p.clearPrevSelection(),m.resetVerticalScroll(),hb(),p.clearSelectionInfo(),p.applySelection()),p.fireSelection())},tb=function(){var a=null;return p&&(a=p.getSelection()),a},ub=function(a,b,c,d){e&&p&&p.setSelection(a,b,c,d)},vb=function(){var a={height:null,width:null,vScrollBarWidth:null,hScrollBarHeight:null},b=null,c=null;return a.height=l.getTableHeight(),a.width=l.model.width,m&&(b=m.getVScrollBarConfig(),a.vScrollBarWidth=b.width,c=m.getHScrollBarConfig(),a.hScrollBarHeight=c.height),a},wb=function(a){"boolean"==typeof a&&(l.isFlashingOn=a)},xb=function(){null!==p&&e&&p.clearSelectionInfo()},yb=function(){l&&l.clearData(),i&&i.clearData(),h&&h.clearData(),g&&g.clearData(),o&&o.clearData(),r&&r.clearData(),s&&s.clearData(),m&&m.clearData(),p&&p.clearData(),q&&q.clearData(),n&&n.clearData()},zb=function(){i=null,h=null,g=null,o=null,r=null,s=null,m=null,p=null,q=null,n=null,d=null,f=!1},Ab=function(){e&&(e=!1,l.dataMapper.setViewPortStartIndex(null),l.dataMapper.setViewPortEndIndex(null),l.dataMapper.setTotalRecords(0),p.clearSelectionInfo(),l.appMode===PWC.Components.AppMode.RUNTIME&&l.model.enabled&&r&&r.removeListeners(),o&&l.tableProps.isEditStarted&&o.endEdit(),l.parentSvg.parentNode===a&&a.removeChild(l.parentSvg),s&&l.tableProps.isFilterEnabled&&s.clearFilterBoxes(),yb(),zb())};return{init:t,load:$,unLoad:jb,reloadData:ib,unInit:Ab,invalidateView:cb,subscribeEvent:kb,unSubscribeEvent:lb,setAutoScrollToLatest:G,onPropertyChange:mb,pause:rb,resume:sb,handleFlashing:nb,setRecordLevelSelection:ob,getSelection:tb,getDisplayedRowInfo:qb,setSelection:ub,setCellEditEnabled:J,setAutoSelection:pb,setFilterColumnEnabled:K,setCustomSortingEnabled:I,getTableProps:vb,setFlashStatus:wb,clearSelection:xb,setAdoptGridToScreen:H}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.GridHelper=function(){"use strict";var a=this,b=.3,c=18,d=function(){return{y:0,x:0,width:0,height:0,tableWidthFactor:null,titleWidthFactor:null,contentHeight:0,cellHeight:0,minColumnChars:4,rowHeaderContentWidth:30,rowHeaderLength:null,textOffsetY:.8,shadowLineWidth:1,autoScrollToLatest:!0,autoSelection:!0,isPauseMode:!1,isEditEnabled:!1,isEditStarted:!1,isRecordLevelSelection:!1,borderWidth:null,isAutoSelectionEnabled:!0,isFilterEnabled:!1,isCustomSortingEnabled:!1,defaultCursorStyle:null}},e=function(c,d,e,f,g){var h=f,i=e,j=null,k=null,l=a.columns[d].flashingType;switch(l){case PWC.Components.Grid.FlashingTypes.Standard:j=b,k="url(#"+a.imageFilter.id+")";break;case PWC.Components.Grid.FlashingTypes.ChangeBackgroundColor_TextColor:i=f,h=e;break;case PWC.Components.Grid.FlashingTypes.ChangeMessageColor_TableColor:g&&(a.isAlternateRowColor(c)?(i=a.model.tableColor2,h=a.model.tableForeColor2):(i=a.model.tableColor,h=a.model.tableForeColor))}return{fill:i,forecolor:h,fillOpacity:j,imageFilter:k}};this.isFlashingOn=!1,this.parentGroup=null,this.actionHandler=null,this.id=null,this.parentSvg=null,this.tableProps=d(),this.filterColumnProps={height:20,imageWidth:16,imageHeight:16},this.iGridRef=null,this.appMode=PWC.Components.AppMode.RUNTIME,this.model=null,this.columns=[],this.utils=PWC.Components.Grid.GridUtils,this.dataMapper=null,this.svgDef=null,this.clipPathRowHeader={path:null,id:null},this.clipPath={path:null,id:null},this.imageFilter={filter:null,id:null,feGaussianBlur:null},this.eventReference={target:null,index:null,targetGroup:null,startIndex:null,endIndex:null,isAutoCompleteArea:null},this.isAdoptToScreen=!1,this.zoomFactorCB=null,this.subscribedEvents=[],this.isAlternateRowColor=function(a){return this.model.useTableColor2&&!this.utils.isRowEven(a)?!0:!1},this.getTextOffsetdy=function(){var a=this.tableProps.contentHeight*this.tableProps.textOffsetY;return a},this.getRowHeaderWidth=function(){var a=0;return this.model.rowTitles&&(a=this.tableProps.rowHeaderContentWidth+this.model.gridLineWidth),a},this.getTableHeight=function(){var a=this.model.height;return this.model.autoSize&&this.tableProps.cellHeight&&(a=this.model.visibleRowCount*this.tableProps.cellHeight+this.getHeaderHeight()),a},this.getHeaderHeight=function(){var a=0;return this.model.columnTitles&&(a=this.tableProps.cellHeight),this.tableProps.isFilterEnabled&&this.model.columnTitles&&(a+=this.filterColumnProps.height+this.model.gridLineWidth),a},this.setDefaultCursorStyle=function(){this.tableProps.defaultCursorStyle=this.appMode===PWC.Components.AppMode.RUNTIME?"default":"move"},this.getTextBBoxInfo=function(b,c){var d=null;return null!==c&&(d=a.utils.calculateFontDimensions(c,a.model,b)),d},this.applyShortenContent=function(a,b,c,d,e){var f=null,g=null;g=this.model.gridColumns[d],f=a===PWC.Components.Grid.CellType.DataRow?this.model.shortenCellContent:this.model.shortenTitleContent,"text"===g.columnDataType&&g.showText?b.textContent=f?this.shortenTextContent(c,b.width,b.alignment,f,e,a):c:"image"===g.columnDataType&&(-1!==c.indexOf("|")?(g.showIcon&&(b.imageUrl=c.split("|")[0]),g.showText&&(b.textContent=c.split("|")[1])):g.showIcon&&(b.imageUrl=c),this.shortenImageTextContent(b,f,e,a))},this.shortenTextContent=function(b,c,d,e,f,g){if(void 0!==b&&null!==b){var h=c-a.model.gridLineWidth,i=null,j=null,k=null;k=this.getTextBBoxInfo(g,b),k&&(i=k.contentWidth,d===PWC.Components.Grid.HorizantalAlignment.Left?h-=a.model.cellSpaceLeft:d===PWC.Components.Grid.HorizantalAlignment.Right&&(h-=a.model.cellSpaceRight),f&&(h-=f),0>h&&(h=0),i>h&&(j=PWC.Components.Grid.GridUtils.getVisibleStringInfo(b,h,d,e),b=e?b.substring(0,j.charLength)+"...":b.substring(j.startIndex,j.endIndex)))}return b},this.shortenImageTextContent=function(b,c,d,e){var f=0,g=0,h=b.width-a.model.gridLineWidth,i=0,j=0,k=0,l=null,m=null;if(null===b.textContent){switch(b.textOffset=0,b.alignment){case PWC.Components.Grid.HorizantalAlignment.Left:b.imageOffset=b.dx;break;case PWC.Components.Grid.HorizantalAlignment.Center:b.imageOffset=b.dx-a.getImageSize()/2;break;case PWC.Components.Grid.HorizantalAlignment.Right:b.imageOffset=b.dx-a.getImageSize()}return void(b.imageOffset=b.imageOffset<0?0:b.imageOffset)}if(m=this.getTextBBoxInfo(e,b.textContent)){switch(d&&(h-=d),null!==b.imageUrl&&(f=a.getImageSize()+a.model.iconSpace,i+=f),k=m.contentWidth,i+=k,b.alignment===PWC.Components.Grid.HorizantalAlignment.Left?(g=a.model.cellSpaceLeft,i+=g):b.alignment===PWC.Components.Grid.HorizantalAlignment.Right&&(g=a.model.cellSpaceRight,i+=g),i>h&&(k=h-g-f,l=PWC.Components.Grid.GridUtils.getVisibleStringInfo(b.textContent,k,PWC.Components.Grid.HorizantalAlignment.Left,c),j=l.charLength,b.textContent=c?b.textContent.substring(0,j)+"...":b.textContent.substring(0,j)),m=this.getTextBBoxInfo(e,b.textContent),k=m.contentWidth,b.alignment){case PWC.Components.Grid.HorizantalAlignment.Left:b.imageOffset=b.dx,b.textOffset=f;break;case PWC.Components.Grid.HorizantalAlignment.Center:b.imageOffset=b.dx-(k+f)/2,b.textOffset=(k+f)/2-k/2;break;case PWC.Components.Grid.HorizantalAlignment.Right:b.imageOffset=b.dx-(k+f),b.textOffset=0}b.imageOffset=b.imageOffset<0?0:b.imageOffset,b.textOffset=b.textOffset<0?0:b.textOffset}},this.setContentAlignment=function(a,b,c){var d=a.width-this.model.gridLineWidth;if(void 0!==b)switch((void 0===c||null===c)&&(c=0),b){case PWC.Components.Grid.HorizantalAlignment.Left:a.dx=this.model.cellSpaceLeft,a.textAnchor="start";break;case PWC.Components.Grid.HorizantalAlignment.Center:a.dx=(d-c)/2,a.textAnchor="middle";break;case PWC.Components.Grid.HorizantalAlignment.Right:a.dx=d-this.model.cellSpaceRight-c,a.textAnchor="end"}},this.isCellFlashEnabled=function(a,b){var c=!1,d=this.dataMapper.getDataIndex(a),e=this.iGridRef.getRowFlashInfo(d);return this.isFlashingOn&&e&&this.columns[b].flashing&&(c=!0),c},this.getTotalColumnWidth=function(){var a=0,b=0,c=this.columns.length;for(b;c>b;b++)"autocomplete"!==this.columns[b].columnDataType&&(a+=this.columns[b].width);return a},this.getViewportColumnIndex=function(a){var b,c=null,d=this.columns.length;if(null!==a)for(b=0;d>b;b++)if(this.columns[b].actualColumnIndex===a){c=b;break}return c},this.setCellStyleOverrideEnabled=function(a,b,c,d,f){var g=this.dataMapper.getDataIndex(b),h=!1,i=null,j=null,k=null;void 0!==c&&null!==c&&(j=this.columns[c]),f&&j&&j.flashingType===PWC.Components.Grid.FlashingTypes.ChangeMessageColor_TableColor&&(k=!0),this.isAlternateRowColor(g)?(a.fill=this.model.tableColor2,a.forecolor=this.model.tableForeColor2):(a.fill=this.model.tableColor,a.forecolor=this.model.tableForeColor),d&&j&&(j.useColoumnBackgroundColor&&(this.model.useColumnColors||k)&&d.hasOwnProperty("fill")&&d.fill&&(a.fill=d.fill,h=!0),j.useColumnForeColor&&(this.model.useColumnColors||k)&&d.hasOwnProperty("forecolor")&&d.forecolor&&(a.forecolor=d.forecolor,h=!0),d.fontStrikeOut&&(a.fontStrikeOut="line-through",this.model.tableFontUnderline&&(a.fontStrikeOut+=" underline"))),this.isFlashingOn&&f&&j&&j.flashing&&(i=e(g,c,a.fill,a.forecolor,h),a.fill=i.fill,a.forecolor=i.forecolor,"number"==typeof i.fillOpacity&&(a.fillOpacity=i.fillOpacity),"string"==typeof i.imageFilter&&(a.imageFilter=i.imageFilter))},this.createEmptyCell=function(a,b,c){var d,e=null,f={},g={};return b&&(f["class"]=b),c&&(f.id=c),g.textDecoration="inherit",g.cursor=this.tableProps.defaultCursorStyle,this.appMode===PWC.Components.AppMode.RUNTIME&&this.model.enabled&&(g.cursor="cell"),e=this.utils.createSVG("g",f,null,g),d=this.utils.createSVG("rect",{x:a.x,y:a.y,width:a.width,height:a.height,fill:a.fill}),e.appendChild(d),e},this.modifyCell=function(a,b,c,d){var e=0,f=!1,g=!1,h=!1,i=!1,j=a.childNodes.length;if(a)if(c&&null!==b.textContent&&(f=!0),d&&null!==b.imageUrl&&void 0!==b.imageUrl&&""!==b.imageUrl&&(g=!0),1!==j||g||f)if(!d&&f&&2===j||!c&&g&&2===j||g&&f&&j>2)this.utils.updateCell(a,b);else{for(e=j-1;e>=0;e--)"text"===a.childNodes[e].tagName?f?h=!0:a.removeChild(a.childNodes[e]):"image"===a.childNodes[e].tagName&&(g?i=!0:a.removeChild(a.childNodes[e]));f&&!h&&this.utils.renderText(a,b,this.model.gridLineWidth),g&&!i&&this.utils.renderImage(a,b),this.utils.updateCell(a,b)}else b.y&&""!==b.y&&this.utils.setSVGAttribute(a.childNodes[0],"y",b.y),this.utils.setSVGAttribute(a.childNodes[0],"fill",b.fill)},this.getCellPosition=function(a){var b=null,c=null,d=null,e=null;return b=this.utils.getMousePoint(a,this.parentSvg,this.isAdoptToScreen,this.zoomFactorCB),c=this.getColumnIndexOnPos(b.x),this.model.columnTitles?(d=this.getHeaderHeight(),e=b.y<d?0:1+Math.floor((b.y-this.tableProps.y-d)/this.tableProps.cellHeight)):e=Math.floor((b.y-this.tableProps.y)/this.tableProps.cellHeight),{cellColumnIndex:c,cellRowIndex:e}},this.getColumnIndexOnPos=function(b){var c=a.columns.length-1,d=null;for(b=Math.ceil(b),c;c>=0;c--)if(b>=a.columns[c].x){d=c;break}return d},this.isAutoCompleteCell=function(a,b){var c=!1,d=this.dataMapper.getViewPortStartIndex(),e=this.dataMapper.getViewPortEndIndex();return null!==a&&a<this.columns.length&&"autocomplete"===this.columns[a].columnDataType&&(c=!0),null!==b&&void 0!==b&&(null===d||null===e?c=!0:(d>b||b>e)&&(c=!0)),c},this.isSubscribedEvent=function(a){var b=!1;return-1!==this.subscribedEvents.indexOf(a)&&(b=!0),b},this.clearEventReferences=function(){this.eventReference.startIndex=null,this.eventReference.endIndex=null,this.eventReference.targetGroup=null,this.eventReference.target=null,this.eventReference.index=null,this.isAutoCompleteArea=null},this.getImageSize=function(){return c>this.tableProps.contentHeight?this.tableProps.contentHeight:c},this.getMinColumnWidth=function(){var a=this.tableProps.tableWidthFactor>this.tableProps.titleWidthFactor?this.tableProps.tableWidthFactor:this.tableProps.titleWidthFactor;return this.tableProps.minColumnChars*a},this.clearData=function(){this.isFlashingOn=!1,this.parentGroup=null,this.actionHandler=null,this.id=null,this.parentSvg=null,this.iGridRef=null,this.appMode=PWC.Components.AppMode.RUNTIME,this.model=null,this.columns.length=0,this.dataMapper=null,this.svgDef=null,this.clipPathRowHeader.path=null,this.clipPathRowHeader.id=null,this.clipPath.path=null,this.clipPath.id=null,this.imageFilter.filter=null,this.imageFilter.feGaussianBlur=null,this.imageFilter.id=null,this.clearEventReferences(),this.utils.clearData(),this.tableProps=d(),this.isAdoptToScreen=!1,this.zoomFactorCB=null},this.getCellData=function(a,b){var c=null;return null!==a&&null!==b&&(c=this.iGridRef.getCellData(a,b),void 0!==c.value&&null!==c.value&&("string"!=typeof c.value&&(c.value=String(c.value)),c.value=c.value.split(" ").join(" "))),c},this.getCellWidth=function(a,b){var c=0,d=null,e=null,f=null,g=this.getRowHeaderWidth(),h=this.tableProps.width-g;for(b&&b.getVScrollBarConfig().visible&&(h-=b.getVScrollBarWidth(),h-=this.model.borderWidth),c=0;a>=c;c++)d+=this.columns[c].width;if(h>=d)f=this.columns[a].width-this.model.gridLineWidth;else{for(c=0;a>c;c++)e+=this.columns[c].width;f=h-e}return f}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.RowHeader=function(a){"use strict";var b=null,c=null,d=null,e=null,f=null,g=null,h=.5,i=function(){j(),a.model.rowTitles&&(k(),l())},j=function(){b||(b=a.utils.createSVG("g",null,null,null),a.utils.setSVGAttribute(b,"clip-path","url(#"+a.clipPathRowHeader.id+")"),a.parentGroup.appendChild(b))},k=function(){var d=a.utils.getTitleFontPropeties(a.model);c?a.utils.setSVGStyles(c,d):(c=a.utils.createSVG("g",{id:a.id+"_RowHeaderGroup"},null,d),b.appendChild(c))},l=function(){var c={stroke:a.model.titleGridLineColor,strokeWidth:a.model.gridLineWidth,pointerEvents:"none"},h={stroke:a.model.titleDarkShadowColor,strokeWidth:a.tableProps.shadowLineWidth,pointerEvents:"none"},i={stroke:a.model.titleLightShadowColor,strokeWidth:a.tableProps.shadowLineWidth,pointerEvents:"none"};d||(d=a.utils.createSVG("g",{id:a.id+"_VLinesRowHeaderGroup"}),b.appendChild(d)),e||(e=a.utils.createSVG("g",{id:a.id+"_HLinesRowHeaderGroup"}),b.appendChild(e)),a.utils.setSVGStyles(d,c),a.utils.setSVGStyles(e,c),f||(f=a.utils.createSVG("g",{id:a.id+"_DarkShadowRowHeaderGroup"}),b.appendChild(f)),g||(g=a.utils.createSVG("g",{id:a.id+"_LightShadowRowHeaderGroup"}),b.appendChild(g)),a.utils.setSVGStyles(f,h),a.utils.setSVGStyles(g,i)},m=function(b,d){if(c&&a.model.rowTitles){var e=a.utils.getCellConfig(),f=null;e.x=a.tableProps.x,e.y=a.tableProps.y,e.dy=a.getTextOffsetdy(PWC.Components.Grid.CellType.RowHeader),e.width=a.getRowHeaderWidth(),e.height=a.tableProps.cellHeight,e.fill=a.model.titleColor,e.forecolor=a.model.titleForeColor,e.imageSize=a.getImageSize(),e.contentHeight=a.tableProps.contentHeight,"data"===b?(a.setContentAlignment(e,a.model.rowTitleAlignment),e.textContent=a.dataMapper.getDataIndex(d)+1,e.y=e.y+a.getHeaderHeight()+d*e.height,q(d+1),s(d+1)):(q(0),s(0)),f=a.createEmptyCell(e,"row-header-cell"),a.utils.renderText(f,e,a.model.gridLineWidth),c.appendChild(f),r()}},n=function(){if(a.model.rowTitles){var b=0,d={fill:a.model.titleColor,forecolor:a.model.titleForeColor,textContent:null};for(d.textContent=a.dataMapper.getViewPortStartIndex()+1,a.model.columnTitles&&(b=1),b;b<c.childNodes.length;b++)a.utils.updateCell(c.childNodes[b],d),d.textContent++}},o=function(b){a.model.rowTitles&&c.childNodes[b]&&(c.removeChild(c.childNodes[b]),p(b),t(b))},p=function(a){e.removeChild(e.childNodes[a])},q=function(b){var c={x1:0,y1:0,x2:0,y2:0};c.x1=a.tableProps.x,c.x2=c.x1+a.getRowHeaderWidth(),c.y1=a.tableProps.y+a.getHeaderHeight()+b*a.tableProps.cellHeight-a.model.gridLineWidth/2,c.y2=c.y1,e.appendChild(a.utils.createSVG("line",c))},r=function(){if(a.model.rowTitles){if(a.model.autoCompleteRows&&d.childNodes.length>0)return;var b={x1:0,y1:0,x2:0,y2:0},e=0,f=a.tableProps.y;a.model.autoCompleteRows?f+=a.tableProps.height:(e=c.childNodes.length,a.model.columnTitles&&(e-=1,f+=a.getHeaderHeight()),f+=e*a.tableProps.cellHeight),0===d.childNodes.length?(b.x1=a.tableProps.x+a.getRowHeaderWidth()-a.model.gridLineWidth/2,b.x2=b.x1,b.y1=a.tableProps.y,b.y2=f,d.appendChild(a.utils.createSVG("line",b))):a.utils.setSVGAttribute(d.childNodes[0],"y2",f)}},s=function(b){if(a.model.title3D&&a.model.rowTitles){var c={mx:0,my:0,lx1:0,ly1:0,lx2:0,ly2:0},d=null,e=null,i=a.getHeaderHeight(),j=a.getRowHeaderWidth();c.mx=a.tableProps.x,c.my=a.tableProps.y+i+b*a.tableProps.cellHeight-a.model.gridLineWidth-h,c.lx1=c.mx+j-a.model.gridLineWidth,c.ly1=c.my,c.lx2=c.lx1,c.ly2=0===b&&i>0?a.tableProps.y+h:a.tableProps.y+i+(b-1)*a.tableProps.cellHeight+h,d="M"+c.mx+" "+c.my+" L"+c.lx1+" "+c.ly1+" L"+c.lx2+" "+c.ly2,e=a.utils.createSVG("path",{d:d,fill:"none"}),f.appendChild(e),c.mx=c.lx2,c.my=c.ly2,c.lx1=a.tableProps.x,c.ly1=c.my,c.lx2=c.lx1,c.ly2=a.tableProps.y+i+b*a.tableProps.cellHeight-a.model.gridLineWidth-h,d="M"+c.mx+" "+c.my+" L"+c.lx1+" "+c.ly1+" L"+c.lx2+" "+c.ly2,e=a.utils.createSVG("path",{d:d,fill:"none"}),g.appendChild(e)}},t=function(a){f.childNodes[a]&&f.removeChild(f.childNodes[a]),g.childNodes[a]&&g.removeChild(g.childNodes[a])},u=function(){c&&a.utils.clearElement(c),d&&a.utils.clearElement(d),e&&a.utils.clearElement(e),f&&a.utils.clearElement(f),g&&a.utils.clearElement(g)},v=function(a){return c.childNodes[a]},w=function(){b=null,c=null,d=null,e=null,f=null,g=null};return{init:i,add:m,update:n,remove:o,deleteHGridLine:p,createHLine:q,createVLine:r,clearGroup:u,getChild:v,clearData:w}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.ScrollHandler=function(a,b){"use strict";var c=null,d=null,e=17,f={id:null,width:e,height:0,x:0,y:0,instance:null,visible:!1,borderLine:null,scrolledValue:0,scrollEnd:0},g={id:null,width:0,height:e,x:0,y:0,instance:null,visible:!1,columnStartIndex:0,borderLine:null,scrolledValue:0,scrollEnd:0,isScrollMove:!1},h=!1,i=function(){c||(c=a.utils.createSVG("g",{id:a.id+"_ScrollGroup"}),a.parentGroup.appendChild(c))},j=function(){f.id=a.id+"_VScrollBar",g.id=a.id+"_HScrollBar",k(),l()},k=function(){f.visible=!1,a.model.verticalScrolling&&(a.model.verticalScrollbarMode===PWC.Components.Grid.ScrollBarMode.OnDemand&&a.tableProps.isPauseMode&&a.model.gridColumns.length>0?a.dataMapper.getTotalRecords()>a.dataMapper.getMaxRowsToDisplay()&&(f.visible=!0):a.model.verticalScrollbarMode===PWC.Components.Grid.ScrollBarMode.Always&&(f.visible=!0))},l=function(){g.visible=!1,a.model.horizontalScrolling&&(a.model.horizontalScrollbarMode===PWC.Components.Grid.ScrollBarMode.OnDemand?(m()>a.model.width-2*a.model.borderWidth-a.getRowHeaderWidth()-H()||0!==g.columnStartIndex)&&(g.visible=!0):a.model.horizontalScrollbarMode===PWC.Components.Grid.ScrollBarMode.Always&&(g.visible=!0))},m=function(){var b=0,c=0,d=a.model.gridColumns,e=null;for(d&&(e=d.length),c;e>c;c++)b+=a.model.gridColumns[c].width+a.model.gridLineWidth;return b},n=function(){var b=0,d=0,h=m();g.scrollEnd=G(),g.scrollEnd>0?(b=(a.tableProps.width-a.getRowHeaderWidth()-H())/h,g.scrolledValue>0&&(d=g.scrolledValue/g.scrollEnd)):g.scrolledValue>0&&(g.scrollEnd=g.scrolledValue,b=a.getTotalColumnWidth()/h,d=1),g.width=a.tableProps.width-H(),f.visible&&(g.width=a.tableProps.width-H()-a.tableProps.borderWidth),g.x=a.tableProps.x,g.y=a.tableProps.y+a.tableProps.height,g.width>2*e&&(g.instance=new PWC.Lib.Canvas.ScrollBar(g.id,c,g.x,g.y,g.width,g.height,0,g.scrollEnd,b,d,.01,"top_bottom",x),g.scrollEnd>0?g.instance.enable():g.instance.disable(),g.instance.show())},o=function(){q(),p()},p=function(){var b=E();f.visible===!0?a.tableProps.isPauseMode?(null!==f.instance&&(d!==!1&&f.instance.onPointerUp(0,0),f.instance.remove(),f.instance=null),F(b.startValue,b.endValue,b.buttonHeight,b.initialOffset,b.scrollStep),f.instance&&f.instance.show()):(null===f.instance?(F(b.startValue,b.endValue,b.buttonHeight,b.initialOffset,b.scrollStep),f.instance&&f.instance.show()):(f.height=a.tableProps.height,f.y=a.tableProps.y,a.model.useSortKey&&f.visible&&a.model.columnTitles&&(f.y=a.tableProps.y+a.getHeaderHeight(),f.height=a.tableProps.height-a.getHeaderHeight()),g.visible&&(f.height=f.height-a.model.borderWidth),f.x=a.tableProps.x+a.tableProps.width-f.width,f.instance.hide(),f.height>2*e&&(f.instance.updateScrollbar(f.x,f.y,f.width,f.height),f.instance.show())),f.instance.disable()):null!==f.instance&&(f.instance.remove(),f.instance=null),r()},q=function(){g.visible?(null!==g.instance&&(g.instance.remove(),g.instance=null),n()):null!==g.instance&&(g.instance.remove(),g.instance=null),s()
},r=function(){var b=null,d=null,e=null,g=null,h=null,i=null;null!==f.borderLine&&(c.removeChild(f.borderLine),f.borderLine=null),f.visible&&(g=a.tableProps.y,h=g+a.tableProps.height+I(),i=a.tableProps.borderWidth,e=d=f.x-a.tableProps.borderWidth/2,b=a.utils.createSVG("line",{x1:e,x2:d,y1:g,y2:h,id:a.id+"_VScrollBarBorder"},!1,{stroke:a.model.borderColor,"stroke-width":i,"pointer-events":"none"}),c.appendChild(b),f.borderLine=b)},s=function(){var b,d=null,e=null,f=null,h=null,i=null;null!==g.borderLine&&(c.removeChild(g.borderLine),g.borderLine=null),g.visible&&(e=a.tableProps.x,d=e+a.tableProps.width,i=a.model.borderWidth,f=h=g.y-a.tableProps.borderWidth/2,b=a.utils.createSVG("line",{x1:e,x2:d,y1:f,y2:h,id:a.id+"_HScrollBarBorder"},!1,{stroke:a.model.borderColor,"stroke-width":i,"pointer-events":"none"}),c.appendChild(b),g.borderLine=b)},t=function(b){var c,e,h=a.eventReference.target,i=h.id,j=null,k=null;if(i)if(-1!==i.indexOf(g.id))j=g;else if(-1!==i.indexOf(f.id)&&(j=f,!a.tableProps.isPauseMode))return;j&&("pan"===b.type||"panstart"===b.type||"panend"===b.type)&&(k=a.utils.getMousePoint(b,a.parentSvg,a.isAdoptToScreen,a.zoomFactorCB),c=j.x+k.x,e=j.y+k.y,"panstart"===b.type?(d=!0,j.instance.onPointerDown(c,e,h)):"pan"===b.type?(d=!0,j.instance.onPointerMove(c,e,h)):"panend"===b.type&&(j.instance.onPointerUp(c,e),d=!1))},u=function(b){var c,e,h=a.eventReference.target,i=h.id,j=null,k=null;if(i)if(-1!==i.indexOf(g.id))j=g;else if(-1!==i.indexOf(f.id)&&(j=f,!a.tableProps.isPauseMode))return;j&&("mousedown"===b.type||"mouseup"===b.type||"touchstart"===b.type||"touchend"===b.type)&&(k=a.utils.getMousePoint(b,a.parentSvg,a.isAdoptToScreen,a.zoomFactorCB),c=j.x+k.x,e=j.y+k.y,"mousedown"===b.type||"touchstart"===b.type?(d=!0,j.instance.onPointerDown(c,e,h)):("mouseup"===b.type||"touchend"===b.type)&&(j.instance.onPointerUp(c,e),a.clearEventReferences(),d=!1))},v=function(b,c,d){if("number"==typeof d&&!isNaN(d)){var e=f.scrolledValue;f.scrolledValue=Math.round(d),(e!==Math.round(d)||"scrolledStep"===c)&&(w(c,e,f.scrolledValue),a.actionHandler(PWC.Components.Grid.GridActions.Load,null))}},w=function(b,c,d){var e=a.dataMapper.getViewPortDisplayedRowCount(),f=null;("scrolledStep"===b&&c!==d||"scrollChange"===b||"scrollEnd"===b)&&(f=c>d?"Up":"Down","scrolledStep"===b?"Up"===f&&a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnVScrollUpButtonClick)?a.iGridRef.onVScrollUpButtonClick(d,e):"Down"===f&&a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnVScrollDownButtonClick)&&a.iGridRef.onVScrollDownButtonClick(d,e):"scrollChange"===b?a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnVScrollChange)&&a.iGridRef.onVScrollChange(d,e):"scrollEnd"===b&&a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnVScrollDragEnd)&&a.iGridRef.onVScrollDragEnd(d,e))},x=function(b,c,d){var e=0,f=0,i=g.scrollEnd,j=Math.round(d);!h&&i>=j&&j>=0&&(f=g.columnStartIndex,"scrolledStep"!==c||g.isScrollMove?"scrollEnd"===c?(g.isScrollMove=!1,a.actionHandler(PWC.Components.Grid.GridActions.Reload,null)):"scrollStart"===c?(g.isScrollMove=!0,f=g.columnStartIndex):g.isScrollMove&&1!==a.model.gridColumns.length&&g.scrolledValue!==j&&(a.columns[0]&&j>=g.scrolledValue+a.columns[0].width&&g.scrolledValue<i?(1!==a.columns.length||a.columns[0].actualColumnIndex!==a.model.gridColumns.length-1)&&(g.scrolledValue+=a.columns[0].width,g.columnStartIndex++,C()):a.columns[0]&&a.columns[0].actualColumnIndex>0&&(e=a.model.gridColumns[a.columns[0].actualColumnIndex-1].width+a.model.gridLineWidth,0!==a.columns[0].actualColumnIndex&&j<=g.scrolledValue-e&&(g.scrolledValue-=e,g.columnStartIndex--,C()))):j>g.scrolledValue&&g.scrolledValue<i?y():j<g.scrolledValue&&A(),D(c,f,g.columnStartIndex))},y=function(){a.columns[0]&&(1!==a.columns.length||a.columns[0]&&a.columns[0].actualColumnIndex!==a.model.gridColumns.length-1)&&(g.scrolledValue+=a.columns[0].width,g.columnStartIndex++,C()),h=!0,g.instance.scrollToValue(g.scrolledValue),h=!1},z=function(b){var c,d=null;for(c=0;b>c;c++)d+=a.model.gridColumns[c].width+a.model.gridLineWidth;g.scrolledValue=d,g.columnStartIndex=b,C(),h=!0,g.instance.scrollToValue(g.scrolledValue),h=!1},A=function(){a.columns[0]&&0!==a.columns[0].actualColumnIndex&&(g.scrolledValue-=a.model.gridColumns[a.columns[0].actualColumnIndex-1].width+a.model.gridLineWidth,g.columnStartIndex--,C(),h=!0,g.instance.scrollToValue(g.scrolledValue),h=!1)},B=function(){g.instance&&(g.scrolledValue=0,g.columnStartIndex=0,C(),h=!0,g.instance.scrollToValue(g.scrolledValue),h=!1)},C=function(){a.actionHandler(PWC.Components.Grid.GridActions.Partial_Load,g.columnStartIndex)},D=function(b,c,d){var e=g.columnStartIndex,f=a.columns.length,h=null;(("scrolledStep"===b||"scrollChange"===b)&&c!==d||"scrollEnd"===b)&&(h=c>d?"Left":"Right","scrolledStep"===b?"Left"===h&&a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnHScrollLeftButtonClick)?a.iGridRef.onHScrollLeftButtonClick(e,f):"Right"===h&&a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnHScrollRightButtonClick)&&a.iGridRef.onHScrollRightButtonClick(e,f):"scrollChange"===b?a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnHScrollChange)&&a.iGridRef.onHScrollChange(e,f):a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnHScrollDragEnd)&&a.iGridRef.onHScrollDragEnd(e,f))},E=function(){var b=0,c=0,d=a.dataMapper.getTotalRecords(),e=a.dataMapper.getMaxRowsToDisplay(),h=0,i=0,j=0;return d>e&&(b=0,h=e/d,c=d-e,j=1/(d-e)),c>0&&(i=f.scrolledValue/c),f.scrollEnd=c,f.height=a.tableProps.height,f.x=a.tableProps.x+a.tableProps.width-f.width,f.y=a.tableProps.y,a.model.useSortKey&&f.visible&&a.model.columnTitles&&(f.y=a.tableProps.y+a.getHeaderHeight(),f.height=a.tableProps.height-a.getHeaderHeight()),g.visible&&(f.height=f.height-a.model.borderWidth),{startValue:b,endValue:c,buttonHeight:h,initialOffset:i,scrollStep:j}},F=function(a,b,d,g,h){f.height>2*e&&(f.instance=new PWC.Lib.Canvas.ScrollBar(f.id,c,f.x,f.y,f.width,f.height,a,b,d,g,h,"top_bottom",v),b>0?f.instance.enable():f.instance.disable())},G=function(){var b=0,c=0,d=a.tableProps.width-a.getRowHeaderWidth()-H(),e=a.model.gridColumns.length-1;for(e;e>=0;e--)if(b+=a.model.gridColumns[e].width+a.model.gridLineWidth,b>d){b-=a.model.gridColumns[e].width+a.model.gridLineWidth,c=m()-b;break}return c},H=function(){return f.visible?f.width:0},I=function(){return g.visible?g.height:0},J=function(){return f},K=function(){return g},L=function(a){a.addEventListener("mousewheel",N),a.addEventListener("DOMMouseScroll",N)},M=function(a){a.removeEventListener("mousewheel",N),a.removeEventListener("DOMMouseScroll",N)},N=function(c){var d=0,e=0,g=null;a.tableProps.isEditEnabled&&a.tableProps.isEditStarted&&(g=b(PWC.Components.Grid.GetInstance.Edit),g&&g.endEdit()),(void 0!==c.wheelDelta||void 0!==c.detail)&&(d=c.wheelDelta,e=c.detail,0>d||e>0?f.scrolledValue<f.scrollEnd&&(f.scrolledValue++,O(),S()):(d>0||0>e)&&f.scrolledValue>0&&(f.scrolledValue--,O(),S()),c.preventDefault())},O=function(){var b=f.scrolledValue,c=a.dataMapper.getViewPortDisplayedRowCount();a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnMouseWheelScroll)&&a.iGridRef.onMouseWheelScroll(b,c)},P=function(){g.scrolledValue=0,g.scrollEnd=0,g.columnStartIndex=0,g.isScrollMove=!1,h=!1},Q=function(){f.scrolledValue=0},R=function(a){f.scrolledValue=a,S()},S=function(){void 0!==f.instance&&null!==f.instance?f.instance.scrollToValue(f.scrolledValue):a.actionHandler(PWC.Components.Grid.GridActions.Load,null)},T=function(a,b){switch(a){case PWC.Components.Grid.ArrowKeySelection.MoveColumnToFirst:B();break;case PWC.Components.Grid.ArrowKeySelection.MoveColumnToLeft:z(b);break;case PWC.Components.Grid.ArrowKeySelection.MoveColumnToRight:A()}},U=function(){a.tableProps.autoScrollToLatest&&(f.scrolledValue=f.scrollEnd,S())},V=function(){P(),Q(),c=null,d=null,h=!1};return{createScrollBarGroup:i,setScrollBarProps:j,handleScrollBars:o,onScrollEvent:t,onScrollClickEvent:u,handleVerticalScrollbar:p,getVScrollBarWidth:H,getHScrollBarHeight:I,getVScrollBarConfig:J,getHScrollBarConfig:K,attachMouseWheelEvent:L,removeMouseWheelEvent:M,resetHorizontalScroll:P,resetVerticalScroll:Q,setScrollPosition:U,scrollVertical:R,scrollHorizontal:T,clearData:V}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.SelectionHandler=function(a,b){"use strict";var c=null,d=null,e=null,f={startIndex:null,endIndex:null},g=function(){return{selectionColoring:a.model.selectionColoring,autoSelectionColors:a.model.autoSelectionColors}},h=function(){return{forecolor:a.model.selectedCellForeColor,fill:a.model.selectedCellColor}},i=function(){return{forecolor:a.model.selectedRowForeColor,fill:a.model.selectedRowColor}},j=function(){return{fill:a.model.selectedTitleColor,forecolor:a.model.selectedTitleForeColor}},k=function(){var b,c=null,d=null;if(a.model.selectionType!==PWC.Components.Grid.SelectionType.Multi)if(c=e.getSelection(),d=e.getCellRowSelection(),a.model.selectionType===PWC.Components.Grid.SelectionType.None)e.clearSelection();else if(null!==d&&a.model.selectionType===PWC.Components.Grid.SelectionType.Single)if(c&&c.length>0)for(b=0;b<c.length;b++)c[b]!==d&&e.removeFromSelection(c[b]);else null!==d&&e.addToSelection(d);I()},l=function(){var a={rowSelection:[],selectedCellRowIndex:null,selectedCellColumnIndex:null},b=e.getSelection(),c=e.getCellColumnSelection(),d=e.getCellRowSelection();return b.length>0&&(a.rowSelection=b.slice(0)),a.selectedCellColumnIndex=c,a.selectedCellRowIndex=d,a},m=function(c,d,g,h){if(a.tableProps.isPauseMode){var i=null,j=a.dataMapper.getViewPortStartIndex(),k=a.dataMapper.getViewPortEndIndex(),l=a.dataMapper.getMaxRowsToDisplay(),m=a.dataMapper.getTotalRecords(),o=null,p=null;s(),null!==c&&c instanceof Array&&e.setSelection(c),null!==d&&void 0!==d&&d<a.model.gridColumns.length&&e.setCellColumnSelection(d),null!==g&&void 0!==g&&m>g&&(e.setCellRowSelection(g),f.startIndex=g,f.endIndex=null,j>g?i=g:g>k&&(i=g-l+1),null!==i&&h&&(o=b(PWC.Components.Grid.GetInstance.Scroll),o&&o.scrollVertical(i)),n(),I()),p=b(PWC.Components.Grid.GetInstance.Sort),p&&p.setSortKeyOnSelection()}},n=function(){var b=e.getCellRowSelection();a.model.enabled&&(a.tableProps.isPauseMode?(f.startIndex=b,a.model.useSelectedTitleColor&&(x(),y()),z(),B()):a.tableProps.isAutoSelectionEnabled&&a.tableProps.autoSelection&&a.model.selectionType!==PWC.Components.Grid.SelectionType.None&&(p(),o()))},o=function(){var b=a.dataMapper.getTotalRecords(),c=null;b>0&&(c=a.tableProps.autoScrollToLatest?b-1:0,e.addToSelection(c),e.setCellRowSelection(c),f.startIndex=c,f.endIndex=null,a.model.useSelectedTitleColor&&x())},p=function(){var a=q();null!==a&&a.length>0&&e.clearSelection()},q=function(){var b=e.getSelection(),c=b.length,d=a.dataMapper.getViewPortStartIndex(),f=[],g=a.dataMapper.getMaxRowsToDisplay(),h=null,i=0;for(i;c>i;i++)h=b[i],h>=d&&d+g>h&&f.push(h-d),h=null;return f},r=function(){var b=e.getCellColumnSelection(),c=e.getCellRowSelection(),d=a.dataMapper.getViewPortStartIndex(),f=a.dataMapper.getMaxRowsToDisplay(),g=null,h=null,i=0;if(null!==c&&c>=d&&d+f>c&&(g=c-d),void 0!==b&&null!==b)for(i;i<a.columns.length;i++)if(null!==a.columns[i].actualColumnIndex&&a.columns[i].actualColumnIndex===b){h=i;break}return{columnIndex:h,rowIndex:g}},s=function(){var a=q(),b=r(),c=b.columnIndex,d=b.rowIndex;null!==a&&a.length>0&&(v(a),t(a)),null!==d&&-1===a.indexOf(d)&&(v([d]),t([d])),null!==c&&u(c),w()},t=function(c){if(a.model.rowTitles){var d=0,e=null,f=null,g=null,h={fill:a.model.titleColor,forecolor:a.model.titleForeColor};if(e=b(PWC.Components.Grid.GetInstance.RowHeader,null))for(d;d<c.length;d++)g=c[d],a.model.columnTitles&&g++,f=e.getChild(g),a.utils.updateCell(f,h)}},u=function(c){var d={fill:a.model.titleColor,forecolor:a.model.titleForeColor},e=null,f=null;a.model.columnTitles&&null!==c&&(e=b(PWC.Components.Grid.GetInstance.Column,null),e&&(f=e.getChild(c),a.utils.updateCell(f,d)))},v=function(c){var d,e,f=0,g=0,h=null,i=null,j={fill:a.model.tableColor,forecolor:a.model.tableForeColor,fillOpacity:1,imageFilter:"none",fontStrikeOut:"inherit"},k=null,l=null;for(k=b(PWC.Components.Grid.GetInstance.DataRow,null),f=0;f<c.length;f++){if(i=c[f],d=k.getChild(i))for(g=0;g<d.childNodes.length;g++)"autocomplete"!==a.columns[g].columnDataType&&(l=a.dataMapper.getDataIndex(i),e=a.iGridRef.getCellStyle(l,a.columns[g].actualColumnIndex),h=a.iGridRef.getRowFlashInfo(l),a.setCellStyleOverrideEnabled(j,i,g,e,h),a.utils.updateCell(d.childNodes[g],j),j.fillOpacity=1,j.imageFilter="none",j.fontStrikeOut="inherit");i=null,l=null}},w=function(){for(;c.firstChild;)c.removeChild(c.firstChild)},x=function(){var c=0,d=null,e=q(),f=e.length,g=null,h=null,i=null;if(g=b(PWC.Components.Grid.GetInstance.RowHeader,null),a.model.rowTitles&&f>0)for(i=j(),c;f>c;c++)d=e[c],a.model.columnTitles&&(d+=1),h=g.getChild(d),a.utils.updateCell(h,i)},y=function(){var c=r(),d=null,e=null;if(d=b(PWC.Components.Grid.GetInstance.Column,null),a.model.columnTitles&&null!==c.columnIndex){var f=j();d&&(e=d.getChild(c.columnIndex),a.utils.updateCell(e,f))}},z=function(){var c,d,e=q(),f=e.length,j=r(),k=j.columnIndex,l=j.rowIndex,m=0,n=0,o=g(),p=null,s={},t={},u=null,v={fill:a.model.tableColor,forecolor:a.model.tableForeColor,fillOpacity:1,imageFilter:"none",fontStrikeOut:"inherit"},w={fill:null,forecolor:null};if(u=b(PWC.Components.Grid.GetInstance.DataRow,null),o.selectionColoring!==PWC.Components.Grid.TableSelectionColoring.None){if(s=h(),t=i(),w.fill=t.fill,w.forecolor=t.forecolor,null!==e&&f>0)for(m;f>m;m++)if(p=u.getChild(e[m]))for(n=0;n<p.childNodes.length;n++)"autocomplete"!==a.columns[n].columnDataType&&(o.selectionColoring===PWC.Components.Grid.TableSelectionColoring.Row||o.selectionColoring===PWC.Components.Grid.TableSelectionColoring.CellAndRow)&&(c=a.dataMapper.getDataIndex(e[m]),d=a.iGridRef.getCellStyle(c,a.columns[n].actualColumnIndex),o.autoSelectionColors?(a.setCellStyleOverrideEnabled(v,e[m],n,d,null),t.fill=a.utils.getExcelColorForRow(v.fill),t.forecolor=v.forecolor):(d&&d.fontStrikeOut&&(v.fontStrikeOut="line-through",a.model.tableFontUnderline&&(v.fontStrikeOut+=" underline")),t.fill=w.fill,t.forecolor=w.forecolor),t.fontStrikeOut=v.fontStrikeOut,a.isCellFlashEnabled(e[m],n)&&A(n,t),a.utils.updateCell(p.childNodes[n],t),v.fillOpacity=1,v.imageFilter="none",v.fontStrikeOut="inherit");(o.selectionColoring===PWC.Components.Grid.TableSelectionColoring.Cell||o.selectionColoring===PWC.Components.Grid.TableSelectionColoring.CellAndRow)&&null!==k&&null!==l&&"autocomplete"!==a.columns[k].columnDataType&&(c=a.dataMapper.getDataIndex(l),d=a.iGridRef.getCellStyle(c,a.columns[k].actualColumnIndex),o.autoSelectionColors?(a.setCellStyleOverrideEnabled(v,l,k,d,null),s.fill=a.utils.getExcelColorForCell(v.fill),s.forecolor=v.forecolor):d&&d.fontStrikeOut&&(v.fontStrikeOut="line-through",a.model.tableFontUnderline&&(v.fontStrikeOut+=" underline")),s.fontStrikeOut=v.fontStrikeOut,a.isCellFlashEnabled(l,k)&&A(k,s),a.utils.updateCell(u.getChild(l).childNodes[k],s))}},A=function(b,c){var d,e=a.columns[b].flashingType;e===PWC.Components.Grid.FlashingTypes.ChangeBackgroundColor_TextColor?(d=c.fill,c.fill=c.forecolor,c.forecolor=d):e===PWC.Components.Grid.FlashingTypes.ChangeMessageColor_TableColor&&(c.fill=c.forecolor=null)},B=function(){var b={strokeWidth:null,stroke:null,fill:"none","pointer-events":"none"},c=a.model.selectionRect;c===PWC.Components.Grid.SelectionRect.None||a.model.gridColumns.length<=0||(b.strokeWidth=a.model.selectionRectWidth,b.stroke=a.model.autoSelectionRectColor?d:a.model.selectionRectColor,c===PWC.Components.Grid.SelectionRect.Cell?C(b):c===PWC.Components.Grid.SelectionRect.Row&&D(b))},C=function(b){var d=r(),e=d.columnIndex,f=d.rowIndex,g={x:0,y:0,width:0,height:0};null!==e&&null!==f&&(g.x=a.columns[e].x,g.y=f*a.tableProps.cellHeight+a.tableProps.y+a.getHeaderHeight(),g.height=a.tableProps.cellHeight,g.width=a.columns[e].width,g.height+=b.strokeWidth+a.model.gridLineWidth,g.width+=b.strokeWidth+a.model.gridLineWidth,g.x=g.x-a.model.gridLineWidth-b.strokeWidth/2,g.y=g.y-a.model.gridLineWidth-b.strokeWidth/2,c.appendChild(a.utils.createSVG("rect",g,null,b)))},D=function(a){var b=q(),c=null,d=null,e=0;if(b.length>0){for(b=b.sort(function(a,b){return a-b}),c=b[0],d=b[0],e=1;e<b.length;e++)b[e]===d+1?d=b[e]:(E(a,c,d),c=b[e],d=b[e]);E(a,c,d)}},E=function(b,d,e){var f={x:0,y:0,width:0,height:0},g=e-d+1;f.x=a.tableProps.x+a.getRowHeaderWidth(),f.y=d*a.tableProps.cellHeight+a.tableProps.y+a.getHeaderHeight(),f.height=g*a.tableProps.cellHeight,f.width=a.getTotalColumnWidth(),f.height+=b.strokeWidth+a.model.gridLineWidth,f.width+=b.strokeWidth+a.model.gridLineWidth,f.x=f.x-a.model.gridLineWidth-b.strokeWidth/2,f.y=f.y-a.model.gridLineWidth-b.strokeWidth/2,c.appendChild(a.utils.createSVG("rect",f,null,b))},F=function(){c||(c=a.utils.createSVG("g",{id:a.id+"_SelectionRectGroup"}),a.utils.setSVGAttribute(c,"clip-path","url(#"+a.clipPath.id+")"),a.parentGroup.appendChild(c))},G=function(){a.model.autoSelectionRectColor&&(d=a.utils.getExcelColorForRow(a.model.selectionRectColor))},H=function(c){if(a.tableProps.isPauseMode){var d,f,g=null,h=a.dataMapper.getTotalRecords(),i=null,j=null,k=null,l=null,n=null;if(e&&(g=e.getCellRowSelection(),i=e.getCellColumnSelection()),38===c.keyCode||40===c.keyCode)c.preventDefault(),f=b(PWC.Components.Grid.GetInstance.Edit),f&&f.endEdit(),null!==g?g>0&&38===c.keyCode?g--:h-1>g&&40===c.keyCode&&g++:g=0,m([g],i,g,!0);else if(39===c.keyCode||37===c.keyCode){if(n=b(PWC.Components.Grid.GetInstance.Scroll),f=b(PWC.Components.Grid.GetInstance.Edit),f&&f.endEdit(),null!==i&&39===c.keyCode&&i<a.model.gridColumns.length-1){if(i++,a.columns[a.columns.length-1].actualColumnIndex===i-1)j=a.columns.length-1;else for(d=0;d<a.columns.length;d++)if(a.columns[d].actualColumnIndex===i){j=d;break}null!==j&&(k=a.columns[j].x+a.columns[j].width,l=a.tableProps.x+a.tableProps.width,k>l&&n&&n.scrollHorizontal(PWC.Components.Grid.ArrowKeySelection.MoveColumnToLeft,i))}else if(null===i&&39===c.keyCode)i=0,n&&n.scrollHorizontal(PWC.Components.Grid.ArrowKeySelection.MoveColumnToFirst);else if(null!==i&&37===c.keyCode&&i>0){for(d=0;d<a.columns.length;d++)if("autocomplete"!==a.columns[d].columnDataType&&a.columns[d].actualColumnIndex===i){j=d;break}i--,0===j&&n&&n.scrollHorizontal(PWC.Components.Grid.ArrowKeySelection.MoveColumnToRight)}m([g],i,g,!1)}}},I=function(){if(a.dataMapper.getViewPortDisplayedRowCount()>0){var b=l();a.iGridRef.onSelection(b)}},J=function(b){var c=null,d=a.eventReference.targetGroup,g=a.getCellPosition(b);if(c=a.dataMapper.getDataIndex(g.cellRowIndex),a.model.columnTitles&&c>0&&(c-=1),a.tableProps.isRecordLevelSelection&&d!==PWC.Components.Grid.EventSource.ColumnTitles&&a.model.selectionType!==PWC.Components.Grid.SelectionType.None&&a.iGridRef.onSelectionBegin(c,b.ctrlKey,b.shiftKey),a.model.columnTitles&&d===PWC.Components.Grid.EventSource.RowTitles&&0===g.cellRowIndex)return void(a.model.selectionType===PWC.Components.Grid.SelectionType.Multi&&Q());if(!(d===PWC.Components.Grid.EventSource.ColumnTitles&&a.isAutoCompleteCell(g.cellColumnIndex,null)||d!==PWC.Components.Grid.EventSource.ColumnTitles&&a.isAutoCompleteCell(g.cellColumnIndex,c))){if(s(),null!==g.cellColumnIndex&&(a.model.selectionType===PWC.Components.Grid.SelectionType.Multi&&b.shiftKey||e.setCellColumnSelection(a.columns[g.cellColumnIndex].actualColumnIndex)),d!==PWC.Components.Grid.EventSource.ColumnTitles&&(a.model.selectionType===PWC.Components.Grid.SelectionType.Multi&&b.shiftKey||(e.setCellRowSelection(c),f.startIndex=c,f.endIndex=null),a.model.selectionType!==PWC.Components.Grid.SelectionType.None))if(b.ctrlKey||b.shiftKey){if(a.model.selectionType===PWC.Components.Grid.SelectionType.Multi)if(b.ctrlKey)e.isSelected(c)?e.removeFromSelection(c):e.addToSelection(c);else if(b.shiftKey){if(null===f.startIndex)return n(),void I();K(c)}a.model.selectionType===PWC.Components.Grid.SelectionType.Single&&(e.clearSelection(),e.setSelection([c]))}else e.clearSelection(),e.setSelection([c]);n(),I(),d!==PWC.Components.Grid.EventSource.ColumnTitles&&(a.eventReference.startIndex=c,a.eventReference.endIndex=c)}},K=function(a){var b=null,c=null,d=null,g=null,h=null,i=0;for(null!==f.endIndex&&f.endIndex!==a&&(h=f.endIndex),f.endIndex=a,b=Math.min(f.startIndex,f.endIndex),c=Math.max(f.startIndex,f.endIndex),null!==h?(d=Math.min(b,h),g=Math.max(c,h)):(d=b,g=c),i=d;g>=i;i++)i>=b&&c>=i?e.isSelected(i)||e.addToSelection(i):e.removeFromSelection(i)},L=function(b){var c=a.getCellPosition(b);M(c)},M=function(b){var c=0,d=null,f=null,g=null,h=null,i=null,j=e.getCellColumnSelection(),k=null;if(null!==b.cellColumnIndex&&(k=a.columns[b.cellColumnIndex].actualColumnIndex),i=a.dataMapper.getDataIndex(b.cellRowIndex),a.model.columnTitles&&(i-=1),!(a.isAutoCompleteCell(b.cellColumnIndex,i)||a.eventReference.endIndex===i&&j===k)){if(s(),a.model.selectionType!==PWC.Components.Grid.SelectionType.Multi)null!==b.cellColumnIndex&&e.setCellColumnSelection(a.columns[b.cellColumnIndex].actualColumnIndex),e.setCellRowSelection(i),a.model.selectionType===PWC.Components.Grid.SelectionType.Single&&(e.clearSelection(),e.setSelection([i])),a.eventReference.endIndex=i,a.eventReference.startIndex=i;else if(null!==i&&null!==a.eventReference.startIndex){for(g=Math.min(a.eventReference.startIndex,i),h=Math.max(a.eventReference.startIndex,i),d=Math.min(g,a.eventReference.endIndex),f=Math.max(h,a.eventReference.endIndex),c=d;f>=c;c++)c>=g&&h>=c?e.isSelected(c)||e.addToSelection(c):e.removeFromSelection(c);a.eventReference.endIndex=i}n(),I()}},N=function(){e.clearAll(),f.startIndex=null,f.endIndex=null},O=function(){e=new PWC.Components.Grid.SelectionInfo},P=function(a){e=a},Q=function(){var b=0,c=a.dataMapper.getTotalRecords();for(s(),b;c>b;b++)e.isSelected(b)||e.addToSelection(b);n()},R=function(){c=null,d=null,e=null,f.startIndex=null,f.endIndex=null};return{createSelectionRectGroup:F,resetSelectionInfo:k,getSelection:l,setSelection:m,applySelection:n,clearPrevSelection:s,clearSelectionRects:w,selectionKeyNavigation:H,setAutoSelectionColors:G,selectionClickHandler:J,selectionDragHandler:L,fireSelection:I,clearSelectionInfo:N,enableRowLevelSelection:O,enableRecordLevelSelection:P,dragAutoSelection:M,clearData:R}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.SortHandler=function(a,b){"use strict";var c=[],d=null,e=null,f=.4,g=null,h=2,i=function(){var d=b(PWC.Components.Grid.GetInstance.Scroll,null),e=null,f=0,h=null,i=null,k=null,m=null;if(A(),d&&(e=d.getVScrollBarConfig(),e&&e.visible&&a.model.columnTitles&&a.model.useSortKey&&(g=e.width,y(e))),a.tableProps.isPauseMode){for(c.length=0,m=a.model.gridColumns.length,f=0;m>f;f++)a.model.gridColumns[f].sortOrder!==PWC.Components.Grid.TableSortOrder.None&&(k=a.getViewportColumnIndex(f),c.push({sortIndex:a.model.gridColumns[f].sortIndex,actualColumnIndex:f}),null!==k&&j(k));h=b(PWC.Components.Grid.GetInstance.Selection,null),k=null,h&&(i=h.getSelection().selectedCellColumnIndex,k=a.getViewportColumnIndex(i),null!==k&&l(k))}},j=function(b){var c,d=null,e=a.utils.getCellConfig(),f=0,g=null,i=null,j=null;(a.model.showSortIndex||a.model.showSortIcon)&&(d=a.columns[b].sortIndex.toString(),i=a.columns[b].sortOrder,j=w(i),c=a.utils.createSVG("g",{id:"sortGroup"}),e.y=a.tableProps.y,e.width=d.length*a.tableProps.titleWidthFactor+h,e.height=a.tableProps.contentHeight,e.dy=a.getTextOffsetdy(PWC.Components.Grid.CellType.ColumnHeader),e.dx=h,e.textContent=a.columns[b].sortIndex,e.forecolor="black",e.imageSize=a.getImageSize(),e.contentHeight=a.tableProps.contentHeight,e.x=a.columns[b].x+a.columns[b].width-a.model.gridLineWidth,a.model.showSortIndex&&(f=f+e.width+h,e.x=e.x-e.width-h,a.utils.renderText(c,e,a.model.gridLineWidth)),a.model.showSortIcon&&"string"==typeof j&&(e.imageUrl=j,e.x=e.x-e.imageSize,f+=e.imageSize,a.utils.renderImage(c,e)),g=m(b),g&&(g.appendChild(c),B(g,b,f)))},k=function(){if(e){var a,b=e.childNodes.length;if(b>1)for(a=b-1;a>=0;a--)if("image"===e.childNodes[a].tagName){e.removeChild(e.childNodes[a]);break}}},l=function(b){var c,d=null,f=a.utils.getCellConfig();e&&(k(),null!==b&&(d=a.columns[b].sortOrder,c=w(d),null!==c&&(f.imageUrl=c,f.x=a.tableProps.x+a.tableProps.width-g+h,f.y=a.tableProps.y,f.imageSize=a.getImageSize(),f.contentHeight=a.tableProps.contentHeight,a.utils.renderImage(e,f))))},m=function(a){var c=null,d=b(PWC.Components.Grid.GetInstance.Column,null);return d&&(c=d.getChild(a)),c},n=function(b){var c=null,d=null;d=a.getCellPosition(b),c=d.cellColumnIndex,a.tableProps.isCustomSortingEnabled||a.model.sortMode!==PWC.Components.Grid.TableSortMode.ByClick&&a.model.sortMode!==PWC.Components.Grid.TableSortMode.ByDoubleClick||(p(c),l(c)),o(c)},o=function(b){var c=null,d=null,e=null;null!==b&&a.isSubscribedEvent(PWC.Components.Grid.ControlEvents.OnSortButtonClicked)&&(e=a.columns[b].actualColumnIndex,a.tableProps.isCustomSortingEnabled||(c=a.columns[b].sortIndex,d=a.columns[b].sortOrder),a.iGridRef.onSortButtonClicked(e,c,d))},p=function(a){q(a)},q=function(b){var d=null,e=null,f=null;if(a.model.columnTitles&&b<a.columns.length&&"autocomplete"!==a.columns[b].columnDataType)if(e=a.columns[b],f=e.actualColumnIndex,a.model.sortSequence===PWC.Components.Grid.TableSortSequence.AscDescNone)switch(e.sortOrder){case PWC.Components.Grid.TableSortOrder.None:c.push({sortIndex:null,actualColumnIndex:f}),a.model.gridColumns[f].sortIndex=e.sortIndex=c.length,c[c.length-1].sortIndex=e.sortIndex,a.model.gridColumns[f].sortOrder=e.sortOrder=PWC.Components.Grid.TableSortOrder.Ascending,j(b);break;case PWC.Components.Grid.TableSortOrder.Ascending:a.model.gridColumns[f].sortOrder=e.sortOrder=PWC.Components.Grid.TableSortOrder.Descending,d=w(e.sortOrder),t(b,d,null);break;case PWC.Components.Grid.TableSortOrder.Descending:a.model.gridColumns[f].sortOrder=e.sortOrder=PWC.Components.Grid.TableSortOrder.None,u(b,f)}else if(a.model.sortSequence===PWC.Components.Grid.TableSortSequence.AscDesc)switch(e.sortOrder){case PWC.Components.Grid.TableSortOrder.None:r(f,b,null);break;case PWC.Components.Grid.TableSortOrder.Ascending:c.length>1?r(f,b,e.sortOrder):(a.model.gridColumns[f].sortOrder=e.sortOrder=PWC.Components.Grid.TableSortOrder.Descending,d=w(e.sortOrder)),t(b,d,null);break;case PWC.Components.Grid.TableSortOrder.Descending:c.length>1?r(f,b,e.sortOrder):(a.model.gridColumns[f].sortOrder=e.sortOrder=PWC.Components.Grid.TableSortOrder.Ascending,d=w(e.sortOrder)),t(b,d,null)}},r=function(b,d,e){var f=null;s(),c.push({sortIndex:null,actualColumnIndex:b}),a.model.gridColumns[b].sortIndex=a.columns[d].sortIndex=c.length,c[c.length-1].sortIndex=a.columns[d].sortIndex,null!==e?e===PWC.Components.Grid.TableSortOrder.Descending?(a.model.gridColumns[b].sortOrder=a.columns[d].sortOrder=PWC.Components.Grid.TableSortOrder.Ascending,f=w(a.columns[d].sortOrder)):(a.model.gridColumns[b].sortOrder=a.columns[d].sortOrder=PWC.Components.Grid.TableSortOrder.Descending,f=w(a.columns[d].sortOrder)):a.model.gridColumns[b].sortOrder=a.columns[d].sortOrder=PWC.Components.Grid.TableSortOrder.Ascending,j(d)},s=function(){for(var b=null,d=null,e=c.length;e>0;)d=null,b=c[e-1].actualColumnIndex,d=a.getViewportColumnIndex(b),u(d,b),e--;c.length=0},t=function(b,c,d){var e,f=null,g=null;if((a.model.showSortIcon||a.model.showSortIndex)&&(f=m(b),f&&(g=f.querySelector("g"))))for(e=0;e<g.childNodes.length;e++)"image"===g.childNodes[e].tagName&&null!==c&&a.utils.setSVGAttribute(g.childNodes[e],"href",c),"text"===g.childNodes[e].tagName&&null!==d&&(g.childNodes[e].textContent=d)},u=function(b,d){var e,f=0,g=null,h=null;for(f;f<c.length;f++)if(c[f].actualColumnIndex===d){e=f;break}for(f=0;f<c.length;f++)c[f].sortIndex>c[e].sortIndex&&(g=c[f].actualColumnIndex,"number"==typeof g&&(h=a.getViewportColumnIndex(g),null!==h?(a.model.gridColumns[g].sortIndex=a.columns[h].sortIndex=a.columns[h].sortIndex-1,t(h,null,a.columns[h].sortIndex)):a.model.gridColumns[g]&&(a.model.gridColumns[g].sortIndex=a.model.gridColumns[g].sortIndex-1),c[f].sortIndex=c[f].sortIndex-1));c.splice(e,1),null!==d&&(a.model.gridColumns[d].sortIndex=0,a.model.gridColumns[d].sortOrder=PWC.Components.Grid.TableSortOrder.None),null!==b&&(a.columns[b].sortIndex=0,a.columns[b].sortOrder=PWC.Components.Grid.TableSortOrder.None,v(b))},v=function(a){var b=null,c=m(a);c&&(b=c.querySelector("g"),null!==b&&c.removeChild(b),B(c,a,0))},w=function(b){var c=null;return b!==PWC.Components.Grid.TableSortOrder.None&&(b===PWC.Components.Grid.TableSortOrder.Ascending?c=a.model.sortUpImageURL:b===PWC.Components.Grid.TableSortOrder.Descending&&(c=a.model.sortDownImageURL)),c},x=function(){var b=a.tableProps.contentHeight;return a.model.columnTitles&&a.tableProps.isFilterEnabled&&(b+=a.filterColumnProps.height+a.model.gridLineWidth),b},y=function(b){var c=a.utils.getCellConfig();c.y=a.tableProps.y,c.x=a.tableProps.x+a.tableProps.width-g,c.width=g,c.height=x(),c.fill=a.model.titleColor,c.contentHeight=a.tableProps.contentHeight,e=a.createEmptyCell(c),d.appendChild(e),z(b)},z=function(){var b=null,c={x1:0,x2:0,y1:0,y2:0,stroke:"#000000","stroke-width":f};c.x1=a.tableProps.x+a.tableProps.width-g,c.x2=c.x1,c.y1=a.tableProps.y,c.y2=c.y1+x(),b=a.utils.createSVG("line",c,null,{pointerEvents:"none"}),d.appendChild(b),c.x1=a.tableProps.x+a.tableProps.width-g,c.x2=c.x1+g,c.y1=c.y1+x(),c.y2=c.y1,b=a.utils.createSVG("line",c,null,{pointerEvents:"none"}),d.appendChild(b)},A=function(){d||(d=a.utils.createSVG("g"),a.parentGroup.appendChild(d))},B=function(b,c,d){var e=a.columns[c],f={},g=a.columns[c].actualColumnIndex,h=null;f.x=e.x,f.width=a.columns[c].width,f.height=a.tableProps.cellHeight,f.contentHeight=a.tableProps.contentHeight,f.imageSize=a.getImageSize(),f.alignment=a.model.columnTitleAlignment===PWC.Components.Grid.HorizantalAlignment.JustifiedToContent?a.columns[c].alignment:a.model.columnTitleAlignment,"number"==typeof g&&(h=a.model.gridColumns[g]),a.setContentAlignment(f,f.alignment,d),f.textContent=a.shortenTextContent(a.columns[c].columnName,a.columns[c].width,f.alignment,a.model.shortenTitleContent,d,PWC.Components.Grid.CellType.ColumnHeader),a.utils.updateCell(b,f)},C=function(){d&&a.utils.clearElement(d)},D=function(c){var d=b(PWC.Components.Grid.GetInstance.Selection,null),e=null,f=null;a.eventReference.targetGroup=PWC.Components.Grid.EventSource.SortKey,d&&(e=d.getSelection().selectedCellColumnIndex,f=a.getViewportColumnIndex(e),null===f||a.tableProps.isCustomSortingEnabled||(q(f),l(f))),("singletap"===c.type||"doubletap"===c.type)&&a.clearEventReferences(),o(f)},E=function(){var c=null,d=null,f=null;e&&(c=b(PWC.Components.Grid.GetInstance.Selection,null),c&&(d=c.getSelection().selectedCellColumnIndex,f=a.getViewportColumnIndex(d),l(f)))},F=function(){c.length=0,d=null,e=null,g=null};return{handleColumnSortGroup:i,onsortHandler:n,clearGroup:C,setSortKeyOnSelection:E,sortKeyGroupEventListner:D,clearData:F}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.ToolTip=function(a,b){"use strict";var c=null,d=function(){c&&(a.parentGroup.removeChild(c),c=null)},e=function(c,d,e,f,g){var h,i,j,k,l=!1,m=!1,n=null,o=null,p={},q=!1,r=!1;n=b(PWC.Components.Grid.GetInstance.Selection),n&&(o=n.getSelection(),g===PWC.Components.Grid.CellType.ColumnHeader&&a.model.useSelectedTitleColor?d===o.selectedCellColumnIndex&&(f.fill=a.model.selectedTitleColor,f.forecolor=a.model.selectedTitleForeColor):g===PWC.Components.Grid.CellType.DataRow&&(d===o.selectedCellColumnIndex&&c===o.selectedCellRowIndex?l=!0:-1!==o.rowSelection.indexOf(c)&&(m=!0),(l||m)&&(j=a.dataMapper.getRowIndex(c),l?a.model.autoSelectionColors?(p=a.iGridRef.getCellStyle(c,d),q=!0,i=a.utils.getExcelColorForCell):(p.fill=a.model.selectedCellColor,p.forecolor=a.model.selectedCellForeColor):a.model.autoSelectionColors?(p=a.iGridRef.getCellStyle(c,d),q=!0,i=a.utils.getExcelColorForRow):(p.fill=a.model.selectedRowColor,p.forecolor=a.model.selectedRowForeColor),h=a.iGridRef.getRowFlashInfo(c),a.setCellStyleOverrideEnabled(f,j,e,p,h),k=a.columns[e].flashingType,a.isCellFlashEnabled(j,e)&&(k===PWC.Components.Grid.FlashingTypes.ChangeMessageColor_TableColor?q=!1:q&&k===PWC.Components.Grid.FlashingTypes.ChangeBackgroundColor_TextColor&&(r=!0)),q&&"function"==typeof i&&(r?f.forecolor=i(f.forecolor):f.fill=i(f.fill)))))
},f=function(b,c){var d=null,f=0;return a.isAutoCompleteCell(b.cellColumnIndex,null)||(d=a.columns[b.cellColumnIndex].actualColumnIndex,c.textContent=a.model.gridColumns[d].displayName,c.y=a.tableProps.y),null!==c.textContent&&(c.fill=a.model.titleColor,c.forecolor=a.model.titleForeColor,f=a.getTextBBoxInfo(PWC.Components.Grid.CellType.ColumnHeader,c.textContent).contentWidth,c.dy=a.getTextOffsetdy(PWC.Components.Grid.CellType.ColumnHeader),a.tableProps.isPauseMode&&e(null,d,b.cellColumnIndex,c,PWC.Components.Grid.CellType.ColumnHeader)),f},g=function(b,c){var d,f=null,g=null,h=null,i=0,j=null;return a.model.columnTitles&&b.cellRowIndex>0&&(b.cellRowIndex=b.cellRowIndex-1),h=a.dataMapper.getDataIndex(b.cellRowIndex),a.isAutoCompleteCell(b.cellColumnIndex,h)||(j=a.columns[b.cellColumnIndex].actualColumnIndex,f=a.getCellData(h,j),c.textContent=f.value,g=f.style,a.columns[b.cellColumnIndex].columnDataType===PWC.Components.Grid.ColumnDataType.Image&&(c.textContent=f.value.split("|")[1]),null!==c.textContent&&(c.y=a.tableProps.y+a.getHeaderHeight()+a.tableProps.cellHeight*b.cellRowIndex,d=a.iGridRef.getRowFlashInfo(h),a.setCellStyleOverrideEnabled(c,b.cellRowIndex,b.cellColumnIndex,g,d),i=a.getTextBBoxInfo(PWC.Components.Grid.CellType.DataRow,c.textContent).contentWidth,c.dy=a.getTextOffsetdy(PWC.Components.Grid.CellType.DataRow),a.tableProps.isPauseMode&&e(h,j,b.cellColumnIndex,c,PWC.Components.Grid.CellType.DataRow))),i},h=function(e){var h=null,j=null,k=0,l=0,m=null,n=a.utils.getCellConfig(),o=null;if(n.imageSize=a.getImageSize(),n.contentHeight=a.tableProps.contentHeight,h=a.getCellPosition(e),a.model.columnTitles&&0===h.cellRowIndex?(o=a.utils.getTitleFontPropeties(a.model),k=f(h,n),h.cellRowIndex=null):(o=a.utils.getTableFontPropeties(a.model),k=g(h,n)),null!==n.textContent&&(j=b(PWC.Components.Grid.GetInstance.Scroll),k>a.getCellWidth(h.cellColumnIndex,j))){for(n.x=a.columns[h.cellColumnIndex].x,n.height=a.tableProps.contentHeight,n.dx=a.model.cellSpaceLeft,l=h.cellColumnIndex,k+=a.model.cellSpaceLeft,m=a.columns.length,l;m>l&&(n.width+=a.columns[l].width,!(n.width-a.model.gridLineWidth>k));l++);n.width=n.width-a.model.gridLineWidth,n.width<k&&(n.width=k),c&&d(),c=a.createEmptyCell(n,null,null),a.utils.setSVGStyles(c,o),a.utils.renderText(c,n,a.model.gridLineWidth),i(h.cellRowIndex,h.cellColumnIndex,n.width,a.model.tableGridLineColor),a.parentGroup.appendChild(c)}return e.preventDefault(),!1},i=function(b,d,e,f){var g={x:0,y:0,width:0,height:0},h={strokeWidth:null,stroke:null,fill:"none","pointer-events":"none"};h.strokeWidth=a.model.gridLineWidth,h.stroke=f,g.y=a.tableProps.y,null!==b&&(g.y=b*a.tableProps.cellHeight+a.getHeaderHeight()+a.model.borderWidth),null!==d&&(g.x=a.columns[d].x,g.height=a.tableProps.cellHeight,g.width=e+a.model.gridLineWidth,g.x=g.x-a.model.gridLineWidth/2,g.y=g.y-a.model.gridLineWidth/2,c.appendChild(a.utils.createSVG("rect",g,null,h)))},j=function(){c=null};return{clearTooltip:d,createRightClickGroup:h,clearData:j}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.CellData=function(){"use strict";this.value=null,this.style={fill:null,forecolor:null,fontStrikeOut:!1}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.DataMapper=function(){"use strict";var a=null,b=null,c=null,d=null,e=0,f=0,g=!1,h=0,i=function(a){f=a},j=function(){return f},k=function(a){h=a},l=function(){return h},m=function(b){a=b,q()},n=function(){return a},o=function(a){b=a,q()},p=function(){return b},q=function(){e=null!==a&&null!==b?b-a+1:0},r=function(){return e},s=function(c){var d=!1;return null!==a&&null!==b&&c>=a&&b>=c&&(d=!0),d},t=function(b){return null!==b?b-(null===a?0:a):null},u=function(b){return null!==b?b+(null===a?0:a):null},v=function(a){c=a},w=function(){return null===c?0:c},x=function(a){d=a},y=function(){return null===d?0:d},z=function(){var a=0;return f>0&&(a=g?f-1:f),a},A=function(a){g=a};return{setViewPortSize:i,getViewPortSize:j,setViewPortStartIndex:m,getViewPortStartIndex:n,setViewPortEndIndex:o,getViewPortEndIndex:p,getViewPortDisplayedRowCount:r,getColumnStartIndex:w,setColumnStartIndex:v,setColumnEndIndex:x,getColumnEndIndex:y,isRowDisplayed:s,getRowIndex:t,getDataIndex:u,setTotalRecords:k,getTotalRecords:l,getMaxRowsToDisplay:z,setSkipLastRow:A}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.EditAuthorization=function(){"use strict";this.authorize=!1,this.customDom=null,this.editElementType=null};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.HorizantalAlignment={Left:0,Center:1,Right:2,JustifiedToContent:3},PWC.Components.Grid.SelectionType={None:0,Single:1,Multi:2},PWC.Components.Grid.TableSelectionColoring={None:0,Cell:1,Row:2,CellAndRow:3},PWC.Components.Grid.SelectionRect={None:0,Cell:1,Row:2},PWC.Components.Grid.ControlEvents={OnSortButtonClicked:0,OnRowHeaderClick:1,OnColumnHeaderClick:2,OnCellClick:3,OnColumnHeaderDoubleClick:4,OnVScrollDownButtonClick:5,OnVScrollUpButtonClick:6,OnVScrollDragEnd:7,OnHScrollLeftButtonClick:8,OnHScrollRightButtonClick:9,OnHScrollDragEnd:10,OnCellEditBegin:11,OnCellEditEnd:12,OnColumnResize:13,OnCellDoubleClick:14,OnRowHeaderDoubleClick:15,OnFilterEditEnd:16,OnVScrollChange:17,OnMouseWheelScroll:18,OnHScrollChange:19},PWC.Components.Grid.ColumnDataType={Text:"text",Image:"image"},PWC.Components.Grid.ColumnAccess={ReadOnly:0,Disabled:1,Editable:2},PWC.Components.Grid.TableSortMode={None:0,ByClick:1,ByDoubleClick:2},PWC.Components.Grid.TableSortOrder={None:0,Ascending:1,Descending:2},PWC.Components.Grid.TableSortSequence={AscDescNone:0,AscDesc:1},PWC.Components.Grid.DataOperationType={Add:0,Update:1,Delete:2},PWC.Components.Grid.RecordInsertMode={Top:0,Bottom:1},PWC.Components.Grid.ScrollBarMode={No:0,OnDemand:1,Always:2},PWC.Components.Grid.FlashingTypes={Standard:0,ChangeBackgroundColor_TextColor:1,ChangeMessageColor_TableColor:2},PWC.Components.Grid.EventSource={RowTitles:0,ColumnTitles:1,Data:2,ColumnVlines:3,ScrollBar:4,SortKey:5},PWC.Components.Grid.GridActions={Partial_Load:0,Load:1,Reload:2},PWC.Components.Grid.GetInstance={Column:0,DataRow:1,RowHeader:2,Scroll:3,Selection:4,Sort:5,Edit:6},PWC.Components.Grid.ArrowKeySelection={MoveColumnToFirst:0,MoveColumnToLeft:1,MoveColumnToRight:2},PWC.Components.AppMode={UNKNOWN:0,RUNTIME:1,EDIT:2},PWC.Components.Grid.EditElementType={Standard:0,Custom:1},PWC.Components.Grid.CellType={ColumnHeader:0,RowHeader:1,DataRow:2};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.SelectionInfo=function(){var a=[],b=null,c=null,d=function(){a.length=0},e=function(b){var c=!1;return-1!==a.indexOf(b)&&(c=!0),c},f=function(b){var c=a.indexOf(b);return c},g=function(b){e(b)||a.push(b)},h=function(b){var c=f(b);-1!==c&&a.splice(c,1)},i=function(){return a.slice()},j=function(b){b.constructor===Array&&(a=b)},k=function(a){b=a},l=function(){return b},m=function(a){c=a},n=function(){return c},o=function(){a.length=0,c=null,b=null};return{clearSelection:d,clearAll:o,isSelected:e,addToSelection:g,removeFromSelection:h,getSelection:i,setSelection:j,setCellColumnSelection:k,getCellColumnSelection:l,setCellRowSelection:m,getCellRowSelection:n}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.GridUtils=function(){"use strict";var a="http://www.w3.org/2000/svg",b="http://www.w3.org/1999/xlink",c=null,d=function(b,c,d,g){var h,i;if(h=d?d.cloneNode(!0):document.createElementNS(a,b),c)for(i in c)null!==c[i]&&f(h,i,c[i]);return g&&e(h,g),h},e=function(a,b){var c=null;if(b)for(c in b)a.style[c]=b[c]},f=function(a,c,d){var e=null;"href"===c&&(e=b),a.setAttributeNS(e,c,d)},g=function(a,c){var d=null;return"href"===c&&(d=b),a.getAttributeNS(d,c)},h=function(a,b){var c=PWC.Lib.Canvas.Svg.getTextBBox(b,a),d={width:0,height:0};return null!==c&&(d.width=c.width,d.height=c.height),d},i=function(a,b,d,e){var f=0,g=0,h=a.length,i=null,j=null,k=null,l=null,m=a||"XY",n="...",o=null,p=null,q=null,r=null,s=null,t=null,u=null,v=PWC.Lib.Canvas.Svg.setTextSpanContent,w=PWC.Lib.Canvas.Svg.getSubStringLength;if(e&&(null===c&&(v(n),c=w(0,n.length)),b-=c),v(m),d===PWC.Components.Grid.HorizantalAlignment.Left||e){for(s=b>=w(0,Math.floor(.5*h))?Math.floor(b>=w(0,Math.floor(.75*h))?.75*h:.5*h):b>=w(0,Math.floor(.25*h))?Math.floor(.25*h):1,f=s;h>=f;f++){if(l=w(0,f),l===b){i=f;break}if(l>b){i=f-1;break}}o=0,p=i}else if(d===PWC.Components.Grid.HorizantalAlignment.Right){for(b>=w(Math.floor(.5*h),h-Math.floor(.5*h))?b>=w(Math.floor(.25*h),h-Math.floor(.25*h))?(s=h-Math.floor(.25*h),o=Math.floor(.25*h)):(s=h-Math.floor(.5*h),o=Math.floor(.5*h)):b>=w(Math.floor(.75*h),h-Math.floor(.75*h))?(s=h-Math.floor(.75*h),o=Math.floor(.75*h)):(o=h-1,s=1),f=o,g=s;f>=0;f--,g++){if(l=w(f,g),l===b){i=g;break}if(l>b){i=g-1;break}}o=h-i,p=h}else if(d===PWC.Components.Grid.HorizantalAlignment.Center){for(t=b/2,u=Math.round(h/2),w(0,u-1)<t&&(q=t-w(0,u-1)),w(u,h-u-1)<t&&(r=t-w(u,h-u)),f=u-1,g=1;f>=0;f--,g++){if(l=w(f,g),l===t+r){j=g;break}if(l>t+r){j=g-1;break}}for(o=u-1-j+1,null===j&&(j=g-1,o=0),f=u,g=1;h>f;f++,g++){if(l=w(u,g),l===t+q){k=g;break}if(l>t+q){k=g-1;break}}p=u+k-1,null===k&&(k=g-1,p=h-1),i=j+k}return{charLength:i,startIndex:o,endIndex:p}},j=function(a){var b=!1;return(void 0===a.gridColumns||null===a.gridColumns)&&(a.gridColumns=[]),a.gridColumns&&"object"==typeof a.gridColumns&&(b=!0,k(a)),b},k=function(a){var b=0,c=null;if(a.gridColumns)for(c=a.gridColumns.length,b=0;c>b;b++)"string"==typeof a.gridColumns[b].displayName&&(a.gridColumns[b].displayName=a.gridColumns[b].displayName.split(" ").join(" ")),a.gridColumns[b].width=Math.round(a.gridColumns[b].width)},l=function(a){var b=165/255,c=17,d=37,e=69,f=parseInt(a.substring(1,3),16),g=parseInt(a.substring(3,5),16),h=parseInt(a.substring(5),16);return f=f*b+c,g=g*b+d,h=h*b+e,"#"+f.toString(16).split(".")[0]+g.toString(16).split(".")[0]+h.toString(16).split(".")[0]},m=function(a){var b=l(a),c=parseInt(a.substring(1,3),16),d=parseInt(a.substring(3,5),16),e=parseInt(a.substring(5),16),f=parseInt(b.substring(1,3),16),g=parseInt(b.substring(3,5),16),h=parseInt(b.substring(5),16),i=(c+f)/2,j=(d+g)/2,k=(e+h)/2;return"#"+i.toString(16).split(".")[0]+j.toString(16).split(".")[0]+k.toString(16).split(".")[0]},n=function(){return{width:null,height:null,x:null,y:null,dx:null,dy:null,fill:null,fillOpacity:1,forecolor:null,textAnchor:"left",alignment:null,textContent:null,imageUrl:null,imageOffset:null,imageFilter:"none",textOffset:null,imageSize:null,contentHeight:null,id:null,fontStrikeOut:"inherit"}},o=function(a){var b={textDecoration:"none",fontStyle:"normal",fontSize:"12px",fontFamily:"Arial",fontWeight:"normal"};return a.titleFontUnderline&&a.titleFontStrikeOut?b.textDecoration="line-through underline":a.titleFontUnderline&&!a.titleFontStrikeOut?b.textDecoration="underline":!a.titleFontUnderline&&a.titleFontStrikeOut&&(b.textDecoration="line-through"),a.titleFontItalic&&(b.fontStyle="italic"),a.titleFontSize&&(b.fontSize=a.titleFontSize+"px"),a.titleFontName&&(b.fontFamily=a.titleFontName),a.titleFontBold&&(b.fontWeight="bold"),b},p=function(a){var b={textDecoration:"none",fontStyle:"normal",fontSize:"12px",fontFamily:"Arial",fontWeight:"normal"};return a.tableFontUnderline&&a.tableFontStrikeOut?b.textDecoration="line-through underline":a.tableFontUnderline&&!a.tableFontStrikeOut?b.textDecoration="underline":!a.tableFontUnderline&&a.tableFontStrikeOut&&(b.textDecoration="line-through"),a.tableFontItalic&&(b.fontStyle="italic"),a.tableFontSize&&(b.fontSize=a.tableFontSize+"px"),a.tableFontName&&(b.fontFamily=a.tableFontName),a.tableFontBold&&(b.fontWeight="bold"),b},q=function(a){return a%2===0?!0:!1},r=function(a,b,c){var d=null,e={widthFactor:null,contentHeight:null,contentWidth:null},f={FontSize:10,FontName:"Arial",FontBold:100,FontItalic:!1};return c===PWC.Components.Grid.CellType.DataRow?(f.FontSize=b.tableFontSize,f.FontName=b.tableFontName,f.FontBold=b.tableFontBold,f.FontItalic=b.tableFontItalic):(f.FontSize=b.titleFontSize,f.FontName=b.titleFontName,f.FontBold=b.titleFontBold,f.FontItalic=b.titleFontItalic),a||(a="d"),d=h(a,f),e.widthFactor=Math.floor(d.width/a.length),e.contentHeight=Math.ceil(d.height),e.contentWidth=Math.ceil(d.width),e},s=function(a,b,c){var g=d("text",{x:b.x,y:b.y,width:b.width-c,height:b.contentHeight,fill:b.forecolor,dx:(b.dx||0)+(b.textOffset||0),dy:b.dy||0,"text-anchor":b.textAnchor,"fill-opacity":b.fillOpacity});g.textContent=b.textContent,e(g,{pointerEvents:"none",textDecoration:"inherit"}),null!==b.id&&f(g,"clip-path","url(#"+b.id+")"),b.fontStrikeOut?e(g,{"text-decoration":b.fontStrikeOut}):e(g,{"text-decoration":"inherit"}),a.appendChild(g)},t=function(a,b){var c=null,g=null;g=b.y,b.imageSize&&b.contentHeight&&(g=b.y+b.contentHeight/2-b.imageSize/2),c=d("image",{x:b.x+(b.imageOffset||0),y:g,width:b.imageSize,height:b.imageSize,filter:b.imageFilter}),f(c,"href",b.imageUrl),e(c,{pointerEvents:"none"}),a.appendChild(c)},u=function(a,b){var c=null,d=null,g=0,h=null,i=null,j=!1,k=!1,l=!1,m=!1,n=!1,o=!1;if(void 0!==b.y&&null!==b.y&&(j=!0),b.fill&&(k=!0),void 0!==b.fillOpacity&&null!==b.fillOpacity&&(n=!0),b.forecolor&&(l=!0),void 0!==b.dx&&null!==b.dx&&(m=!0,i=b.dx),void 0!==b.textOffset&&null!==b.textOffset&&(i+=b.textOffset),void 0!==b.imageFilter&&null!==b.imageFilter&&(o=!0),a)for(d=a.childNodes.length,g;d>g;g++)c=a.childNodes[g],j&&f(c,"y",b.y),"rect"===c.tagName&&k?f(c,"fill",b.fill):"text"===c.tagName?(l&&f(c,"fill",b.forecolor),n&&f(c,"fill-opacity",b.fillOpacity),b.fontStrikeOut?e(c,{"text-decoration":b.fontStrikeOut}):e(c,{"text-decoration":"inherit"}),void 0!==b.textContent&&null!==b.textContent&&(c.textContent=b.textContent,m&&f(c,"dx",i))):"image"===c.tagName&&b.imageUrl&&(f(c,"href",b.imageUrl),null!==b.x&&void 0!==b.x&&null!==b.imageOffset&&void 0!==b.imageOffset&&f(c,"x",b.x+b.imageOffset),o&&f(c,"filter",b.imageFilter),j&&(h=b.y,b.imageSize&&b.contentHeight&&(h=b.y+b.contentHeight/2-b.imageSize/2,f(c,"y",h)))),c=null},v=function(a){if(a)for(;a.firstChild;)a.removeChild(a.firstChild)},w=function(){c=null},x=function(a,b,c,d){var e=b.getScreenCTM(),f=b.createSVGPoint(),g=null,h=navigator.appName,i=null,j=1;return c&&-1===h.indexOf("Microsoft")&&(g=b.getBoundingClientRect(),e.e=g.left,e.f=g.top),"function"==typeof d&&(j=d()),void 0!==a.clientX&&null!==a.clientX&&void 0!==a.clientY&&null!==a.clientY?i=a:a.changedPointers&&a.changedPointers.length>0?i=a.changedPointers[0]:a.touches&&a.touches.length>0&&(i=a.touches[0]),i&&(f.x=i.clientX,f.y=i.clientY,f=f.matrixTransform(e.inverse()),f.x=parseInt(f.x,10),f.y=parseInt(f.y,10),c&&-1===h.indexOf("Microsoft")&&0!==j&&(f.x=f.x/j,f.y=f.y/j)),f};return{createSVG:d,setSVGStyles:e,setSVGAttribute:f,getSVGAttribute:g,getBBoxDimensions:h,getVisibleStringInfo:i,getExcelColorForRow:l,getExcelColorForCell:m,getCellConfig:n,getTitleFontPropeties:o,getTableFontPropeties:p,getMousePoint:x,validateGridModel:j,validateColumnModel:k,isRowEven:q,calculateFontDimensions:r,renderText:s,renderImage:t,updateCell:u,clearElement:v,clearData:w}}();var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.GridColumnModel=function(){"use strict";this.name=null,this.index=0,this.visible=!0,this.sortOrder=PWC.Components.Grid.TableSortOrder.None,this.sortIndex=0,this.displayName=null,this.width=100,this.alignment=PWC.Components.Grid.HorizantalAlignment.Center,this.showIcon=!1,this.showText=!0,this.showTitleIcon=!1,this.showTitleText=!0,this.columnAcess=PWC.Components.Grid.ColumnAccess.ReadOnly,this.columnDataType=PWC.Components.Grid.ColumnDataType.Text,this.flashing=!1,this.flashingType=PWC.Components.Grid.FlashingTypes.Standard,this.useColoumnBackgroundColor=!0,this.useColumnForeColor=!0};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.GridModel=function(){"use strict";this.gridColumns=[],this.shortenTitleContent=!0,this.shortenCellContent=!0,this.cellSpaceLeft=3,this.cellSpaceTop=0,this.cellSpaceRight=3,this.cellSpaceBottom=0,this.iconSpace=3,this.selectionType=PWC.Components.Grid.SelectionType.Multi,this.selectionRect=PWC.Components.Grid.SelectionRect.Row,this.autoSelectionRectColor=!1,this.selectedCellColor="#C56A31",this.selectedRowColor="#C56A31",this.selectedRowForeColor="#FFFFFF",this.selectedCellForeColor="blue",this.selectionColoring=PWC.Components.Grid.TableSelectionColoring.CellAndRow,this.autoSelectionColors=!1,this.selectionRectColor="#000000",this.selectionRectWidth=1,this.height=350,this.width=1e3,this.left=0,this.top=0,this.tableFontBold=!1,this.tableFontItalic=!1,this.tableFontName="Calibri",this.tableFontSize=12,this.tableFontUnderline=!1,this.tableFontStrikeOut=!1,this.titleFontBold=!1,this.titleFontItalic=!1,this.titleFontName="Calibri",this.titleFontSize=12,this.tableColor="#ffffff",this.tableForeColor="#000000",this.tableColor2="rgb(182,182,182)",this.tableForeColor2="#000000",this.useTableColor2=!0,this.titleFontUnderline=!1,this.titleFontStrikeOut=!1,this.columnTitleAlignment=PWC.Components.Grid.HorizantalAlignment.Right,this.columnReorder=!1,this.columnResize=!0,this.horizontalGridLines=!0,this.verticalGridLines=!0,this.gridLineWidth=1,this.titleColor="rgb(239,235,222)",this.titleForeColor="#000000",this.autoCompleteColumns=!0,this.autoFit=!1,this.borderWidth=1,this.borderColor="#000000",this.rowTitleAlignment=PWC.Components.Grid.HorizantalAlignment.Center,this.autoCompleteRows=!0,this.columnTitles=!0,this.rowTitles=!0,this.tableGridLineColor="rgb(176,176,176)",this.titleGridLineColor="rgb(126,125,104)",this.table3D=!1,this.title3D=!0,this.tableDarkShadowColor="#99A8AC",this.tableLightShadowColor="#FFFFFF",this.titleDarkShadowColor="#99A8AC",this.titleLightShadowColor="#FFFFFF",this.selectedTitleColor="rgb(255,192,111)",this.selectedTitleForeColor="#000000",this.useSelectedTitleColor=!0,this.horizontalScrollbarMode=PWC.Components.Grid.ScrollBarMode.OnDemand,this.verticalScrollbarMode=PWC.Components.Grid.ScrollBarMode.Always,this.horizontalScrolling=!0,this.verticalScrolling=!0,this.sortMode=PWC.Components.Grid.TableSortMode.ByClick,this.sortSequence=PWC.Components.Grid.TableSortSequence.AscDescNone,this.showSortIcon=!0,this.showSortIndex=!0,this.useSortKey=!0,this.autoSize=!1,this.backgroundColor="#B9D3EE",this.visibleRowCount=80,this.sortUpImageURL="images/sort_up.png",this.sortDownImageURL="images/sort_down.png",this.filterImagURL="images/filter.png",this.enabled=!0,this.useColumnColors=!0};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.Grid=PWC.Components.Grid||{},PWC.Components.Grid.IGridHost=function(){var a=function(){},b=function(){},c=function(){},d=function(){},e=function(){},f=function(){},g=function(){},h=function(){},i=function(){},j=function(){},k=function(){},l=function(){},m=function(){},n=function(){},o=function(){},p=function(){},q=function(){},r=function(){},s=function(){},t=function(){},u=function(){},v=function(){},w=function(){},x=function(){},y=function(){},z=function(){};return{getCellData:a,getCellStyle:b,getRowFlashInfo:c,onVScrollUpButtonClick:u,OnVScrollChange:s,OnVScrollDragEnd:t,onVScrollDownButtonClick:r,onHScrollRightButtonClick:o,onHScrollLeftButtonClick:n,onHScrollDragEnd:m,onHScrollChange:z,onRowHeaderClick:j,onColumnHeaderClick:l,onColumnHeaderDoubleClick:x,onCellClick:g,onSelection:i,onSortButtonClicked:p,onCellEditEnd:f,onCellEditBegin:e,onCellDoubleClick:d,onViewportChange:q,onColumnResize:v,onRowHeaderDoubleClick:k,onSelectionBegin:h,onFilterTextChange:w,onMouseWheelScroll:y}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.TagBrowser=PWC.Components.TagBrowser||{},PWC.Components.TagBrowser.TagBrowserView=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=a,u=this,v=PWC.Components.TagBrowser,w=v.RequestType,x=v.ServerRequestParamIds,y=[],z=!1,A="\\",B=10,C=110,D=125,E=22,F=5,G=30,H=!1,I=t.gfxWebLib.textbib,J=PWC.Components.Grid.ColumnDataType,K="*",L=!1,M=0,N=v.SortingMode.Asc,O=function(){var a;c.style.width=g+"px",j.setAttribute("width",""+m+"px"),d&&d.setAttribute("y2",k),H&&p.setGridDims(k,m),p&&(a=p.resizeCalculations(),a&&u.requestDisplayData(a.NoOfRecords,w.ListView,a.CurrentStartIndex))},P=function(a,b,c,d){switch(a){case v.EventTypes.TreeViewImgClick:case v.EventTypes.TreeViewSpanClick:o=c,n=d,Y(b,c);break;case v.EventTypes.TreeNodeDoubleClick:Y(w.TreeView,c),Y(w.ListView,c),n=d,o=c}},Q=function(a,c,d){var e=[],f=[];switch(a){case v.EventTypes.DoubleClick:d&&(d===v.NodeTypes.TagGroup?(b.setDoubleClickSelectedNode(c),c=o+A+c,Y(w.TreeView,o),Y(w.ListView,c),o=c):d===v.NodeTypes.SimpleTag&&(e=[0],f=[c],t.gfxWebLib.connection.sendDomainLogicEvent(t.rtoid,4,e,f),t.gfxWebLib.connection.sendScreenItemDelete(t.rtoid)));break;case v.EventTypes.ScrollChange:u.requestDisplayData(d,w.ListView,c);break;case v.EventTypes.Sort:M=c,N=d,Y(w.ListView,r)}},R=function(){var a=PWC.HmiAC.HammerEvents;requirejs.config({baseUrl:"/libs",paths:{Hammer:"hammer-2.0.2"}}),require(["Hammer"],function(b){f=b,e=new f.Manager(d),e.add(new f.Pan({event:a.PAN,pointers:1,direction:f.DIRECTION_ALL,threshold:5})),PWC.HmiAC.svgShape.AddSvgEvents(d,{mousedown:U,mouseup:U,touchstart:U,touchend:U}),e.on(a.PAN,T)})},S=function(a){var b;return 0===g&&0>a||0===m&&a>0?!1:(b=a-u.panDeltaCoords.x,u.panDeltaCoords.x=a,g+=b,m-=b,0>g?(m+=g,g=0):0>m&&(g+=m,m=0),O(),!0)},T=function(a){a.preventDefault(),a.eventType===f.INPUT_MOVE?S(a.deltaX)||e.stop():a.eventType===f.INPUT_END&&(u.panDeltaCoords={x:0})},U=function(){u.panDeltaCoords.x=0},V=function(a,b){var c=null;return c=document.createElement("input"),c.setAttribute("type","button"),c.setAttribute("value",a),c.setAttribute("class","btnClass"),c.setAttribute("id",a+"Button"),b&&c.setAttribute("disabled","true"),c.addEventListener("click",W),c},W=function(a){var b,c,d,e,f=[],g=[];switch(void 0!==a&&(b=a.target||a.srcElement),c=b.value){case I.getText("TBID_AlgCtrl_Ok"):d=p.getSelectedRecord(),d?(f=[0],g=[d],t.gfxWebLib.connection.sendDomainLogicEvent(t.rtoid,4,f,g),t.gfxWebLib.connection.sendScreenItemDelete(t.rtoid)):X();break;case I.getText("TBID_AlgCtrl_Cancel"):t.gfxWebLib.connection.sendScreenItemDelete(t.rtoid)}e&&u.requestDisplayData(e.NoOfRecords,w.ListView,e.CurrentStartIndex)},X=function(){var a,b,c=t.gfxWebLib.topLevelScreenWindow.getTopLevelScreenWindowDiv(),d=document.createElement("div");c.appendChild(d),b=I.getText("TBID_TagBrowser_Warning_Msg"),a=I.getText("TBID_TagBrowser_Warning_Caption"),PWC.Components.GenericDialog.ShowWarning(b,d,a,function(){return!1})},Y=function(a,b){var c,d=[],e=[];r=b,c=a===w.ListView?v.BrowsingMode.BrowseBoth:v.BrowsingMode.BrowseNode,d=[x.GetObject,x.SystemID,x.ObjectType,x.SelectedNode,x.NameFilter,x.PropertyFilter,x.LanguageID,x.BrowsingMode,x.SortingMode,x.SortByAttribute],e=[v.BrowsingRequestIds.ServerData,s,v.ObjectType.All,b,K,,t.gfxWebLib.getLocale(),c,N,M],t.gfxWebLib.connection.sendDomainLogicEvent(t.rtoid,a,d,e)},Z=function(a){var b=a.wheelDelta,c=a.detail;(void 0!==a.wheelDelta||void 0!==a.detail)&&(b?this.scrollTop+=(0>b?1:-1)*G:c&&(this.scrollTop+=(c>0?1:-1)*G),a.preventDefault())},$=[{Index:"0",Name:I.getText("TBID_TagBrowser_Column_Name"),Width:C,ColType:J.Image,ShowIcon:!0},{Index:"1",Name:I.getText("TBID_TagBrowser_Column_Type"),Width:C,ColType:J.Text,ShowIcon:!1},{Index:"2",Name:I.getText("TBID_TagBrowser_Column_Parameter"),Width:C,ColType:J.Text,ShowIcon:!1},{Index:"3",Name:I.getText("TBID_TagBrowser_Column_Comment"),Width:C,ColType:J.Text,ShowIcon:!1},{Index:"4",Name:I.getText("TBID_TagBrowser_Column_LastModification"),Width:C,ColType:J.Text,ShowIcon:!1}],_=function(a){a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1};this.createTreeView=function(){z||(z=!0,c.onclick=_,b=new v.TagBrowseTreeView(y,P,t.gfxWebLib.connection.getAppDir()),b.initializeTreeView(c))},this.createWidthSeperator=function(){var a,b;a=PWC.HmiAC.svgShape.CreateSvgElement,b=a("svg",{id:"widthSVGParent_"+t.rtoid}),b.setAttribute("class","widthSVGParent"),b.setAttribute("style","float:left;"),d=a("line",{id:"widthSeperatorLine_"+t.rtoid,stroke:"grey","stroke-width":F+"px",appendTo:b}),PWC.HmiAC.svgShape.SetAttributes(d,{x1:"0",x2:"0",y1:"0",y2:k,cursor:"ew-resize"}),i.insertBefore(b,j),R()},this.panDeltaCoords={x:0},this.createOuterDivs=function(){k=u.height-D,l=u.width-E,i=document.createElement("div"),i.setAttribute("id","body_Div_"+t.rtoid),i.setAttribute("class","body_Div"),i.style.setProperty("height",""+k+"px"),i.style.setProperty("width",""+l+"px"),g=.35*(l-F),c=document.createElement("div"),c.setAttribute("id","treeViewDiv_"+t.rtoid),c.setAttribute("class","treeViewDiv"),c.style.setProperty("height","inherit"),c.style.setProperty("width",""+g+"px"),c.addEventListener("mousewheel",Z),c.addEventListener("DOMMouseScroll",Z),m=.63*(l-F),j=document.createElementNS("http://www.w3.org/2000/svg","svg"),j.setAttributeNS(null,"id","svgContainer_"+t.rtoid),j.setAttribute("height",""+k+"px"),j.setAttribute("width",""+m+"px"),i.appendChild(c),i.appendChild(j),h.appendChild(i),q=V(I.getText("TBID_AlgCtrl_Ok"),!0),h.appendChild(V(I.getText("TBID_AlgCtrl_Help"),!0)),h.appendChild(V(I.getText("TBID_AlgCtrl_Cancel"))),h.appendChild(q)},this.Hammer=null,this.renderTagGridData=function(a){p.renderTagGridData(a,L),L=!1},this.eventsHandler=function(a,c,d,e){var f;switch(c&&(f=c.target||c.srcElement),a){case v.EventTypes.DataSourceChange:f.checked?(o=e,s=d,Y(w.ListView,e)):(z=!1,b.clearTreeView(),p.unLoadGrid(),p.setScrollStatus(),H=!1,o=void 0);break;case v.EventTypes.DataSourceLoad:s=d,Y(w.ListView,e);break;case v.EventTypes.FilterChange:K=c.target.value,L=!0,Y(w.ListView,o)}},this.initialize=function(){var a=PWC.Lib.HmiTypes.Advanced.HmiWindow.ToolBar,b=PWC.Lib.Config.Properties;this.height=b.getProp(t,"Height"),this.width=b.getProp(t,"Width"),h=document.createElement("div"),h.setAttribute("id","resizableTagDialog_Div_"+t.rtoid),h.setAttribute("class","resizableTagDialog"),h.setAttribute("style","height:"+this.height+"px ; width:"+this.width+"px ;"),t.control.domParent.appendChild(h),a.enable(t,"Small Icons",!0),a.enable(t,"List",!0),a.enable(t,"Details",!0),a.check(t,"Details",!0),a.enable(t,"Up One Level",!1),a.enable(t,"Create New Tag",!1),a.enable(t,"Edit Tag",!1)},this.calculateViewPort=function(a){var b;b=p.calculateViewPort(a),void 0!==b?(q.removeAttribute("disabled"),u.requestDisplayData(b.NoOfRecords,w.ListView,b.CurrentStartIndex)):q.setAttribute("disabled","true")},this.requestDisplayData=function(a,b,c){var d=[],e=[];d=[x.RequestType,x.StartIndex,x.Count],void 0===c&&(c=0),e=[w.GetData,c,a],t.gfxWebLib.connection.sendDomainLogicEvent(t.rtoid,b,d,e)},this.modifyTreeView=function(a){b.modifyTreeView(a,n),n=void 0},this.assignInitialTreeData=function(a){o=a[0],y=[o]},this.onToolbarButton=function(a,b){var c,d,e=PWC.Lib.HmiTypes.Advanced.HmiWindow.ToolBar,f=!1,g=["Details","Small Icons","List"],h=a.props.Toolbar.ToolbarButtons;if(g.indexOf(b)>-1)for(d=0;d<h.length;d++)if(h[d].Name===b){f=h[d].Checked;break}if(!f)switch(b){case"Details":p.setViewChangedBool(!0),p.detailViewLayoutChange(),e.check(t,"Details",!0),e.check(t,"Small Icons",!1),e.check(t,"List",!1);break;case"Small Icons":p.setViewChangedBool(!0),p.smallIconGridLayoutChange(),e.check(t,"Small Icons",!0),e.check(t,"Details",!1),e.check(t,"List",!1);break;case"List":p.setViewChangedBool(!0),p.listViewGridLayoutChange(),e.check(t,"List",!0),e.check(t,"Details",!1),e.check(t,"Small Icons",!1)}c=p.requestRequiredData(),u.requestDisplayData(c.NoOfRecords,w.ListView,c.CurrentStartIndex)},this.createTagGridLayout=function(){p=new v.TagBrowserGridView(Q,I,j,t.gfxWebLib.connection.getAppDir()),H=p.createTagGridLayout(k,m,$)},this.resize=function(a){(Math.abs(a.height-u.height)>B||Math.abs(a.width-u.width)>B)&&(u.height=a.height,u.width=a.width,h.setAttribute("style","height:"+u.height+"px ; width:"+u.width+"px ;"),k=u.height-D,l=u.width-E,i.style.setProperty("height",""+k+"px"),i.style.setProperty("width",""+l+"px"),g=.35*(l-F),m=.64*(l-F),O(),u.setDataSourceDims())},this.onCleanUp=function(){b=c=d=h=i=j=p=y=null},this.getDivElements=function(){var a={};return a={mainOuterDiv:h,bodyDiv:i}}};var PWC=PWC||{};PWC.HmiAC=PWC.HmiAC||{},PWC.HmiAC.Design=PWC.HmiAC.Design||{},PWC.HmiAC.Design.Inheritance=function(){var a=function(a,b){for(var c in b.prototype)c&&(a.prototype[c]||(a.prototype[c]=b.prototype[c]));a.prototype.constructor=a,a.baseCtor=b,a.basePrototype=b.prototype};return{Extend:a}}();var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.TagBrowser=PWC.Components.TagBrowser||{},PWC.Components.TagBrowser.BrowsingMode={BrowseBoth:0,BrowseNode:1,BrowseLeave:2},PWC.Components.TagBrowser.SortingMode={Created:0,Asc:1,Dsc:2},PWC.Components.TagBrowser.ObjectType={AnyTag:0,SimpleTag:1,StrutureTag:2,Group:3,Connection:4,All:5},PWC.Components.TagBrowser.RequestType={TreeView:0,ListView:1,GetCount:0,GetData:1},PWC.Components.TagBrowser.BrowsingRequestIds={ServerData:0,TreeViewGetEnum:1,ListViewGetEnum:2,TreeViewGetObject:3,ListViewGetObject:4},PWC.Components.TagBrowser.LanguageId={English:1033},PWC.Components.TagBrowser.ServerRequestParamIds={GetObject:0,SystemID:1,ObjectType:2,SelectedNode:3,NameFilter:4,PropertyFilter:5,LanguageID:6,BrowsingMode:7,SortingMode:8,SortByAttribute:9,RequestType:0,StartIndex:1,Count:2},PWC.Components.TagBrowser.NodeTypes={TagGroup:16,SimpleTag:32},PWC.Components.TagBrowser.NodeSubTypes={ChannelUnit:"Channel Unit",Directory:"Directory",ConnectionType:"Connection Type",TagGroup:"Tag group",LogicalConnection:"Logical Connection",Server:"Server"},PWC.Components.TagBrowser.DLDataReceivedTypes={DataSourceArray:1e3,TreeViewCount:1001,ListViewCount:1002,TreeViewData:1003,ListViewData:1004},PWC.Components.TagBrowser.TagGridColumnNames={Name:"Name",Type:"Type",Parameter:"Parameter",LastModification:"Last"},PWC.Components.TagBrowser.EventTypes={DataSourceLoad:"dataSrcLoad",DataSourceChange:"dataSourceChange",SingleClick:"singleClick",DoubleClick:"doubleClick",FilterChange:"filterChange",TreeViewImgClick:"imgClick",TreeViewSpanClick:"spanClick",TreeNodeDoubleClick:"treeDoubleClick",ScrollChange:"scrollChange",Sort:"sort"};var PWC=PWC||{};PWC.HmiAC=PWC.HmiAC||{},PWC.HmiAC.PropertyRowReadOnly=function(a,b){var c=null,d=null,e=null,f=null,g=a;this.name=b,this.initialize=function(){var c,d,e;f=document.createElement("Div"),f.setAttribute("class","LeafRow"),c=document.createElement("table"),d=document.createElement("tr"),e=document.createElement("td"),e.setAttribute("id",a),e.innerHTML=b,e.setAttribute("class","LeafName"),d.appendChild(e),c.appendChild(d),e.addEventListener("click",this.onClick),f.appendChild(c)},this.getValue=function(){return c.innerHTML},this.setValue=function(a){c.innerHTML=a},this.setPropChangeCallback=function(a){e=a},this.setParent=function(a){d=a,d.appendChild(f)},this.isLeaf=function(){return!0},this.destroyLeaf=function(){return f.parentNode.removeChild(f),!0},this.onClick=function(a){e(a,g)},this.initialize()};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.TagBrowser=PWC.Components.TagBrowser||{},PWC.Components.TagBrowser.TagBrowserArchiveView=function(a){"use strict";PWC.Components.TagBrowser.TagBrowserArchiveView.baseCtor.call(this,a)},PWC.HmiAC.Design.Inheritance.Extend(PWC.Components.TagBrowser.TagBrowserArchiveView,PWC.Components.TagBrowser.TagBrowserView);var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.TagBrowser=PWC.Components.TagBrowser||{},PWC.Components.TagBrowser.TagBrowserGridView=function(a,b,c,d){"use strict";var e,f,g,h,i,j,k,l,m,n,o=[],p=PWC.Components.Grid,q=new p.GridModel,r=!1,s=!1,t=!0,u=[],v=a,w=!1,x=!1,y=[],z=b,A=z.getLocaliziedDateTimeFormat("TBID_NML_DF_Default_Date").f,B=z.getLocaliziedDateTimeFormat("TBID_NML_DF_Default_Time").f,C=c,D=d,E=0,F=!1,G=!1,H=300,I=function(){var a,b,c=p.HorizantalAlignment.Left,d=p.ColumnDataType.Image,e=q.width/H,f=p.GridColumnModel;
for(y.length=0,b=0;e>b;b++)a=new f,a.alignment=c,a.index=b,a.columnDataType=d,a.showIcon=!0,a.width=H,a.sortOrder=PWC.Components.Grid.TableSortOrder.Ascending,y.push(a)},J=function(a,b,c){var d,g,h,i,j,k=p.HorizantalAlignment.Left,l=p.GridColumnModel;for(f=new p.IGridHost,o.length=0,q.width=b,q.height=a,K(q),h=c.length,i=0;h>i;i++)j=c[i],g=new l,g.alignment=k,g.index=j.Index,g.displayName=j.Name,g.columnDataType=j.ColType,g.showIcon=j.ShowIcon,g.width=j.Width,g.sortOrder=PWC.Components.Grid.TableSortOrder.Ascending,o.push(g);return q.gridColumns=o,f.getCellData=M,f.onCellDoubleClick=O,f.onVScrollChange=P,f.onVScrollUpButtonClick=Q,f.onVScrollDownButtonClick=R,f.onHScrollRightButtonClick=U,f.onHScrollLeftButtonClick=T,f.onSortButtonClicked=X,f.onMouseWheelScroll=S,e=new p.GridControl(C,"listView_Grid"),e.subscribeEvent(p.ControlEvents.OnCellDoubleClick),e.subscribeEvent(p.ControlEvents.OnColumnResize),e.subscribeEvent(p.ControlEvents.OnVScrollChange),e.subscribeEvent(p.ControlEvents.OnVScrollUpButtonClick),e.subscribeEvent(p.ControlEvents.OnVScrollDownButtonClick),e.subscribeEvent(p.ControlEvents.OnHScrollRightButtonClick),e.subscribeEvent(p.ControlEvents.OnHScrollLeftButtonClick),e.subscribeEvent(p.ControlEvents.OnSortButtonClicked),e.subscribeEvent(p.ControlEvents.OnMouseWheelScroll),e.setAutoScrollToLatest(!1),e.setAutoSelection(!1),d=e.init(q,f),e.pause(),w=!0,d},K=function(){q.gridLineWidth=0,q.left=0,q.top=0,q.columnTitles=!1,q.rowTitles=!1,q.useTableColor2=!1,q.verticalGridLines=!1,q.horizontalGridLines=!1,q.selectionType=p.SelectionType.Single,q.selectionColoring=p.TableSelectionColoring.Row,q.selectionRect=p.SelectionRect.None,q.columnTitleAlignment=p.HorizantalAlignment.Left,q.rowTitleAlignment=p.HorizantalAlignment.Left,q.horizontalGridLines=!1,q.verticalGridLines=!1,q.gridLineWidth=0,q.shortenCellContent=!0,q.columnTitles=!0,q.borderWidth=0,q.titleFontSize=15,q.selectedRowColor="#ADD8E6",q.showSortIndex=!1,q.showSortIcon=!1,q.useSortKey=!1,q.verticalScrollbarMode=p.ScrollBarMode.OnDemand,q.useSelectedTitleColor=!1,q.backgroundColor="#FFFFFF"},L=function(a){var b,c,d,e,f=[];return f[0]=B,f[1]=A,b=f.slice(0),c=PWC.HmiAC.CustomDateFormat.prototype.getCustomTimeFormat(PWC.HmiAC.TimeBase.UTC),d=c(a,b),e=d[1]+" "+d[0]},M=function(a,b){var c,d,e,f={},i=b;return f.style=null,r?(e=a-E,c=e*g+i,f.value=u[c]):s?(i=b-E,e=a,c=e+i*m,f.value=u[c]):(e=a-E,(d=h.AttributeValuesArray[e])&&d[i]&&(-1!==q.gridColumns[i].displayName.indexOf(PWC.Components.TagBrowser.TagGridColumnNames.LastModification)?h.NodeTypeArray[e]!==PWC.Components.TagBrowser.NodeTypes.TagGroup?(f.value=new Date(PWC.Lib.Canvas.Converters.convertFileTimeToJSTimeStamp(d[i])),f.value=L(f.value)):f.value="":f.value="[empty]"===d[i]?"":d[i])),f},N=function(){var a,b,c,d,f,i,j;return f=e.getSelection(),j=f.selectedCellColumnIndex,i=f.selectedCellRowIndex,null!==j&&null!==i&&(r?(i-=E,c=i*g+j):s?(j-=E,c=i+j*m):c=i-E,a=h.NodeTypeArray[c],a!==PWC.Components.TagBrowser.NodeTypes.TagGroup&&(b=h.AttributeValuesArray[c][0],b.indexOf("|")>-1&&(d=b.split("|"),b=d[d.length-1]))),b},O=function(a,b){var c,d,e,f;r?(a-=E,e=a*g+b):s?(b-=E,e=a+b*m):e=a-E,c=h.NodeTypeArray[e],d=h.AttributeValuesArray[e][0],d.indexOf("|")>-1&&(f=d.split("|"),d=f[f.length-1]),v(PWC.Components.TagBrowser.EventTypes.DoubleClick,d,c)},P=function(a,b){V(a,b)},Q=function(a,b){V(a,b)},R=function(a,b){V(a,b)},S=function(a,b){V(a,b)},T=function(a,b){W(a,b)},U=function(a,b){W(a,b)},V=function(a,b){E=a,r&&(b*=g,a*=g),v(PWC.Components.TagBrowser.EventTypes.ScrollChange,a,b)},W=function(a){var b;s?(E=a,b=n*m,a*=m):t&&(b=m),v(PWC.Components.TagBrowser.EventTypes.ScrollChange,a,b)},X=function(a,b,c){v(PWC.Components.TagBrowser.EventTypes.Sort,a,c)},Y=function(a){var b;return a.ObjectCount>0?(i=a.ObjectCount,m=e.getDisplayedRowInfo().size,r?j=m*g:s?(n=Math.ceil(q.width/H),j=m*n):j=m,k=0,l=k+(j-1),b={CurrentStartIndex:k,NoOfRecords:j}):(e.unLoad(),h=null,j=0,i=0),b},Z=function(a,b){G=b,void 0!==a&&$(a),h&&(r?(b&&ib(),hb()):s?(b&&kb(),jb()):(b&&gb(),fb())),G=!1,F=!1},$=function(a){var b,c,d,e,f,g;for(b=D+"content/Advanced/BrowsingView/",d=a.AttributeValuesArray.length,c=0;d>c;c++)if(e=a.NodeTypeArray[c],f=a.AttributeValuesArray[c][0],e===PWC.Components.TagBrowser.NodeTypes.TagGroup){if(g=a.AttributeValuesArray[c][1])switch(g){case PWC.Components.TagBrowser.NodeSubTypes.TagGroup:a.AttributeValuesArray[c][0]=b+"TagGroup.png|"+f;break;case PWC.Components.TagBrowser.NodeSubTypes.ChannelUnit:a.AttributeValuesArray[c][0]=b+"ChannelUnit.png|"+f;break;case PWC.Components.TagBrowser.NodeSubTypes.LogicalConnection:a.AttributeValuesArray[c][0]=b+"LogicalConnection.png|"+f;break;case PWC.Components.TagBrowser.NodeSubTypes.Server:a.AttributeValuesArray[c][0]=b+"Server.png|"+f;break;case PWC.Components.TagBrowser.NodeSubTypes.Directory:case PWC.Components.TagBrowser.NodeSubTypes.ConnectionType:a.AttributeValuesArray[c][0]=b+"Directory.png|"+f}}else e===PWC.Components.TagBrowser.NodeTypes.SimpleTag&&(a.AttributeValuesArray[c][0]=b+"variable.png|"+f);h=a},_=function(){var a,b;for(a=h.IdentifierArray.length,b=0;a>b;b++)u.push(h.AttributeValuesArray[b][0])},ab=function(){var a;return m=e.getDisplayedRowInfo().size,j=t?m:r?m*g:m*n,j=j>i?i:j,a={CurrentStartIndex:k,NoOfRecords:j}},bb=function(){q.columnTitles=!1,q.selectionRect=p.SelectionRect.None,q.selectionColoring=p.TableSelectionColoring.Cell,q.selectedCellColor="#ADD8E6",q.autoCompleteColumns=!1},cb=function(){q.selectionColoring=p.TableSelectionColoring.Row,q.columnTitles=!0,q.useSelectedTitleColor=!1,q.selectionRect=p.SelectionRect.None,s=!1,r=!1,q.autoCompleteColumns=!0},db=function(a){var b,c,d,f,h=p.HorizantalAlignment.Left,j=p.ColumnDataType.Image,k=p.GridColumnModel,l=0;if(b=H,r?(i>m&&(l=e.getTableProps().vScrollBarWidth),c=Math.floor((q.width-l)/b)-y.length):s&&(c=a-y.length),c>0)for(d=0;c>d;d++)f=new k,f.alignment=h,f.index=y.length+d,f.columnDataType=j,f.showIcon=!0,f.width=b,y.push(f);else if(0>c)for(d=0;d>c;d--)y.pop();g=y.length},eb=function(){var a;return m=e.getDisplayedRowInfo().size,t?j=m:r?(ib(),j=m*g):(kb(),j=m*n),j=j>i?i:j,a={CurrentStartIndex:E,NoOfRecords:j}},fb=function(){(F||G)&&(E=0),e.load(i)},gb=function(){t||(t=!0,cb(),q.gridColumns=o),(F||G)&&e.unLoad(),e.onPropertyChange(q)},hb=function(){var a;u.length=0,_(),a=Math.ceil(i/g),(F||G)&&(E=0),e.load(a)},ib=function(){r||(r=!0,s=!1,t=!1,x||(I(),x=!0),q.gridColumns=y,bb()),db(),(F||G)&&e.unLoad(),e.onPropertyChange(q)},jb=function(){u.length=0,_(),(F||G)&&(E=0),e.load(m)},kb=function(){var a;s||(s=!0,r=!1,t=!1,x||(I(),x=!0),q.gridColumns=y,bb()),m=e.getDisplayedRowInfo().size,a=Math.ceil(i/m),n=q.width/H,a>n?n=Math.ceil(n):n>a&&(n=Math.floor(n)),db(a),F&&e.unLoad(),e.onPropertyChange(q)},lb=function(){e.unLoad()},mb=function(a){F=a},nb=function(){E=0},ob=function(a,b){q.width=b,q.height=a,e.onPropertyChange(q),m=e.getDisplayedRowInfo().size};return{createTagGridLayout:J,calculateViewPort:Y,renderTagGridData:Z,detailView:fb,listView:jb,smallIconView:hb,smallIconGridLayoutChange:ib,setGridDims:ob,unLoadGrid:lb,getSelectedRecord:N,listViewGridLayoutChange:kb,detailViewLayoutChange:gb,requestRequiredData:ab,resizeCalculations:eb,setViewChangedBool:mb,modifyTagDataWithImages:$,setScrollStatus:nb}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.TagBrowser=PWC.Components.TagBrowser||{},PWC.Components.TagBrowser.TagBrowserOnlineView=function(a){"use strict";PWC.Components.TagBrowser.TagBrowserOnlineView.baseCtor.call(this,a);var b,c,d,e,f,g,h,i,j,k,l,m=this,n="*",o=a.gfxWebLib.textbib,p=150,q=180,r=a.rtoid,s={FontSize:16,FontName:"serif"},t=!1,u=function(a){var b,k,l,m,n,p,q,s,t,u,w,x,y;for(p=a.length,d=document.createElement("fieldset"),d.setAttribute("id","dataSourceFieldSet_"+r),d.setAttribute("class","dataSourceFieldSet"),d.style.width=i-h+"px",u=document.createElement("table"),u.setAttribute("border","0"),u.setAttribute("cellspacing","0"),u.setAttribute("cellpadding","0"),u.setAttribute("style"," height: 100%;width: 100%;border: 0;"),y=document.createElement("tr"),w=document.createElement("td"),b=document.createElement("span"),m=document.createTextNode(o.getText("TBID_TagBrowser_DataSource")),b.appendChild(m),w.appendChild(b),x=document.createElement("td"),g=document.createElement("div"),g.setAttribute("class","dataSourceItems"),g.style.width=j+"px",x.appendChild(g),y.appendChild(w),y.appendChild(x),u.appendChild(y),q=0;p>q;q++)s=document.createElement("label"),k=document.createElement("input"),k.setAttribute("type","checkbox"),k.setAttribute("id","dataSrcCheckbox_"+a[q]+"_"+q),k.checked=0===q?!0:!1,n=a[q],l=document.createElement("span"),m=document.createTextNode(n),l.appendChild(m),s.appendChild(k),s.appendChild(l),k.onclick=v,g.appendChild(s);f.insertBefore(d,c),d.appendChild(u),e(PWC.Components.TagBrowser.EventTypes.DataSourceLoad,t,0,a[0])},v=function(a){var b=a.target||a.srcElement,c=[],d=null,f=null;b.id&&(c=b.id.split("_"),f=c[1],d=c[2]),e(PWC.Components.TagBrowser.EventTypes.DataSourceChange,a,d,f)},w=function(a){var b=a.target||a.srcElement;""===b.value&&(b.value=n),e(PWC.Components.TagBrowser.EventTypes.FilterChange,a),b.removeEventListener("blur",w),t=!1},x=function(a){var b;a=a||window.event,b=a.target||a.srcElement,13===a.keyCode?(b.removeEventListener("blur",w),t=!1,""===b.value&&(b.value=n),e(PWC.Components.TagBrowser.EventTypes.FilterChange,a)):t||(b.addEventListener("blur",w),t=!0)},y=function(a){var b;a=a||window.event,b=a.target||a.srcElement,b.addEventListener("blur",w),t=!0},z=function(a){var d,e,g,i,j,k,l,m;c=document.createElement("fieldset"),c.setAttribute("id","filterFieldSet_"+r),c.setAttribute("class","filterFieldSet"),c.style.width=h+"px",j=document.createElement("table"),j.setAttribute("border","0"),j.setAttribute("cellspacing","0"),j.setAttribute("cellpadding","0"),j.setAttribute("style"," height: 100%;width: 100%;border: 0;"),k=document.createElement("tr"),m=document.createElement("td"),e=document.createElement("span"),i=document.createTextNode(o.getText("TBID_TagBrowser_Filter")),e.appendChild(i),m.appendChild(e),l=document.createElement("td"),d=document.createElement("div"),d.setAttribute("class","filterItems"),g=document.createElement("input"),g.setAttribute("type","text"),g.setAttribute("id","filterTextBox"),g.setAttribute("class","filterTextBox"),g.setAttribute("value",a),d.appendChild(g),l.appendChild(d),k.appendChild(m),k.appendChild(l),j.appendChild(k),f.insertBefore(c,b),c.appendChild(j),g.addEventListener("mousedown",y),g.addEventListener("keydown",x)};this.setDataSourceDims=function(){d&&(i=this.width-q,void 0===k&&(k=PWC.Lib.Canvas.Svg.getTextBBox(s,o.getText("TBID_TagBrowser_Filter"))),h=p+k.width,d.style.width=i-h+"px",void 0===l&&(l=PWC.Lib.Canvas.Svg.getTextBBox(s,o.getText("TBID_TagBrowser_DataSource"))),j=i-h-l.width,g.style.width=j+"px")},this.createTopLayout=function(a,c,d){var g,n=o.getText("TBID_TagBrowser_Filter"),r=o.getText("TBID_TagBrowser_DataSource");i=m.width-q,k=PWC.Lib.Canvas.Svg.getTextBBox(s,n),h=p+k.width,l=PWC.Lib.Canvas.Svg.getTextBBox(s,r),j=i-h-l.width,e=c,g=this.getDivElements(),g&&(f=g.mainOuterDiv,b=g.bodyDiv),z(d),u(a)}},PWC.HmiAC.Design.Inheritance.Extend(PWC.Components.TagBrowser.TagBrowserOnlineView,PWC.Components.TagBrowser.TagBrowserView);var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.TagBrowser=PWC.Components.TagBrowser||{},PWC.Components.TagBrowser.TagBrowseTreeView=function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=b,o=a.slice(0),p=c,q="\\",r=p+"content/Advanced/BrowsingView/",s=function(){e.clearTreeView()},t=function(a,b,c,d,e){var i,k,m,o,p,r,s,t;if(b&&(i=b.target||b.srcElement),r=i.parentElement.children[i.parentElement.childElementCount-1].innerHTML,a===PWC.Components.TagBrowser.EventTypes.TreeNodeDoubleClick)y(r,c),o=c.getParentName(),l=l||h,l.removeAttributes(),l=c,f=i,g=void 0===o?r:o+q+r,n(a,PWC.Components.TagBrowser.RequestType.ListView,g,c);else if(a===PWC.Components.TagBrowser.EventTypes.TreeViewSpanClick)f&&f.removeAttribute("class"),o=c.getParentName(),f=i,g=void 0===o?r:o+q+r,i.setAttribute("class","nodeBackColor"),l=c,n(a,PWC.Components.TagBrowser.RequestType.ListView,g,c);else if(a===PWC.Components.TagBrowser.EventTypes.TreeViewImgClick)if(d){for(k=c.getChildren(),m=0;m<k.length;m++)c.destroyNode(k[m]);c.setChildren(),s=l.getParentName(),j=void 0,t=c.getParentName()?c.getParentName()+q+r:r,s&&(s.indexOf(t)>-1||e)&&(e&&f.removeAttribute("class"),p=i.parentNode.children[i.parentNode.childElementCount-1],p.removeAttribute("class"),p.setAttribute("class","nodeBackColor"),f=p,l=c,n(a,PWC.Components.TagBrowser.RequestType.ListView,t,c))}else o=c.getParentName(),g=void 0===o?r:o+q+r,l=c,n(a,PWC.Components.TagBrowser.RequestType.TreeView,g,c)},u=function(a){var b,c,d,e,f;for(c=a.AttributeValuesArray.length,b=0;c>b;b++)if(d=a.NodeTypeArray[b],e=a.IdentifierArray[b],d===PWC.Components.TagBrowser.NodeTypes.TagGroup){if(a.AttributeValuesArray[b][1])switch(f=a.AttributeValuesArray[b][1]){case PWC.Components.TagBrowser.NodeSubTypes.TagGroup:a.IdentifierArray[b]="TagGroup.png|"+e;break;case PWC.Components.TagBrowser.NodeSubTypes.ChannelUnit:a.IdentifierArray[b]="ChannelUnit.png|"+e;break;case PWC.Components.TagBrowser.NodeSubTypes.Server:a.IdentifierArray[b]="Server.png|"+e;break;case PWC.Components.TagBrowser.NodeSubTypes.Directory:case PWC.Components.TagBrowser.NodeSubTypes.ConnectionType:a.IdentifierArray[b]="Directory.png|"+e}}else d===PWC.Components.TagBrowser.NodeTypes.SimpleTag&&(a.IdentifierArray[b]="variable.png|"+e);return a},v=function(a,b){var c,d,e,k,n;for(c=0;c<a.length;c++)d=a[c],d.indexOf("|")>-1&&(n=d.split("|"),d=n[1],k=n[0]),e=new PWC.HmiAC.TreeNode(d,k,r),b.addNode(e),void 0===g&&(g=i),e.setParentName(g,!1),d===j&&(l=l||h,l.removeAttributes(),e.setNodeSelectionAttributes(),f=e.getSourceElement(),l=e,m=d);h=e,i=d},w=function(a){var b;for(d=a,e=new PWC.HmiAC.TreeView(d,t,d.id),b=0;b<o.length;b++)o[b]="Variables.png|"+o[b];v(o,e),h.setNodeSelectionAttributes(),f=h.getSourceElement()},x=function(a,b){var c,d,e;for(void 0===b&&(b=l||h),b.setAttributes(),c=b.getChildren(),d=0;d<c.length;d++)b.destroyNode(c[d]);b.setChildren(),e=u(a),v(e.IdentifierArray,b)},y=function(a,b){j=a,void 0!==b&&(k=b)};return{initializeTreeView:w,clearTreeView:s,modifyTreeView:x,setDoubleClickSelectedNode:y}};var PWC=PWC||{};PWC.HmiAC=PWC.HmiAC||{},PWC.HmiAC.TreeNode=function(a,b,c,d){var e,f,g,h,i,j=a,k=null,l=null,m=!1,n=[],o=this,p=c;this.initialize=function(){var a,c,g;void 0===d&&(e=j),f=document.createElement("div"),f.setAttribute("class","treeNode"),f.setAttribute("id",e),a=document.createElement("div"),a.setAttribute("class","treeNodeContent"),c=document.createElement("div"),c.setAttribute("style","white-space: nowrap"),k=document.createElement("img"),k.setAttribute("src",p+"expand.png"),k.setAttribute("id","expander_"+e),k.setAttribute("class","treeViewImages"),b&&(g=document.createElement("img"),g.setAttribute("src",p+b),g.setAttribute("id","nodeimg_"+e),g.setAttribute("class","treeViewImages")),l=document.createElement("span"),l.setAttribute("style","margin:0px;"),l.setAttribute("id","span_"+e),l.innerHTML=j,c.appendChild(k),void 0!==g&&c.appendChild(g),c.appendChild(l),a.appendChild(c),a.addEventListener("click",this.preventSummaryDefault,!1),f.appendChild(a)},this.onImgClick=function(a){m?k.setAttribute("src",p+"expand.png"):k.setAttribute("src",p+"collapse.png"),h(PWC.Components.TagBrowser.EventTypes.TreeViewImgClick,a,o,m),a=a||window.event,a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,m=!m},this.onNodeTextSingleClick=function(a){h(PWC.Components.TagBrowser.EventTypes.TreeViewSpanClick,a,o)},this.onNodeTextDoubleClick=function(a){m?(k.setAttribute("src",p+"expand.png"),h(PWC.Components.TagBrowser.EventTypes.TreeViewImgClick,a,o,m,!0)):(k.setAttribute("src",p+"collapse.png"),h(PWC.Components.TagBrowser.EventTypes.TreeNodeDoubleClick,a,o),o.setNodeSelectionAttributes(!0)),m=!m},this.preventSummaryDefault=function(a){a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1},this.isExpanded=function(){return m},this.getNodeText=function(){return j},this.setAttributes=function(){m||(k.setAttribute("src",p+"collapse.png"),m=!m)},this.setNodeSelectionAttributes=function(a){a?l.setAttribute("class","nodeBackColor"):l.setAttribute("class","nodeDefaultSelectColor")},this.getSourceElement=function(){return l},this.removeAttributes=function(){l.removeAttribute("class")},this.setParent=function(a){g=a,g.appendChild(f),"TreeView"===a.getAttribute("class")&&f.setAttribute("style","margin: 0px; float: left;")},this.setParentName=function(a,b){i=b?null:void 0!==i?i+"//"+a:a,l&&l.setAttribute("parentnodename",i)},this.getParentName=function(){return i},this.addLeaf=function(a,b,c){var d=null;return d=new PWC.HmiAC.PropertyRowReadOnly(a,b,c),d.setPropChangeCallback(h),n.push(d),d.setParent(f),d},this.addNode=function(a){return a.setPropChangeCallback(h),n.push(a),a.setParent(f),a},this.setPropChangeCallback=function(a){h=a},this.isLeaf=function(){return!1},this.destroyNode=function(a){var b,c=!1,d=n.length,e=null;if(this===a)g.removeChild(f),c=!0;else for(b=0;d>b&&!c;b++)e=n[b],e&&!e.isLeaf()&&(c=e.destroyNode(a),c&&(n[b]=void 0));return c},this.destroyLeaf=function(a){var b,c=!1,d=n.length,e=null;for(b=0;d>b&&!c;b++)e=n[b],e&&e.isLeaf()?e===a&&(c=e.destroyLeaf(),c&&(n[b]=void 0)):e&&!e.isLeaf()&&(c=e.destroyLeaf(a),c&&(n[b]=void 0));return c},this.getChildren=function(){return n},this.setChildren=function(){n.length=0},this.initialize()};var PWC=PWC||{};PWC.HmiAC=PWC.HmiAC||{},PWC.HmiAC.TreeView=function(a,b,c){var d,e=[],f=a,g=c,h=null,i=b,j="nodeimg_",k=function(a){var b,c,d,f,g,h;if(a&&(c=a.target||a.srcElement),c&&("IMG"===c.tagName||"SPAN"===c.tagName)&&("IMG"!==c.tagName||0!==c.id.indexOf(j))&&(h=c.parentElement.children[c.parentElement.childElementCount-1],d=h.innerHTML,f=h.getAttribute("parentnodename"),b=e[0].getChildren(),0!==b.length?(g=l(b,d,f),void 0===g&&(g=e[0])):g=e[0],void 0!==g))switch(a.type){case"doubletap":g.onNodeTextDoubleClick(a);break;case"singletap":"IMG"===c.nodeName?g.onImgClick(a):"SPAN"===c.nodeName&&g.onNodeTextSingleClick(a)}},l=function(a,b,c){var d,e,f,g,h,i,j;for(e=a.length,d=0;e>d;d++)if(g=a[d],f=g.getNodeText(),j=g.getParentName(),c===j){if(b===f)return g}else if(i=g.getChildren(),i.length>0&&(h=l(i,b,c),void 0!==h))break;return h},m=function(){requirejs.config({baseUrl:"/libs",paths:{Hammer:"hammer-2.0.2"}}),require(["Hammer"],function(a){d=new a.Manager(h,{domEvents:!0}),d.add(new a.Tap({event:"doubletap",taps:2})),d.add(new a.Tap({event:"singletap"})),d.get("doubletap").recognizeWith("singletap"),d.get("singletap").requireFailure("doubletap"),d.on("doubletap",k),d.on("singletap",k),d.add(new a.Pan({event:"pan",pointers:1,direction:a.DIRECTION_ALL,threshold:1}))})};this.initialize=function(){h=document.createElement("Div"),h.setAttribute("id","TreeView_"+g),h.setAttribute("class","TreeView"),f.appendChild(h),m()},this.addNode=function(a){return a.setParent(h),a.setPropChangeCallback(i),e.push(a),a},this.addLeaf=function(a){return a.setParent(h),a.setPropChangeCallback(i),e.push(a),a},this.removeLeaf=function(a){var b,c,d=e.length,f=!1;for(b=0;d>b&&!f;++b)c=e[b],c&&c.isLeaf()?(c===a&&(e[b]=void 0),f=c.destroyLeaf()):f=c.destroyLeaf(a);return f},this.removeNode=function(a){var b,c,d=e.length,f=!1;for(b=0;d>b&&!f;b++)c=e[b],c&&!c.isLeaf()&&(c===this&&(e[b]=void 0),f=c.destroyNode(a));return f},this.clearTreeView=function(){var a,b,c=e.length;for(a=0;c>a;a++)b=e[a],b.isLeaf()?b.destroyLeaf():b.destroyNode(b);return e=[],!0},this.initialize()};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog=function(){"use strict";var a=8,b=function(a,b){var c=null;return c=document.createElement("input"),c.setAttribute("type","button"),c.setAttribute("value",a),c.setAttribute("class","msgBoxBtn"+a),c.setAttribute("data-tif-id","msgBoxBtn_"+a+"_tiffId"),c.addEventListener("click",b),c},c=function(a,c,d,e){var f,g,h,i,j,k,l=e.close;return f=document.createElement("table"),g=document.createElement("tr"),h=document.createElement("td"),i=document.createElement("div"),j=document.createElement("span"),f.setAttribute("style","width:100%"),f.setAttribute("cellspacing","0"),f.setAttribute("cellpadding","0"),h.setAttribute("colspan","2"),h.setAttribute("align","center"),h.setAttribute("width","100%"),h.setAttribute("class","msgBoxMsgCell"),h.setAttribute("style","height: 70px; width: 0px; padding-bottom: 10px; padding-top: 10px; background: #F8F8F8; vertical-align: middle;"),j.setAttribute("class","msgBoxSpan"),j.setAttribute("style","padding-left: 35px;padding-right: 35px;"),j.appendChild(document.createTextNode(a)),i.appendChild(j),h.appendChild(i),g.appendChild(h),f.appendChild(g),g=document.createElement("tr"),h=document.createElement("td"),h.setAttribute("colspan","2"),h.setAttribute("align","center"),h.setAttribute("class","msgBoxBtnCell"),h.setAttribute("style","padding-top: 20px;padding-bottom: 10px; background: #E0E0E0;"),d&&(k=b("Cancel",function(){d(),l(),e=null}),k.setAttribute("style","padding: 3px; width: 82px; background-color: #C8C8C8; float: right; margin-right: 10px;"),h.appendChild(k)),c&&(k=b("OK",function(){c(),l(),e=null}),k.setAttribute("style"," padding: 3px; width: 82px; background-color: #C8C8C8; float: right; margin-right: 10px;"),h.appendChild(k)),g.appendChild(h),f.appendChild(g),f},d=function(b,d,e,f,g,h){var i,j;i={FrameCloseCallBack:g?g:f,Caption:e?e:"Message Box",BackColor:h?h:void 0,Width:b.length*a,MaxWidth:502},j=new PWC.Components.GenericDialog.Frame.HtmlDiv,j.createFrame(d,i),j.showModal(c(b,f,g,j))},e=function(a,b,c,e){d(a,b,void 0,c,e)},f=function(a,b,c,e,f){d(a,b,c,e,f,"#0A9EBB")};return{MessageBox:e,ShowWarning:f}}();var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.FrameTypes={Hmi:"Hmi",HtmlDiv:"HtmlDiv"},PWC.Components.GenericDialog.ContentTypes={Angular:"Angular",Json:"Json"},PWC.Components.GenericDialog.HtmlControlTypes={Label:"LABEL",Select:"SELECT",Input:"INPUT",Color:"color",Checkbox:"checkbox",Date:"date",Time:"time",Text:"text"};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Content=PWC.Components.GenericDialog.Content||{},PWC.Components.GenericDialog.Content.ControlTypes=function(){"use strict";var a=PWC.Components.GenericDialog.HtmlControlTypes,b=function(b){var d=null;switch(b.nodeName){case a.Select:d=b.options[b.selectedIndex].text,d=""===d?" ":d;break;case a.Label:d=b.innerText;break;case a.Input:d=c(b);break;default:d=b.value}return d},c=function(b){var c,d,e=null,f=[];switch(b.type){case a.Checkbox:e=b.checked;break;case a.Date:case a.Time:c=b.getAttribute("name"),f=document.getElementsByName(c),e={date:f[0].value,time:f[1].value};break;case a.Text:c=b.getAttribute("name"),void 0!==c&&""!==c&&null!==c?(f=document.getElementsByName(c),f.length>1?(d=f[1].value,-1!==d.indexOf(":")&&-1!==d.indexOf(".")&&(d=d.substr(0,d.indexOf("."))),e={date:f[0].value,time:d}):(e=f[0].value,""===e&&(e=0))):(e=b.value,""===e&&(e=0));break;default:e=b.value,""===e&&(e=0)}return e};return{getUpdatedData:b}}();var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Content=PWC.Components.GenericDialog.Content||{},PWC.Components.GenericDialog.Content.Angular=function(){"use strict";this.dialog=null;var a=function(a){return this.dialog=PWC.Components.GenericDialog.Content.ObjectTypes.getHandler(a.name),this.dialog.create(a.rtoid,a.sourceItem,a.eventHandler)};return{createContent:a}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Content=PWC.Components.GenericDialog.Content||{},PWC.Components.GenericDialog.Content.ObjectTypes=function(){"use strict";var a=[],b=function(b){return void 0!==a[b]?a[b]:null},c=function(b,c){a[b]=c};return{addHandler:c,getHandler:b}}();var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Content=PWC.Components.GenericDialog.Content||{},PWC.Components.GenericDialog.Content.ContentBase=function(){},PWC.Components.GenericDialog.Content.ContentBase.prototype={createControl:function(a){var b,c,d,e=a.parentDiv;return c=angular.element(e).scope(),b=c.createDialog(a)[0],d=angular.element(b).scope(),d.$root.$$phase||d.safeApply(),b}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Content=PWC.Components.GenericDialog.Content||{},PWC.Components.GenericDialog.Content.TabView=function(a,b){var c=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};this.el=a,this.options=c({},this.options),c(this.options,b),this._init()},PWC.Components.GenericDialog.Content.TabView.prototype={_init:function(){this.parents=[].slice.call(this.el.querySelectorAll("nav > div")),this.tabs=[].slice.call(this.el.querySelectorAll("nav > div > button")),this.items=[].slice.call(this.el.querySelectorAll(".pwcdialogcontent > section")),this.current=void 0===this.options.start||null===this.options.start?4:this.options.start,this._initEvents()},_initEvents:function(){var a,b,c=this,d=document.getElementById("pwcPBTabs");a=c.parents[0],b=c.parents[1],a.addEventListener("click",function(e){e.preventDefault(),c._show(e,d,a.id,b.id)}),b.addEventListener("click",function(e){e.preventDefault(),c._show(e,d,b.id,a.id)})},_show:function(a,b,c,d){var e,f=a.target||a.srcElement||a.currentTarget,g=this.tabs.length;if(f.id!==c&&f.id!==d){for((void 0===this.current||null===this.current)&&(this.current=this.options.start>=0&&this.options.start<this.items.length?this.options.start:0),this.current>=0&&(this.tabs[this.current].className="",this.items[this.current].className=""),e=0;g>e&&f.id!==this.tabs[e].id;e++);this.current=void 0!==e?e:this.options.start>=0&&this.options.start<this.items.length?this.options.start:0,this.tabs[this.current].className="pwcPBTabs-current",this.items[this.current].className="pwcdialogcontent-current",this._shiftDivs(c,d)}},_shiftDivs:function(a,b){var c,d,e=0;d="0px"===this.parents[0].style.top?this.parents[1].style.top:this.parents[0].style.top,c=document.getElementById(a),c.style.left=e+"px",c.style.top=d,c.style.display="block",c=document.getElementById(b),c.style.left="0px",c.style.top="0px",c.style.display="block"}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Frame=PWC.Components.GenericDialog.Frame||{},PWC.Components.GenericDialog.Frame.Factory=function(){var a=function(a,b,c){var d,e=PWC.Components.GenericDialog.FrameTypes;switch(a){case e.Hmi:d=new PWC.Components.GenericDialog.Frame.HmiWindow;break;case e.HtmlDiv:d=new PWC.Components.GenericDialog.Frame.HtmlDiv;break;default:d=null}return d.createFrame(b,c),d};return{getFrame:a}}();var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Frame=PWC.Components.GenericDialog.Frame||{},PWC.Components.GenericDialog.Frame.HmiWindow=function(){"use strict";var a,b=null,c=-100,d=-100,e=400,f=400,g=!0,h=!1,i=!0,j=!1,k=!1,l=!0,m=15460584,n=1,o=!0,p=function(b){a={Left:b&&b.Left?b.Left:c,Top:b&&b.Top?b.Top:d,Width:b&&b.Width?b.Width:e,Height:b&&b.Height?b.Height:f,BackColor:b&&b.BackColor?b.BackColor:m,ShowCaption:b&&b.ShowCaption?b.ShowCaption:n,Visible:b&&b.Visible?b.Visible:o,BorderEnabled:b&&b.BorderEnabled?b.BorderEnabled:l,WindowSizingEnabled:b&&b.WindowSizingEnabled?b.WindowSizingEnabled:h,WindowMovingEnabled:b&&b.WindowMovingEnabled?b.WindowMovingEnabled:i,WindowMaximizeEnabled:b&&b.WindowMaximizeEnabled?b.WindowMaximizeEnabled:j,ShowScrollBars:b&&b.ShowScrollBars?b.ShowScrollBars:k,WindowCloseEnabled:b&&b.WindowCloseEnabled?b.WindowCloseEnabled:g,Caption:b&&b.Caption?b.Caption:""}};this.createFrame=function(c,d){p(d.props),b=d.item.createHmiObject("HmiWindow",d.rtoid,a),b.domParent=c},this.show=function(a){var c=b.domParent;b.domNode.getElementsByClassName("pwcSomeContent")[0].appendChild(a),c.appendChild(b.domNode)},this.showModal=function(a){var c,d=b.domParent;b.domNode.getElementsByClassName("pwcSomeContent")[0].appendChild(a),d.appendChild(b.domNode),c=document.createElement("div"),c.setAttribute("id",d.id+"_divModal"),c.setAttribute("class","divForModal"),d.parentNode.insertBefore(c,d),d.setAttribute("class","hmiWindowModal")}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Frame=PWC.Components.GenericDialog.Frame||{},PWC.Components.GenericDialog.Frame.TitlebarStyles={backgroundColor:"#6BADF6",fontfamily:"Arial",fontsize:"14px",fontweight:"bold",color:"rgb( 0, 0, 0 )",closeBackColor:"#c75050",closeFontColor:"#ffffff"},PWC.Components.GenericDialog.Frame.BorderStyles={strokeWidth:"8px",stroke:"#6BADF6",variant:"solid",strokeWidthTop:"2px"};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Frame=PWC.Components.GenericDialog.Frame||{},PWC.Components.GenericDialog.Frame.HtmlDiv=function(){"use strict";var a,b,c,d,e,f,g,h,i,j=new PWC.Components.GenericDialog.Frame.HtmlDiv.Node,k=document,l=this,m=!1,n=400,o=0,p=window.innerHeight>o?window.innerHeight-o/2:10,q=window.innerWidth>n?window.innerWidth-n/2:10,r=null,s=null,t=100,u=!1,v=!0,w=!0,x=3,y={x:0,y:0,mouseX:0,mouseY:0,moving:!1,resizing:!1,resizeTop:!1,resizeLeft:!1,resizeBottom:!1,resizeRight:!1,xyfact:{},topMax:700,leftMax:800,leftMin:30,topMin:30},z=!1,A="x",B="x",C=function(a,b){var d,e,f,g=c,h=[];if(g.getElementsByClassName)h=g.getElementsByClassName(a);else for(b=b||"*",d=g.all||g.getElementsByTagName(b),f=d.length,e=0;f>e;e++)d[e].className&&-1!==d[e].className.baseVal.indexOf(a)&&h.push(d[e]);return h[0]},D=function(){var c,d,g;b=n,a=o,f=C("frameParentDiv"),i=C("frameOverylayDiv"),m=!1,w||(C("frameTableTitleRow").style.display="none",f.style.borderTopWidth="6px"),C("frameTitle").appendChild(k.createTextNode(e)),i.style.top="0px",i.style.left="0px",c="Height",d=Math.max(k.documentElement["client"+c],k.body["scroll"+c],k.documentElement["scroll"+c],k.body["offset"+c],k.documentElement["offset"+c]),c="Width",g=Math.max(k.documentElement["client"+c],k.body["scroll"+c],k.documentElement["scroll"+c],k.body["offset"+c],k.documentElement["offset"+c]),i.style.height=d+"px",i.style.width=g-2+"px",i.style.display="",f.style.display="",f.style.top=p+"px",f.style.left=q+"px",f.style.height=t+"px",f.style.width=n+"px",y.checkMinMax=!0},E=function(){var a;a=C("frameTableTitleCell"),C("frameCloseDiv").addEventListener("click",l.close),C("frameTableTitleRow").addEventListener("mousedown",P),f.addEventListener("mousemove",J),f.addEventListener("mouseout",K),f.addEventListener("mousedown",L),f.addEventListener("click",s)},F=function(){C("frameCloseDiv").removeEventListener("click",l.close),C("frameTableTitleRow").removeEventListener("mousedown",P),f.removeEventListener("mousemove",J),f.removeEventListener("mouseout",K),f.removeEventListener("mousedown",L),f.removeEventListener("click",s)},G=function(a){a.stopPropagation()},H=function(a){document.body.style.cursor=a},I=function(a,b){a?(z||(A=B),H(b),z=a):(z=a,H(A))},J=function(a){var b=10,c=a.srcElement||a.target,d=a.clientX-c.getBoundingClientRect().left,e=a.clientY-c.getBoundingClientRect().top;u&&(G(a),b>d?b>e?I(!0,"se-resize"):e>o-b?I(!0,"sw-resize"):I(!0,"e-resize"):d>n-b?b>e?I(!0,"sw-resize"):e>o-b?I(!0,"se-resize"):I(!0,"e-resize"):I(!0,"s-resize"))},K=function(a){G(a),y.resizing||y.moving||I(!0,"default")},L=function(a){var b,c,d,e,f=10;c=a.target||a.srcElement,d=a.clientX-c.getBoundingClientRect().left,e=a.clientY-c.getBoundingClientRect().top,u&&(G(a),f>d?y.resizeLeft=!0:d>n-f&&(y.resizeRight=!0),f>e?y.resizeTop=!0:e>o-f&&(y.resizeBottom=!0),b={left:window.innerWidth-30,top:window.innerHeight-30},y.x=a.clientX,y.y=a.clientY,y.checkMinMax=!0,y.topMin=x,y.topMax=b.top,y.leftMin=x,y.leftMax=b.left,y.resizing=!0,document.addEventListener("mousemove",M,!0),document.addEventListener("mouseup",O,!0))
},M=function(a){G(a),y.resizing||O(),y.mouseX=a.clientX,y.mouseY=a.clientY,N(a)},N=function(){var a,b,c,d,e,g,h,i;e=y.mouseY-y.y,g=y.mouseX-y.x,i=h=!1,y.resizeBottom?o+e>=t&&(d=o+e,y.checkMinMax&&p+d<y.topMax&&(o=d,h=!0,f.style.height=o+"px")):y.resizeTop&&o-e>=t&&(b=p+e,y.checkMinMax&&b>y.topMin&&(o-=e,p=b,h=!0,f.style.height=o+"px",f.style.top=b+"px")),y.resizeRight?n+g>=t&&(c=n+g,y.checkMinMax&&q+c<y.leftMax&&(n=c,i=!0,f.style.width=n+"px")):y.resizeLeft&&y.checkMinMax&&n-g>=t&&(a=q+g,a>y.leftMin&&(q=a,n-=g,i=!0,f.style.width=n+"px",f.style.left=a+"px")),h&&(y.y=y.mouseY),i&&(y.x=y.mouseX)},O=function(a){y.resizing=y.resizeBottom=y.resizeLeft=y.resizeRight=y.resizeTop=!1,document.removeEventListener("mousemove",M,!0),document.removeEventListener("mouseup",O,!0),G(a)},P=function(a){var b,c;c=a.target||a.srcElement,G(a),v&&(c.style.cursor="move",b={left:window.innerWidth-30,top:window.innerHeight-30},y.x=a.clientX,y.y=a.clientY,y.topOrg=p,y.topMin=3,y.topMax=b.top,y.leftOrg=q,y.leftMax=b.left,y.leftMin=3,y.moving=!0,document.addEventListener("mousemove",Q,!0),document.addEventListener("mouseup",R,!0))},Q=function(a){var b,c,d=a.clientY-y.y,e=a.clientX-y.x;if(y.moving||R(),G(a),b=y.leftOrg+e,c=y.topOrg+d,y.checkMinMax){if(b<=y.leftMin||c<=y.topMin||b>=y.leftMax||c>=y.topMax)return}else if(a.clientX<x||a.clientY<x||a.clientX>y.leftMax||a.clientY>y.topMax)return;f.style.top=c+"px",f.style.left=b+"px",p=c,q=b},R=function(a){y.moving=!1,document.removeEventListener("mousemove",Q,!0),document.removeEventListener("mouseup",R,!0),a&&G(a),C("frameTableTitleCell").style.cursor="default",C("frameTitle").style.cursor="default"},S=function(a,b,c){var d,e=C("frameContentCell"),j=i,l=f;b||j.setAttribute("style","display:none"),s=c,e.style.height="100%",e.style.width="0px",a.tagName?(e.appendChild(a),l.style.height=o>0?o>h?h+"px":o+"px":"auto",n>0?l.style.width=n>g?g+"px":n+"px":(d=e.clientWidth+2,l.style.width=g&&d>g?g+"px":d+"px")):(e.appendChild(k.createTextNode(a)),l.style.height=""),E()};PWC.Components.GenericDialog.Frame.HtmlDiv.numInstances=(PWC.Components.GenericDialog.Frame.HtmlDiv.numInstances||0)+1,this.createFrame=function(a,b){d=b&&b.BackColor?b.BackColor:void 0,a.appendChild(j.getDivNode(PWC.Components.GenericDialog.Frame.HtmlDiv.numInstances,d)),c=a,n=b&&b.Width||0,o=b&&b.Height||0,p=b&&b.Top||(window.innerHeight>o?(window.innerHeight-o)/2:10),q=b&&b.Left||(window.innerWidth>n?(window.innerWidth-n)/2:10),r=b&&b.FrameCloseCallBack?b.FrameCloseCallBack:null,v=b&&void 0!==b.WindowMovingEnabled?b.WindowMovingEnabled:!0,u=b&&void 0!==b.WindowSizingEnabled?b.WindowSizingEnabled:!1,w=b&&void 0!==b.ShowCaption?b.ShowCaption:!0,e=b&&b.Caption?b.Caption:"",g=b&&b.MaxWidth?b.MaxWidth:void 0,h=b&&b.MaxHeight?b.MaxHeight:void 0,D()},this.show=function(a,b){S(a,!1,b)},this.showModal=function(a,b){S(a,!0,b)},this.close=function(){var a,b=f,d=i;F(),d.style.display="none",b.style.display="none",null!==r&&""!==r&&r(),y=null,a=c.parentElement,a.removeChild(c),PWC.Components.GenericDialog.Frame.HtmlDiv.numInstances=PWC.Components.GenericDialog.Frame.HtmlDiv.numInstances-1||0}};var PWC=PWC||{};PWC.Components=PWC.Components||{},PWC.Components.GenericDialog=PWC.Components.GenericDialog||{},PWC.Components.GenericDialog.Frame=PWC.Components.GenericDialog.Frame||{},PWC.Components.GenericDialog.Frame.HtmlDiv=PWC.Components.GenericDialog.Frame.HtmlDiv||{},PWC.Components.GenericDialog.Frame.HtmlDiv.Node=function(){this.getDivNode=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=PWC.Components.GenericDialog.Frame.TitlebarStyles,o=PWC.Components.GenericDialog.Frame.BorderStyles;return m=b?b:PWC.Components.GenericDialog.Frame.TitlebarStyles.backgroundColor,c=document.createElement("div"),d=document.createElement("div"),d.setAttribute("id","frameOverylayDiv_"+a),d.setAttribute("data-tif-id","frameOverylayDiv_tifId_"),d.setAttribute("class","frameOverylayDiv"),d.setAttribute("style","filter: alpha(opacity = 70);background: #666666 50% 50% repeat;opacity: .3;filter: Alpha(Opacity=50);position: fixed;top: 0;left: 0;width: 100%;height: 100%;"),c.appendChild(d),e=document.createElement("div"),e.setAttribute("id","frameParentDiv_"+a),e.setAttribute("data-tif-id","frameParentDiv_tifId"),e.setAttribute("style","display:none; position: absolute !important;background-color: white !important;border: "+o.strokeWidth+" "+o.variant+"  "+m+";  border-top: "+o.strokeWidthTop+" "+o.variant+"  "+m+";-moz-user-select: none; -webkit-user-select: none; -ms-user-select:none; user-select:none;-o-user-select:none;overflow: hidden;"),e.setAttribute("class","frameParentDiv"),f=document.createElement("table"),f.setAttribute("border","0"),f.setAttribute("cellspacing","0"),f.setAttribute("cellpadding","0"),f.setAttribute("id","frameTable_"+a),f.setAttribute("data-tif-id","frameTable_tifId"),f.setAttribute("style"," height: 100%;width: 100%;border: 0;"),f.setAttribute("class","frameTable"),g=document.createElement("tr"),g.setAttribute("style","background-color:"+m),g.setAttribute("id","frameTableTitleRow_"+a),g.setAttribute("data-tif-id","frameTableTitleRow_tifId"),g.setAttribute("class","frameTableTitleRow"),j=document.createElement("td"),j.setAttribute("align","left"),j.setAttribute("id","frameTableTitleCell_"+a),j.setAttribute("data-tif-id","frameTableTitleCell_tifId"),j.setAttribute("class","frameTableTitleCell"),j.setAttribute("width","90%"),j.setAttribute("style","width:90%;text-align:center;padding-top: 3px; padding-bottom: 5px;"),k=document.createElement("span"),k.setAttribute("id","frameTitle_"+a),k.setAttribute("data-tif-id","frameTitle_tifId"),k.setAttribute("style","color: "+n.color+"; padding-left: 2px;font-weight:"+n.fontweight+";font-family:"+n.fontfamily+" ;font-size: "+n.fontsize+";"),k.setAttribute("class","frameTitle"),j.appendChild(k),g.appendChild(j),j=document.createElement("td"),j.setAttribute("align","right"),j.setAttribute("style","width:10%; vertical-align: top;"),j.setAttribute("width","10%"),l=document.createElement("div"),l.setAttribute("id","frameCloseDiv"+a),l.setAttribute("data-tif-id","frameCloseDiv_tifId"),l.setAttribute("class","frameCloseDiv"),l.setAttribute("style"," background: "+n.closeBackColor+";height: 20px;width: 49px;cursor:pointer;margin-bottom: 2px;"),d=document.createElement("div"),d.setAttribute("style","-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);-ms-transform: rotate(45deg);-o-transform: rotate(45deg);height: 13px;width: 41px;"),i=document.createElement("span"),i.setAttribute("style","color: "+n.closeFontColor+";margin: 14px;font-size: 22px;font-variant: normal;font-family: sans-serif;"),i.appendChild(document.createTextNode("+")),d.appendChild(i),l.appendChild(d),j.appendChild(l),g.appendChild(j),f.appendChild(g),g=document.createElement("tr"),h=document.createElement("td"),h.setAttribute("id","frameContentCell"),h.setAttribute("data-tif-id","frameContentCell_tifId"),h.setAttribute("align","center"),h.setAttribute("width","100%"),h.setAttribute("colspan","2"),h.setAttribute("style","cursor: default;"),h.setAttribute("class","frameContentCell"),g.appendChild(h),f.appendChild(g),e.appendChild(f),c.appendChild(e),c}};
// SIG // Begin signature block
// SIG // MIIhgAYJKoZIhvcNAQcCoIIhcTCCIW0CAQExDzANBglg
// SIG // hkgBZQMEAgEFADB3BgorBgEEAYI3AgEEoGkwZzAyBgor
// SIG // BgEEAYI3AgEeMCQCAQEEEBDgyQbOONQRoqMAEEvTUJAC
// SIG // AQACAQACAQACAQACAQAwMTANBglghkgBZQMEAgEFAAQg
// SIG // AaPdw7sWdKJePGalGfsXBNZZY6wh5NENoCtlGLeaQFCg
// SIG // gg/PMIIE0DCCA7igAwIBAgIQOZ3Mut88LP5C4fl5xqLU
// SIG // 8TANBgkqhkiG9w0BAQsFADB/MQswCQYDVQQGEwJVUzEd
// SIG // MBsGA1UEChMUU3ltYW50ZWMgQ29ycG9yYXRpb24xHzAd
// SIG // BgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxMDAu
// SIG // BgNVBAMTJ1N5bWFudGVjIENsYXNzIDMgU0hBMjU2IENv
// SIG // ZGUgU2lnbmluZyBDQTAeFw0xODAyMDEwMDAwMDBaFw0y
// SIG // MDA0MDEyMzU5NTlaMGgxCzAJBgNVBAYTAkRFMRswGQYD
// SIG // VQQIDBJCYWRlbi1Xw7xydHRlbWJlcmcxEjAQBgNVBAcM
// SIG // CUthcmxzcnVoZTETMBEGA1UECgwKU2llbWVucyBBRzET
// SIG // MBEGA1UEAwwKU2llbWVucyBBRzCCASIwDQYJKoZIhvcN
// SIG // AQEBBQADggEPADCCAQoCggEBAMqbX9kvRnz5BKBSFX05
// SIG // NakWJkaS1Cu0OutPZE1MNOZEVy/FPUDBOofIjUBC6Fhd
// SIG // Oqpy6KgOJPUy6JFnUzWW0TXhM20l/B/ZnKZXZCtiVEvd
// SIG // Tnee6kKx+nZHv9JfnC3RDrzawDzfLPky6Q6xdGAU6UE/
// SIG // tNYNOfrdy6JoeygMGNhG/9xsLd1r2xhqAmTmVo9J9Vvx
// SIG // dpXdAzeP53b34dUg30Hc65gLysYWILp4GWKlmSrk387u
// SIG // Q7x/TrBA6vBqh81l0azNbdCnAqB1I1OhVVkXqTkte7LA
// SIG // bzzVtOx+lWvq6XqHq/Wsh6Y92nohCNmoh7TwF0HbYNvg
// SIG // kBehrDAOIyZL8x8CAwEAAaOCAV0wggFZMAkGA1UdEwQC
// SIG // MAAwDgYDVR0PAQH/BAQDAgeAMCsGA1UdHwQkMCIwIKAe
// SIG // oByGGmh0dHA6Ly9zdi5zeW1jYi5jb20vc3YuY3JsMGEG
// SIG // A1UdIARaMFgwVgYGZ4EMAQQBMEwwIwYIKwYBBQUHAgEW
// SIG // F2h0dHBzOi8vZC5zeW1jYi5jb20vY3BzMCUGCCsGAQUF
// SIG // BwICMBkMF2h0dHBzOi8vZC5zeW1jYi5jb20vcnBhMBMG
// SIG // A1UdJQQMMAoGCCsGAQUFBwMDMFcGCCsGAQUFBwEBBEsw
// SIG // STAfBggrBgEFBQcwAYYTaHR0cDovL3N2LnN5bWNkLmNv
// SIG // bTAmBggrBgEFBQcwAoYaaHR0cDovL3N2LnN5bWNiLmNv
// SIG // bS9zdi5jcnQwHwYDVR0jBBgwFoAUljtT8Hkzl699g+8u
// SIG // K8zKt4YecmYwHQYDVR0OBBYEFD+VtGjup25LSOgUWp8s
// SIG // 8L/aTV+1MA0GCSqGSIb3DQEBCwUAA4IBAQAhTUNxlQfy
// SIG // haNdArFHX6D+Svi9uRsyU8H+8/cJ85iCxCj3Xi2QawrB
// SIG // 5APqtdhIoH0/ceyG289Xt+hHnLZoG/SSFk18V6Lv2QAI
// SIG // htkyXkrI9/3B8EW/94o0OKxNNebDP6HW6F6ZA0W19YKX
// SIG // 6PxndYmP7+w0xLnwKKu7D4zI++E1UlIlJ/AugedlEVZP
// SIG // vv/rAA3chUXiB8I9HvY7yz3TeEDKdt179AUneAH54dKO
// SIG // wUNo7Ycf8CW7ztx+gb41Lz2GDRdI74CdwINennV79sh3
// SIG // dr+EFeXn/bQoaKxr1C2tvKDh1uPVYhePNMdcXSDkwOlJ
// SIG // YpD9XAc50uTYylshdf+VWgTFMIIFWTCCBEGgAwIBAgIQ
// SIG // PXjX+XZJYLJhffTwHsqGKjANBgkqhkiG9w0BAQsFADCB
// SIG // yjELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWdu
// SIG // LCBJbmMuMR8wHQYDVQQLExZWZXJpU2lnbiBUcnVzdCBO
// SIG // ZXR3b3JrMTowOAYDVQQLEzEoYykgMjAwNiBWZXJpU2ln
// SIG // biwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5
// SIG // MUUwQwYDVQQDEzxWZXJpU2lnbiBDbGFzcyAzIFB1Ymxp
// SIG // YyBQcmltYXJ5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5
// SIG // IC0gRzUwHhcNMTMxMjEwMDAwMDAwWhcNMjMxMjA5MjM1
// SIG // OTU5WjB/MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3lt
// SIG // YW50ZWMgQ29ycG9yYXRpb24xHzAdBgNVBAsTFlN5bWFu
// SIG // dGVjIFRydXN0IE5ldHdvcmsxMDAuBgNVBAMTJ1N5bWFu
// SIG // dGVjIENsYXNzIDMgU0hBMjU2IENvZGUgU2lnbmluZyBD
// SIG // QTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
// SIG // AJeDHgAWryyx0gjE12iTUWAecfbiR7TbWE0jYmq0v1ob
// SIG // UfejDRh3aLvYNqsvIVDanvPnXydOC8KXyAlwk6naXA1O
// SIG // pA2RoLTsFM6RclQuzqPbROlSGz9BPMpK5KrA6DmrU8wh
// SIG // 0MzPf5vmwsxYaoIV7j02zxzFlwckjvF7vjEtPW7ctZlC
// SIG // n0thlV8ccO4XfduL5WGJeMdoG68ReBqYrsRVR1PZszLW
// SIG // oQ5GQMWXkorRU6eZW4U1V9Pqk2JhIArHMHckEU1ig7a6
// SIG // e2iCMe5lyt/51Y2yNdyMK29qclxghJzyDJRewFZSAEjM
// SIG // 0/ilfd4v1xPkOKiE1Ua4E4bCG53qWjjdm9sCAwEAAaOC
// SIG // AYMwggF/MC8GCCsGAQUFBwEBBCMwITAfBggrBgEFBQcw
// SIG // AYYTaHR0cDovL3MyLnN5bWNiLmNvbTASBgNVHRMBAf8E
// SIG // CDAGAQH/AgEAMGwGA1UdIARlMGMwYQYLYIZIAYb4RQEH
// SIG // FwMwUjAmBggrBgEFBQcCARYaaHR0cDovL3d3dy5zeW1h
// SIG // dXRoLmNvbS9jcHMwKAYIKwYBBQUHAgIwHBoaaHR0cDov
// SIG // L3d3dy5zeW1hdXRoLmNvbS9ycGEwMAYDVR0fBCkwJzAl
// SIG // oCOgIYYfaHR0cDovL3MxLnN5bWNiLmNvbS9wY2EzLWc1
// SIG // LmNybDAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUH
// SIG // AwMwDgYDVR0PAQH/BAQDAgEGMCkGA1UdEQQiMCCkHjAc
// SIG // MRowGAYDVQQDExFTeW1hbnRlY1BLSS0xLTU2NzAdBgNV
// SIG // HQ4EFgQUljtT8Hkzl699g+8uK8zKt4YecmYwHwYDVR0j
// SIG // BBgwFoAUf9Nlp8Ld7LvwMAnzQzn6Aq8zMTMwDQYJKoZI
// SIG // hvcNAQELBQADggEBABOFGh5pqTf3oL2kr34dYVP+nYxe
// SIG // DKZ1HngXI9397BoDVTn7cZXHZVqnjjDSRFph23Bv2iEF
// SIG // wi5zuknx0ZP+XcnNXgPgiZ4/dB7X9ziLqdbPuzUvM1io
// SIG // klbRyE07guZ5hBb8KLCxR/Mdoj7uh9mmf6RWpT+thC4p
// SIG // 3ny8qKqjPQQB6rqTog5QIikXTIfkOhFf1qQliZsFay+0
// SIG // yQFMJ3sLrBkFIqBgFT/ayftNTI/7cmd3/SeUx7o1DohJ
// SIG // /o39KK9KEr0Ns5cF3kQMFfo2KwPcwVAB8aERXRTl4r0n
// SIG // S1S+K4ReD6bDdAUK75fDiSKxH3fzvc1D1PFMqT+1i4Sv
// SIG // ZPLQFCEwggWaMIIDgqADAgECAgphGZPkAAAAAAAcMA0G
// SIG // CSqGSIb3DQEBBQUAMH8xCzAJBgNVBAYTAlVTMRMwEQYD
// SIG // VQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25k
// SIG // MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24x
// SIG // KTAnBgNVBAMTIE1pY3Jvc29mdCBDb2RlIFZlcmlmaWNh
// SIG // dGlvbiBSb290MB4XDTExMDIyMjE5MjUxN1oXDTIxMDIy
// SIG // MjE5MzUxN1owgcoxCzAJBgNVBAYTAlVTMRcwFQYDVQQK
// SIG // Ew5WZXJpU2lnbiwgSW5jLjEfMB0GA1UECxMWVmVyaVNp
// SIG // Z24gVHJ1c3QgTmV0d29yazE6MDgGA1UECxMxKGMpIDIw
// SIG // MDYgVmVyaVNpZ24sIEluYy4gLSBGb3IgYXV0aG9yaXpl
// SIG // ZCB1c2Ugb25seTFFMEMGA1UEAxM8VmVyaVNpZ24gQ2xh
// SIG // c3MgMyBQdWJsaWMgUHJpbWFyeSBDZXJ0aWZpY2F0aW9u
// SIG // IEF1dGhvcml0eSAtIEc1MIIBIjANBgkqhkiG9w0BAQEF
// SIG // AAOCAQ8AMIIBCgKCAQEAryQICCl6NZ5gDKrnSztO3Hy8
// SIG // PEUcuyvg/ikC+VcIo2SFFSf18a3IMYldIugqqqZCs4/4
// SIG // uVW3sbdLs/6PfgdX7O9D22ZiFWHPYA2k2N744MNiCD1U
// SIG // E+tJyllUhSblK48bn+v1oZHCM0nYQ2NqUkvSj+hwUU3R
// SIG // iWl7x3D2s9wSdNt7XUtW05a/FXehsPSiJfKvHJJnGOX0
// SIG // BgTvkLnkAOTdOrUZ/wK69Dzu4IvrN4vs9Nes8vbwPa/d
// SIG // dZEzGR0cQMt0JBkhk9kU/qwqUseP1QRJ5I1jR4g8aYPL
// SIG // /ke9K35PxZWuDp3U0UPAZ3PjFAh+5T+fc7gzCs9dPzSH
// SIG // loruU+glFQIDAQABo4HLMIHIMBEGA1UdIAQKMAgwBgYE
// SIG // VR0gADAPBgNVHRMBAf8EBTADAQH/MAsGA1UdDwQEAwIB
// SIG // hjAdBgNVHQ4EFgQUf9Nlp8Ld7LvwMAnzQzn6Aq8zMTMw
// SIG // HwYDVR0jBBgwFoAUYvsKIVt/Q24R2glUUGv10pZx8Z4w
// SIG // VQYDVR0fBE4wTDBKoEigRoZEaHR0cDovL2NybC5taWNy
// SIG // b3NvZnQuY29tL3BraS9jcmwvcHJvZHVjdHMvTWljcm9z
// SIG // b2Z0Q29kZVZlcmlmUm9vdC5jcmwwDQYJKoZIhvcNAQEF
// SIG // BQADggIBAIEqghaMNGcr5QPrNHuMoqNQivRVhvEejI6u
// SIG // fe4DGc5ylRhIrWIR/SD9P0cGAVri4G+MFSxOPGpQbAs2
// SIG // o896DZxCvFz4GdVg42nm4iNBZ4xog3Yrj5OjKrV/vln7
// SIG // qcmyJo/KovOCG5g+kZUnl4Zh7ltdB2vNhqjiZYCo4hXi
// SIG // sr4jBWq6DPNHk02spIwHeTnAYRI6BQ2Jo+yfV4mE++zK
// SIG // fEdmFJHYtg8ZXea4Sqy8R8hxQ5bmMiCl3HeG/Tzji3Hb
// SIG // e5sD/LcdMmTrFlKgQ6P6Lq1Zkk58x/IzQkg4UTp8OMcb
// SIG // JCIoQB4aRh8X2xj38Cc1bLhj2c25ZF0rpV7vxim08sf4
// SIG // IcwEulf9Abarxmf559OZf/T1Ivpy9f3/OhxCOqH5gBil
// SIG // 7o0c1GaeRQH+qu7/+xePMPfxzSnFney11UkAPYW4y7uT
// SIG // OidqScAwrmbJ9yMoMnb5pINWyEjOWpaqoMwMxH+0jpev
// SIG // beNUJ8OfhsDW5HMIlwXb0FRiXgNIwtWff6dmjNCdsE/U
// SIG // 05hfS3rJf7IpUtASgMcPVLYeZ83GoGwRA4TTSHXnKv6w
// SIG // O24KOqZrdpkFo/F3aGEzFEcG/FN/Ur2SFFxKJGpnjK+N
// SIG // kKrQ9nkhG5MmfMPOHr2IOJKuRcYZaklQswX4rlk3imol
// SIG // A5SxWYFQ6LqDgLcjNfR2uWcdWRitII2UMYIRCTCCEQUC
// SIG // AQEwgZMwfzELMAkGA1UEBhMCVVMxHTAbBgNVBAoTFFN5
// SIG // bWFudGVjIENvcnBvcmF0aW9uMR8wHQYDVQQLExZTeW1h
// SIG // bnRlYyBUcnVzdCBOZXR3b3JrMTAwLgYDVQQDEydTeW1h
// SIG // bnRlYyBDbGFzcyAzIFNIQTI1NiBDb2RlIFNpZ25pbmcg
// SIG // Q0ECEDmdzLrfPCz+QuH5ecai1PEwDQYJYIZIAWUDBAIB
// SIG // BQCgfDAQBgorBgEEAYI3AgEMMQIwADAZBgkqhkiG9w0B
// SIG // CQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4w
// SIG // DAYKKwYBBAGCNwIBFTAvBgkqhkiG9w0BCQQxIgQgMrOT
// SIG // qUCJipw19KN0qDHfiR6P6pryza/6co3bnwWAofcwDQYJ
// SIG // KoZIhvcNAQEBBQAEggEAyRQiSYHE5MZglGC7uhx+EXsC
// SIG // oaVpCHIvWUmp4SHnZYTYGLzdRaoYlkGD6bjclAYBAFUF
// SIG // kRq4eEhxVOrOJs83FqHcdBE7Imxhfg+68jCDpXsRKJw2
// SIG // nUQ/JvB0OLf1mq41QE3eTMkY5q17t1IqLFNjpSrNkxfS
// SIG // zQdrE9Nqhb8eMDhX+YzTYNAj+AJwnKfEDBgG+Q7htI4V
// SIG // O9c2QeGf7a7VKz6CNFFrmypqgDJ0QafpCZyxP5Xcm7Jd
// SIG // 9G0q2xPdTfevpsF9kcTOe0gp6jqfcNGgB1A5aiExaWKt
// SIG // ZUM6ikL8LzEUpcDrGwmyJGRGqcmvXHE+OGvST+vLN/po
// SIG // sI6hsbmobKGCDsgwgg7EBgorBgEEAYI3AwMBMYIOtDCC
// SIG // DrAGCSqGSIb3DQEHAqCCDqEwgg6dAgEDMQ8wDQYJYIZI
// SIG // AWUDBAIBBQAwdwYLKoZIhvcNAQkQAQSgaARmMGQCAQEG
// SIG // CWCGSAGG/WwHATAxMA0GCWCGSAFlAwQCAQUABCC9R5Cn
// SIG // hiPzg8BH/YcP1wUA8LOZ4VwEu0KX/WAoRDnWKgIQAivB
// SIG // A6rGH6HXBOsJSYwGxhgPMjAxODA5MjUwNzUwMzVaoIIL
// SIG // uzCCBoIwggVqoAMCAQICEAnA/EbIBEITtVmLryhPTkEw
// SIG // DQYJKoZIhvcNAQELBQAwcjELMAkGA1UEBhMCVVMxFTAT
// SIG // BgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3
// SIG // LmRpZ2ljZXJ0LmNvbTExMC8GA1UEAxMoRGlnaUNlcnQg
// SIG // U0hBMiBBc3N1cmVkIElEIFRpbWVzdGFtcGluZyBDQTAe
// SIG // Fw0xNzAxMDQwMDAwMDBaFw0yODAxMTgwMDAwMDBaMEwx
// SIG // CzAJBgNVBAYTAlVTMREwDwYDVQQKEwhEaWdpQ2VydDEq
// SIG // MCgGA1UEAxMhRGlnaUNlcnQgU0hBMiBUaW1lc3RhbXAg
// SIG // UmVzcG9uZGVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
// SIG // MIIBCgKCAQEAnpWYajQ7cxuofvzHvilpicdoJkZfPY1i
// SIG // c4eBo6Gc8LdbJDdaktT0Wdd2ieTc1Sfw1Wa8Cu60KzFn
// SIG // rFjFSpFZK0UeCQHWZLNZ7o1mTfsjXswQDQuKZ+9SrqAI
// SIG // kMJS9/WotW6bLHud57U++3jNMlAYv0C1TIy7V/SgTxFF
// SIG // bEJCueWv1t/0p3wKaJYP0l8pV877HTL/9BGhEyL7Esvv
// SIG // 11PS65fLoqwbHZ1YIVGCwsLe6is/LCKE0EPsOzs/R8T2
// SIG // VtxFN5i0a3S1Wa94V2nIDwkCeN3YU8GZ22DEnequr+B+
// SIG // hkpcqVhhqF50igEoaHJOp4adtQJSh3BmSNOO74EkzNzY
// SIG // ZQIDAQABo4IDODCCAzQwDgYDVR0PAQH/BAQDAgeAMAwG
// SIG // A1UdEwEB/wQCMAAwFgYDVR0lAQH/BAwwCgYIKwYBBQUH
// SIG // AwgwggG/BgNVHSAEggG2MIIBsjCCAaEGCWCGSAGG/WwH
// SIG // ATCCAZIwKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3LmRp
// SIG // Z2ljZXJ0LmNvbS9DUFMwggFkBggrBgEFBQcCAjCCAVYe
// SIG // ggFSAEEAbgB5ACAAdQBzAGUAIABvAGYAIAB0AGgAaQBz
// SIG // ACAAQwBlAHIAdABpAGYAaQBjAGEAdABlACAAYwBvAG4A
// SIG // cwB0AGkAdAB1AHQAZQBzACAAYQBjAGMAZQBwAHQAYQBu
// SIG // AGMAZQAgAG8AZgAgAHQAaABlACAARABpAGcAaQBDAGUA
// SIG // cgB0ACAAQwBQAC8AQwBQAFMAIABhAG4AZAAgAHQAaABl
// SIG // ACAAUgBlAGwAeQBpAG4AZwAgAFAAYQByAHQAeQAgAEEA
// SIG // ZwByAGUAZQBtAGUAbgB0ACAAdwBoAGkAYwBoACAAbABp
// SIG // AG0AaQB0ACAAbABpAGEAYgBpAGwAaQB0AHkAIABhAG4A
// SIG // ZAAgAGEAcgBlACAAaQBuAGMAbwByAHAAbwByAGEAdABl
// SIG // AGQAIABoAGUAcgBlAGkAbgAgAGIAeQAgAHIAZQBmAGUA
// SIG // cgBlAG4AYwBlAC4wCwYJYIZIAYb9bAMVMB8GA1UdIwQY
// SIG // MBaAFPS24SAd/imu0uRhpbKiJbLIFzVuMB0GA1UdDgQW
// SIG // BBThpzJK7gEhKH1U1fIHkm60Bw89hzBxBgNVHR8EajBo
// SIG // MDKgMKAuhixodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v
// SIG // c2hhMi1hc3N1cmVkLXRzLmNybDAyoDCgLoYsaHR0cDov
// SIG // L2NybDQuZGlnaWNlcnQuY29tL3NoYTItYXNzdXJlZC10
// SIG // cy5jcmwwgYUGCCsGAQUFBwEBBHkwdzAkBggrBgEFBQcw
// SIG // AYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME8GCCsG
// SIG // AQUFBzAChkNodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5j
// SIG // b20vRGlnaUNlcnRTSEEyQXNzdXJlZElEVGltZXN0YW1w
// SIG // aW5nQ0EuY3J0MA0GCSqGSIb3DQEBCwUAA4IBAQAe8EGC
// SIG // Mq7t8bQ1E9xQwtWXriIinQ4OrzPTTP18v28BEaeUZSJc
// SIG // xiKhyIlSa5qMc1zZXj8y3hZgTIs2/TGZCr3BhLeNHe+J
// SIG // JhMFVvNHzUdbrYSyOK9qI7VF4x6IMkaA0remmSL9wXjP
// SIG // 9YvYDIwFCe5E5oDVbXDMn1MeJ90qSN7ak2WtbmWjmafC
// SIG // QA5zzFhPj0Uo5byciOYozmBdLSVdi3MupQ1bUdqaTv9Q
// SIG // BYko2vJ4u9JYeI1Ep6w6AJF4aYlkBNNdlt8qv/mlTCyT
// SIG // /+aK3YKs8dKzooaawVWJVmpHP/rWM5VDNYkFeFo6adoi
// SIG // uARD029oNTZ6FD5F6Zhkhg8TDCZKMIIFMTCCBBmgAwIB
// SIG // AgIQCqEl1tYyG35B5AXaNpfCFTANBgkqhkiG9w0BAQsF
// SIG // ADBlMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNl
// SIG // cnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29t
// SIG // MSQwIgYDVQQDExtEaWdpQ2VydCBBc3N1cmVkIElEIFJv
// SIG // b3QgQ0EwHhcNMTYwMTA3MTIwMDAwWhcNMzEwMTA3MTIw
// SIG // MDAwWjByMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGln
// SIG // aUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQu
// SIG // Y29tMTEwLwYDVQQDEyhEaWdpQ2VydCBTSEEyIEFzc3Vy
// SIG // ZWQgSUQgVGltZXN0YW1waW5nIENBMIIBIjANBgkqhkiG
// SIG // 9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvdAy7kvNj3/dqbqC
// SIG // mcU5VChXtiNKxA4HRTNREH3Q+X1NaH7ntqD0jbOI5Je/
// SIG // YyGQmL8TvFfTw+F+CNZqFAA49y4eO+7MpvYyWf5fZT/g
// SIG // m+vjRkcGGlV+Cyd+wKL1oODeIj8O/36V+/OjuiI+GKwR
// SIG // 5PCZA207hXwJ0+5dyJoLVOOoCXFr4M8iEA91z3FyTgqt
// SIG // 30A6XLdR4aF5FMZNJCMwXbzsPGBqrC8HzP3w6kfZiFBe
// SIG // /WZuVmEnKYmEUeaC50ZQ/ZQqLKfkdT66mA+Ef58xFNat
// SIG // 1fJky3seBdCEGXIX8RcG7z3N1k3vBkL9olMqT4UdxB08
// SIG // r8/arBD13ays6Vb/kwIDAQABo4IBzjCCAcowHQYDVR0O
// SIG // BBYEFPS24SAd/imu0uRhpbKiJbLIFzVuMB8GA1UdIwQY
// SIG // MBaAFEXroq/0ksuCMS1Ri6enIZ3zbcgPMBIGA1UdEwEB
// SIG // /wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgGGMBMGA1Ud
// SIG // JQQMMAoGCCsGAQUFBwMIMHkGCCsGAQUFBwEBBG0wazAk
// SIG // BggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu
// SIG // Y29tMEMGCCsGAQUFBzAChjdodHRwOi8vY2FjZXJ0cy5k
// SIG // aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290
// SIG // Q0EuY3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8v
// SIG // Y3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVk
// SIG // SURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsMy5k
// SIG // aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290
// SIG // Q0EuY3JsMFAGA1UdIARJMEcwOAYKYIZIAYb9bAACBDAq
// SIG // MCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy
// SIG // dC5jb20vQ1BTMAsGCWCGSAGG/WwHATANBgkqhkiG9w0B
// SIG // AQsFAAOCAQEAcZUS6VGHVmnN793afKpjerN4zwY3QITv
// SIG // S4S/ys8DAv3Fp8MOIEIsr3fzKx8MIVoqtwU0HWqumfgn
// SIG // oma/Capg33akOpMP+LLR2HwZYuhegiUexLoceywh4tZb
// SIG // LBQ1QwRostt1AuByx5jWPGTlH0gQGF+JOGFNYkYkh2OM
// SIG // kVIsrymJ5Xgf1gsUpYDXEkdws3XVk4WTfraSZ/tTYYmo
// SIG // 9WuWwPRYaQ18yAGxuSh1t5ljhSKMYcp5lH5Z/IwP42+1
// SIG // ASa2bKXuh1Eh5Fhgm7oMLSttosR+u8QlK0cCCHxJrhO2
// SIG // 4XxCQijGGFbPQTS2Zl22dHv1VjMiLyI2skuiSpXY9aaO
// SIG // UjGCAk0wggJJAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUw
// SIG // EwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3
// SIG // dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0
// SIG // IFNIQTIgQXNzdXJlZCBJRCBUaW1lc3RhbXBpbmcgQ0EC
// SIG // EAnA/EbIBEITtVmLryhPTkEwDQYJYIZIAWUDBAIBBQCg
// SIG // gZgwGgYJKoZIhvcNAQkDMQ0GCyqGSIb3DQEJEAEEMBwG
// SIG // CSqGSIb3DQEJBTEPFw0xODA5MjUwNzUwMzVaMC8GCSqG
// SIG // SIb3DQEJBDEiBCBSnv3KQWaiCE14LnFb2ilEpH91EBr4
// SIG // Q7PsGSgGrZjBsjArBgsqhkiG9w0BCRACDDEcMBowGDAW
// SIG // BBRAAZFHXJiJHeuhBK9HCRtettTLyzANBgkqhkiG9w0B
// SIG // AQEFAASCAQA3mhfViXJha6cIjIubXiwhl4tuUJICLJHc
// SIG // 7JrRM6TjWDLHKScHgBSQikIMqQkHB7QW+exCmM3YVC5v
// SIG // XFIYXwsGOLZW3Jh7VvoOfz/iPoN3cZBrtvU060yK4D6/
// SIG // Wse7hXS7hfzGlqDtokd7YeKcn8mJcVDakxWsVANefKlW
// SIG // dVWzcDpuJ1O+RPxU5xyIdPOiefPCKOD+kG5LFQQWlDXZ
// SIG // R8dX2xIrS5E1YdpAKgmQLDE2uF1bHXMQW3/y74KCJZw9
// SIG // Yu1wcVzc6aYu1LMOZfwC7uxbCZt/sjauQEoRGUoQq7S9
// SIG // o/5Iz7S+x7cKFuR9kc32M86eOsQfHWlkVtDbPmKK/zye
// SIG // End signature block
